define("echarts-x",["echarts-x/echarts-x"],function(t){return t}),define("echarts-x/echarts-x",["require","echarts/config","./config","zrender/tool/util","qtek/Shader","./util/shader/albedo.essl","./util/shader/points.essl","./util/shader/curveAnimatingPoints.essl","./util/shader/vectorFieldParticle.essl","./util/shader/motionBlur.essl"],function(t){var e=t("echarts/config"),r=t("./config"),i=t("zrender/tool/util");i.merge(e,r,!0);var n=t("qtek/Shader");n["import"](t("./util/shader/albedo.essl")),n["import"](t("./util/shader/points.essl")),n["import"](t("./util/shader/curveAnimatingPoints.essl")),n["import"](t("./util/shader/vectorFieldParticle.essl")),n["import"](t("./util/shader/motionBlur.essl"))}),define("echarts-x/config",[],{CHART_TYPE_MAP3D:"map3d",map3d:{zlevel:-1,mapType:"world",mapLocation:{x:0,y:0,width:"100%",height:"100%"},baseLayer:{backgroundColor:"black",backgroundImage:"",quality:"medium"},surfaceLayers:[],itemStyle:{normal:{label:{show:!1,textStyle:{color:"black"}},borderColor:"black",borderWidth:1,areaStyle:{color:"#396696",opacity:1}},emphasis:{borderColor:"black",borderWidth:1,areaStyle:{color:"rgba(255,215,0,0.5)"}}},autoRotate:!0},markBar:{barSize:1,distance:1,itemStyle:{normal:{}}},markPoint:{symbolSize:4,distance:1,orientation:"tangent",orientationAngle:0,itemStyle:{normal:{borderWidth:1,borderColor:"#000",label:{show:!1,position:"inside",textStyle:{color:"black"}}}}},markLine:{distance:1,itemStyle:{normal:{lineStyle:{width:1,opacity:.2}}}}}),define("qtek/Shader",["require","./core/Base","./core/util","./core/Cache","./dep/glmatrix"],function(t){"use strict";function e(){return{locations:{},attriblocations:{}}}function r(t){for(var e=t.split("\n"),r=0,i=e.length;i>r;r++)e[r]=r+1+": "+e[r];return e.join("\n")}var i=t("./core/Base"),n=t("./core/util"),a=t("./core/Cache"),s=t("./dep/glmatrix"),o=s.mat2,u=s.mat3,h=s.mat4,c=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\w\,]+)?(\[.*?\])?\s*(:\s*([\S\s]+?))?;/g,l=/attribute\s+(float|int|vec2|vec3|vec4)\s+(\w*)\s*(:\s*(\w+))?;/g,f=/#define\s+(\w+)?(\s+[\w-.]+)?\s*\n/g,_={bool:"1i","int":"1i",sampler2D:"t",samplerCube:"t","float":"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"},d={bool:function(){return!0},"int":function(){return 0},"float":function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return[0,0]},vec3:function(){return[0,0,0]},vec4:function(){return[0,0,0,0]},ivec2:function(){return[0,0]},ivec3:function(){return[0,0,0]},ivec4:function(){return[0,0,0,0]},mat2:function(){return o.create()},mat3:function(){return u.create()},mat4:function(){return h.create()},array:function(){return[]}},m=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT","SKIN_MATRIX"],v=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],p={},y=1,g=2,E=3,T=i.derive(function(){return{vertex:"",fragment:"",precision:"mediump",attribSemantics:{},matrixSemantics:{},matrixSemanticKeys:[],uniformTemplates:{},attributeTemplates:{},vertexDefines:{},fragmentDefines:{},lightNumber:{},_attacheMaterialNumber:0,_uniformList:[],_textureStatus:{},_vertexProcessed:"",_fragmentProcessed:"",_currentLocationsMap:{}}},function(){this._cache=new a,this._updateShaderString()},{setVertex:function(t){this.vertex=t,this._updateShaderString(),this.dirty()},setFragment:function(t){this.fragment=t,this._updateShaderString(),this.dirty()},bind:function(t){if(this._cache.use(t.__GLID__,e),this._currentLocationsMap=this._cache.get("locations"),this._cache.isDirty()){this._updateShaderString();var r=this._buildProgram(t,this._vertexProcessed,this._fragmentProcessed);if(this._cache.fresh(),r)return r}t.useProgram(this._cache.get("program"))},dirty:function(){this._cache.dirtyAll();for(var t=0;this._cache._caches.length>t;t++)if(this._cache._caches[t]){var e=this._cache._caches[t];e.locations={},e.attriblocations={}}},_updateShaderString:function(){(this.vertex!==this._vertexPrev||this.fragment!==this._fragmentPrev)&&(this._parseImport(),this.attribSemantics={},this.matrixSemantics={},this._textureStatus={},this._parseUniforms(),this._parseAttributes(),this._parseDefines(),this._vertexPrev=this.vertex,this._fragmentPrev=this.fragment),this._addDefine()},define:function(t,e,r){r=void 0!==r?r:null,("vertex"==t||"both"==t)&&this.vertexDefines[e]!==r&&(this.vertexDefines[e]=r,this.dirty()),("fragment"==t||"both"==t)&&this.fragmentDefines[e]!==r&&(this.fragmentDefines[e]=r,"both"!==t&&this.dirty())},unDefine:function(t,e){("vertex"==t||"both"==t)&&this.isDefined("vertex",e)&&(delete this.vertexDefines[e],this.dirty()),("fragment"==t||"both"==t)&&this.isDefined("fragment",e)&&(delete this.fragmentDefines[e],"both"!==t&&this.dirty())},isDefined:function(t,e){switch(t){case"vertex":return void 0!==this.vertexDefines[e];case"fragment":return void 0!==this.fragmentDefines[e]}},getDefine:function(t,e){switch(t){case"vertex":return this.vertexDefines[e];case"fragment":return this.fragmentDefines[e]}},enableTexture:function(t){var e=this._textureStatus[t];if(e){var r=e.enabled;r||(e.enabled=!0,this.dirty())}},enableTexturesAll:function(){for(var t in this._textureStatus)this._textureStatus[t].enabled=!0;this.dirty()},disableTexture:function(t){var e=this._textureStatus[t];if(e){var r=!e.enabled;r||(e.enabled=!1,this.dirty())}},disableTexturesAll:function(){for(var t in this._textureStatus)this._textureStatus[t].enabled=!1;this.dirty()},isTextureEnabled:function(t){return this._textureStatus[t].enabled},getEnabledTextures:function(){var t=[];for(var e in this._textureStatus)this._textureStatus[e].enabled&&t.push(e);return t},hasUniform:function(t){var e=this._currentLocationsMap[t];return null!==e&&void 0!==e},setUniform:function(t,e,r,i){var n=this._currentLocationsMap,a=n[r];if(null===a||void 0===a)return!1;switch(e){case"m4":t.uniformMatrix4fv(a,!1,i);break;case"2i":t.uniform2i(a,i[0],i[1]);break;case"2f":t.uniform2f(a,i[0],i[1]);break;case"3i":t.uniform3i(a,i[0],i[1],i[2]);break;case"3f":t.uniform3f(a,i[0],i[1],i[2]);break;case"4i":t.uniform4i(a,i[0],i[1],i[2],i[3]);break;case"4f":t.uniform4f(a,i[0],i[1],i[2],i[3]);break;case"1i":t.uniform1i(a,i);break;case"1f":t.uniform1f(a,i);break;case"1fv":t.uniform1fv(a,i);break;case"1iv":t.uniform1iv(a,i);break;case"2iv":t.uniform2iv(a,i);break;case"2fv":t.uniform2fv(a,i);break;case"3iv":t.uniform3iv(a,i);break;case"3fv":t.uniform3fv(a,i);break;case"4iv":t.uniform4iv(a,i);break;case"4fv":t.uniform4fv(a,i);break;case"m2":case"m2v":t.uniformMatrix2fv(a,!1,i);break;case"m3":case"m3v":t.uniformMatrix3fv(a,!1,i);break;case"m4v":if(i instanceof Array){for(var s=new Float32Array(16*i.length),o=0,u=0;i.length>u;u++)for(var h=i[u],c=0;16>c;c++)s[o++]=h[c];t.uniformMatrix4fv(a,!1,s)}else i instanceof Float32Array&&t.uniformMatrix4fv(a,!1,i)}return!0},setUniformBySemantic:function(t,e,r){var i=this.attribSemantics[e];return i?this.setUniform(t,i.type,i.symbol,r):!1},enableAttributes:function(t,e,r){var i,n=this._cache.get("program"),a=this._cache.get("attriblocations");i=r?r.__enabledAttributeList:p[t.__GLID__],i||(i=r?r.__enabledAttributeList=[]:p[t.__GLID__]=[]);for(var s=[],o=0;e.length>o;o++){var u=e[o];if(this.attributeTemplates[u]){var h=a[u];if(void 0===h){if(h=t.getAttribLocation(n,u),-1===h){s[o]=-1;continue}a[u]=h}s[o]=h,i[h]=i[h]?g:y}else s[o]=-1}for(var o=0;i.length>o;o++)switch(i[o]){case y:t.enableVertexAttribArray(o),i[o]=E;break;case g:i[o]=E;break;case E:t.disableVertexAttribArray(o),i[o]=0}return s},_parseImport:function(){this._vertexProcessedNoDefine=T.parseImport(this.vertex),this._fragmentProcessedNoDefine=T.parseImport(this.fragment)},_addDefine:function(){var t=[];for(var e in this.lightNumber){var r=this.lightNumber[e];r>0&&t.push("#define "+e.toUpperCase()+"_NUMBER "+r)}for(var i in this._textureStatus){var n=this._textureStatus[i];n.enabled&&t.push("#define "+i.toUpperCase()+"_ENABLED")}for(var i in this.vertexDefines){var a=this.vertexDefines[i];null===a?t.push("#define "+i):t.push("#define "+i+" "+(""+a))}this._vertexProcessed=t.join("\n")+"\n"+this._vertexProcessedNoDefine,t=[];for(var e in this.lightNumber){var r=this.lightNumber[e];r>0&&t.push("#define "+e.toUpperCase()+"_NUMBER "+r)}for(var i in this._textureStatus){var n=this._textureStatus[i];n.enabled&&t.push("#define "+i.toUpperCase()+"_ENABLED")}for(var i in this.fragmentDefines){var a=this.fragmentDefines[i];null===a?t.push("#define "+i):t.push("#define "+i+" "+(""+a))}var s=t.join("\n")+"\n"+this._fragmentProcessedNoDefine;this._fragmentProcessed=["precision",this.precision,"float"].join(" ")+";\n"+s},_parseUniforms:function(){function t(t,n,a,s,o,u){if(n&&a){var h,c=_[n],l=!0;if(c){if(r._uniformList.push(a),("sampler2D"===n||"samplerCube"===n)&&(r._textureStatus[a]={enabled:!1,shaderType:i}),s&&(c+="v"),u)if(m.indexOf(u)>=0)r.attribSemantics[u]={symbol:a,type:c},l=!1;else if(v.indexOf(u)>=0){var f=!1,p=u;u.match(/TRANSPOSE$/)&&(f=!0,p=u.slice(0,-9)),r.matrixSemantics[u]={symbol:a,type:c,isTranspose:f,semanticNoTranspose:p},l=!1}else if("unconfigurable"===u)l=!1;else{if(h=r._parseDefaultValue(n,u),!h)throw Error('Unkown semantic "'+u+'"');u=""}l&&(e[a]={type:c,value:s?d.array:h||d[n],semantic:u||null})}return["uniform",n,a,s].join(" ")+";\n"}}var e={},r=this,i="vertex";this._uniformList=[],this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(c,t),i="fragment",this._fragmentProcessedNoDefine=this._fragmentProcessedNoDefine.replace(c,t),r.matrixSemanticKeys=Object.keys(this.matrixSemantics),this.uniformTemplates=e},_parseDefaultValue:function(t,e){var r=/\[\s*(.*)\s*\]/;{if("vec2"!==t&&"vec3"!==t&&"vec4"!==t)return"bool"===t?function(){return"true"===e.toLowerCase()?!0:!1}:"float"===t?function(){return parseFloat(e)}:void 0;var i=r.exec(e)[1];if(i){var n=i.split(/\s*,\s*/);return function(){return new Float32Array(n)}}}},createUniforms:function(){var t={};for(var e in this.uniformTemplates){var r=this.uniformTemplates[e];t[e]={type:r.type,value:r.value()}}return t},attached:function(){this._attacheMaterialNumber++},detached:function(){this._attacheMaterialNumber--},isAttachedToAny:function(){return 0!==this._attacheMaterialNumber},_parseAttributes:function(){function t(t,i,n,a,s){if(i&&n){var o=1;switch(i){case"vec4":o=4;break;case"vec3":o=3;break;case"vec2":o=2;break;case"float":o=1}if(e[n]={type:"float",size:o,semantic:s||null},s){if(0>m.indexOf(s))throw Error('Unkown semantic "'+s+'"');r.attribSemantics[s]={symbol:n,type:i}}}return["attribute",i,n].join(" ")+";\n"}var e={},r=this;this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(l,t),this.attributeTemplates=e},_parseDefines:function(){function t(t,i,n){var a="vertex"===r?e.vertexDefines:e.fragmentDefines;return a[i]||(a[i]="false"==n?!1:"true"==n?!0:n?parseFloat(n):null),""}var e=this,r="vertex";this._vertexProcessedNoDefine=this._vertexProcessedNoDefine.replace(f,t),r="fragment",this._fragmentProcessedNoDefine=this._fragmentProcessedNoDefine.replace(f,t)},_buildProgram:function(t,e,r){this._cache.get("program")&&t.deleteProgram(this._cache.get("program"));var i=t.createProgram(),n=t.createShader(t.VERTEX_SHADER);t.shaderSource(n,e),t.compileShader(n);var a=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(a,r),t.compileShader(a);var s=this._checkShaderErrorMsg(t,n,e);if(s)return s;if(s=this._checkShaderErrorMsg(t,a,r))return s;if(t.attachShader(i,n),t.attachShader(i,a),this.attribSemantics.POSITION)t.bindAttribLocation(i,0,this.attribSemantics.POSITION.symbol);else{var o=Object.keys(this.attributeTemplates);t.bindAttribLocation(i,0,o[0])}if(t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))return"Could not link program\nVALIDATE_STATUS: "+t.getProgramParameter(i,t.VALIDATE_STATUS)+", gl error ["+t.getError()+"]";for(var u=0;this._uniformList.length>u;u++){var h=this._uniformList[u],c=this._cache.get("locations");c[h]=t.getUniformLocation(i,h)}t.deleteShader(n),t.deleteShader(a),this._cache.put("program",i)},_checkShaderErrorMsg:function(t,e,i){return t.getShaderParameter(e,t.COMPILE_STATUS)?void 0:[t.getShaderInfoLog(e),r(i)].join("\n")},clone:function(){var t=new T({vertex:this.vertex,fragment:this.fragment,vertexDefines:n.clone(this.vertexDefines),fragmentDefines:n.clone(this.fragmentDefines)});for(var e in this._textureStatus)t._textureStatus[e]=n.clone(this._textureStatus[e]);return t},dispose:function(t){this._cache.use(t.__GLID__);var e=this._cache.get("program");e&&t.deleteProgram(e),this._cache.deleteContext(t.__GLID__),this._locations={}}}),b=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;T.parseImport=function(t){return t=t.replace(b,function(t,e,r){var t=T.source(r);return t?T.parseImport(t):(console.warn('Shader chunk "'+r+'" not existed in library'),"")})};var x=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;return T["import"]=function(t){t.replace(x,function(t,e,r,i){var i=i.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(i){for(var n,a=r.split("."),s=T.codes,o=0;a.length-1>o;)n=a[o++],s[n]||(s[n]={}),s=s[n];n=a[o],s[n]=i}return i})},T.codes={},T.source=function(t){for(var e=t.split("."),r=T.codes,i=0;r&&e.length>i;){var n=e[i++];r=r[n]}return r?r:(console.warn('Shader "'+t+'" not existed in library'),void 0)},T}),define("echarts-x/util/shader/albedo.essl",function(){return"@export ecx.albedo.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nattribute vec2 texcoord : TEXCOORD_0;\nattribute vec3 position: POSITION;\n\n#ifdef VERTEX_COLOR\nattribute vec4 a_Color : COLOR;\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n    v_Texcoord = texcoord;\n\n    #ifdef VERTEX_COLOR\n    v_Color = a_Color;\n    #endif\n}\n\n@end\n\n@export ecx.albedo.fragment\n\nuniform sampler2D diffuseMap;\nuniform vec3 color : [1.0, 1.0, 1.0];\nuniform float alpha : 1.0;\n\n#ifdef VERTEX_COLOR\nvarying vec4 v_Color;\n#endif\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    gl_FragColor = vec4(color, alpha);\n    \n    #ifdef VERTEX_COLOR\n        gl_FragColor *= v_Color;\n    #endif\n    #ifdef DIFFUSEMAP_ENABLED\n        vec4 tex = texture2D(diffuseMap, v_Texcoord);\n        // Premultiplied alpha\n        #ifdef PREMULTIPLIED_ALPHA\n        tex.rgb /= tex.a;\n        #endif\n        gl_FragColor *= tex;\n    #endif\n}\n@end"}),define("echarts-x/util/shader/points.essl",function(){return"@export ecx.points.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float elapsedTime : 0;\n\nattribute vec3 position : POSITION;\nattribute vec4 color : COLOR;\nattribute float size;\n\n#ifdef ANIMATING\nattribute float delay;\n#endif\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    #ifdef ANIMATING\n        gl_PointSize = size * (sin((elapsedTime + delay) * 3.14) * 0.5 + 1.0);\n    #else\n        gl_PointSize = size;\n    #endif\n\n    v_Color = color;\n}\n\n@end\n\n@export ecx.points.fragment\n\nvarying vec4 v_Color;\nuniform sampler2D sprite;\n\nvoid main()\n{\n    vec4 color = v_Color;\n\n    #ifdef SPRITE_ENABLED\n        color *= texture2D(sprite, gl_PointCoord);\n    #endif\n\n    gl_FragColor = color;\n}\n@end"}),define("echarts-x/util/shader/curveAnimatingPoints.essl",function(){return"@export ecx.curveAnimatingPoints.vertex\n\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\nuniform float percent : 0.0;\nuniform float pointSize : 2.0;\n\nattribute vec3 p0;\nattribute vec3 p1;\nattribute vec3 p2;\nattribute vec3 p3;\nattribute vec4 color : COLOR;\n\nattribute float offset;\nattribute float size;\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    float t = mod(offset + percent, 1.0);\n    float onet = 1.0 - t;\n    vec3 position = onet * onet * (onet * p0 + 3.0 * t * p1)\n        + t * t * (t * p3 + 3.0 * onet * p2);\n\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n\n    gl_PointSize = pointSize * size;\n\n    v_Color = color;\n}\n\n@end\n\n@export ecx.curveAnimatingPoints.fragment\n\nvarying vec4 v_Color;\n\nvoid main()\n{\n    gl_FragColor = v_Color;\n}\n@end"}),define("echarts-x/util/shader/vectorFieldParticle.essl",function(){return"@export ecx.vfParticle.particle.fragment\n\nuniform sampler2D particleTexture;\nuniform sampler2D spawnTexture;\nuniform sampler2D velocityTexture;\n\nuniform float deltaTime;\nuniform float elapsedTime;\n\nuniform float speedScaling : 1.0;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    vec4 p = texture2D(particleTexture, v_Texcoord);\n    if (p.w > 0.0) {\n        vec4 vTex = texture2D(velocityTexture, p.xy);\n        vec2 v = vTex.xy;\n        v = (v - 0.5) * 2.0;\n        p.z = length(v);\n        p.xy += v * deltaTime / 50.0 * speedScaling;\n        // Make the particle surface seamless \n        p.xy = fract(p.xy);\n        p.w -= deltaTime;\n    }\n    else {\n        p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));\n    }\n    gl_FragColor = p;\n}\n@end\n\n@export ecx.vfParticle.renderPoints.vertex\n\n#define PI 3.1415926\n\nattribute vec2 texcoord : TEXCOORD_0;\n\nuniform float radius: 100;\nuniform sampler2D particleTexture;\nuniform mat4 worldViewProjection : WORLDVIEWPROJECTION;\n\nuniform float sizeScaling : 1.0;\n\nvarying float alpha;\n\nvoid main()\n{\n    vec4 p = texture2D(particleTexture, texcoord);\n\n    if (p.w <= 0.0) {\n        gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);\n    }\n    else {\n        gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);\n    }\n\n    gl_PointSize = sizeScaling * p.z;\n\n    alpha = p.z;\n}\n\n@end\n\n@export ecx.vfParticle.renderPoints.fragment\n\nuniform sampler2D spriteTexture;\nuniform vec4 color : [1.0, 1.0, 1.0, 1.0];\n\nvarying float alpha;\n\nvoid main()\n{\n    gl_FragColor = color * texture2D(spriteTexture, gl_PointCoord);\n    // FIXME Point should not be in the field zero\n    gl_FragColor.a *= alpha;\n}\n\n@end\n"}),define("echarts-x/util/shader/motionBlur.essl",function(){return"@export ecx.motionBlur.fragment\n\nuniform sampler2D lastFrame;\nuniform sampler2D thisFrame;\n\nuniform float percent: 0.7;\n\nvarying vec2 v_Texcoord;\n\nvoid main()\n{\n    vec4 tex0 = texture2D(lastFrame, v_Texcoord);\n    vec4 tex1 = texture2D(thisFrame, v_Texcoord);\n\n    gl_FragColor = tex0 * percent + tex1;\n}\n\n@end"}),define("qtek/core/Base",["require","./mixin/derive","./mixin/notifier","./util"],function(t){"use strict";var e=t("./mixin/derive"),r=t("./mixin/notifier"),i=t("./util"),n=function(){this.__GUID__=i.genGUID()};return n.__initializers__=[function(t){i.extend(this,t)}],i.extend(n,e),i.extend(n.prototype,r),n}),define("qtek/core/util",["require"],function(){"use strict";var t=0,e={genGUID:function(){return++t},relative2absolute:function(t,e){if(!e||t.match(/^\//))return t;for(var r=t.split("/"),i=e.split("/"),n=r[0];"."===n||".."===n;)".."===n&&i.pop(),r.shift(),n=r[0];return i.join("/")+"/"+r.join("/")},extend:function(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},defaults:function(t,e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r]);return t},extendWithPropList:function(t,e,r){if(e)for(var i=0;r.length>i;i++){var n=r[i];t[n]=e[n]}return t},defaultsWithPropList:function(t,e,r){if(e)for(var i=0;r.length>i;i++){var n=r[i];void 0===t[n]&&(t[n]=e[n])}return t},each:function(t,e,r){if(t&&e)if(t.forEach)t.forEach(e,r);else if(t.length===+t.length)for(var i=0,n=t.length;n>i;i++)e.call(r,t[i],i,t);else for(var a in t)t.hasOwnProperty(a)&&e.call(r,t[a],a,t)},isObject:function(t){return t===Object(t)},isArray:function(t){return t instanceof Array},isArrayLike:function(t){return t?t.length===+t.length:!1},clone:function(t){if(e.isObject(t)){if(e.isArray(t))return t.slice();if(e.isArrayLike(t)){for(var r=new t.constructor(t.length),i=0;t.length>i;i++)r[i]=t[i];return r}return e.extend({},t)}return t}};return e}),define("qtek/core/Cache",[],function(){"use strict";var t=function(){this._contextId=0,this._caches=[],this._context={}};return t.prototype={use:function(t,e){this._caches[t]||(this._caches[t]={},e&&(this._caches[t]=e())),this._contextId=t,this._context=this._caches[t]},put:function(t,e){this._context[t]=e},get:function(t){return this._context[t]},dirty:function(t){t=t||"";var e="__dirty__"+t;this.put(e,!0)},dirtyAll:function(t){t=t||"";for(var e="__dirty__"+t,r=0;this._caches.length>r;r++)this._caches[r]&&(this._caches[r][e]=!0)},fresh:function(t){t=t||"";var e="__dirty__"+t;this.put(e,!1)},freshAll:function(t){t=t||"";for(var e="__dirty__"+t,r=0;this._caches.length>r;r++)this._caches[r]&&(this._caches[r][e]=!1)},isDirty:function(t){t=t||"";var e="__dirty__"+t;return!this._context.hasOwnProperty(e)||this._context[e]===!0},deleteContext:function(t){delete this._caches[t],this._context={}},"delete":function(t){delete this._context[t]},clearAll:function(){this._caches={}},getContext:function(){return this._context},miss:function(t){return!this._context.hasOwnProperty(t)}},t.prototype.constructor=t,t}),function(t){"use strict";var e={};"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e.exports={},define("qtek/dep/glmatrix",[],function(){return e.exports})):e.exports="undefined"!=typeof window?window:t:e.exports=exports,function(t){if(!e)var e=1e-6;if(!r)var r="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var n={};n.setMatrixArrayType=function(t){r=t},t!==void 0&&(t.glMatrix=n);var a=Math.PI/180;n.toRadian=function(t){return t*a};var s={};s.create=function(){var t=new r(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var e=new r(2);return e[0]=t[0],e[1]=t[1],e},s.fromValues=function(t,e){var i=new r(2);return i[0]=t,i[1]=e,i},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},s.set=function(t,e,r){return t[0]=e,t[1]=r,t},s.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},s.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t},s.sub=s.subtract,s.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},s.mul=s.multiply,s.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},s.div=s.divide,s.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},s.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},s.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},s.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t},s.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)},s.dist=s.distance,s.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},s.len=s.length,s.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var r=e[0],i=e[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.cross=function(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t},s.lerp=function(t,e,r,i){var n=e[0],a=e[1];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t},s.random=function(t,e){e=e||1;var r=2*i()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},s.transformMat2=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t},s.transformMat2d=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t},s.transformMat3=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t},s.transformMat4=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t},s.forEach=function(){var t=s.create();return function(e,r,i,n,a,s){var o,u;for(r||(r=2),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,o=i;u>o;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}}(),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t!==void 0&&(t.vec2=s);var o={};o.create=function(){var t=new r(3);return t[0]=0,t[1]=0,t[2]=0,t},o.clone=function(t){var e=new r(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.fromValues=function(t,e,i){var n=new r(3);return n[0]=t,n[1]=e,n[2]=i,n},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.set=function(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t},o.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},o.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t},o.sub=o.subtract,o.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},o.mul=o.multiply,o.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},o.div=o.divide,o.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},o.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},o.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},o.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t},o.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)},o.dist=o.distance,o.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)},o.len=o.length,o.squaredLength=function(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},o.cross=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=r[0],o=r[1],u=r[2];return t[0]=n*u-a*o,t[1]=a*s-i*u,t[2]=i*o-n*s,t},o.lerp=function(t,e,r,i){var n=e[0],a=e[1],s=e[2];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=s+i*(r[2]-s),t},o.random=function(t,e){e=e||1;var r=2*i()*Math.PI,n=2*i()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},o.transformMat4=function(t,e,r){var i=e[0],n=e[1],a=e[2];return t[0]=r[0]*i+r[4]*n+r[8]*a+r[12],t[1]=r[1]*i+r[5]*n+r[9]*a+r[13],t[2]=r[2]*i+r[6]*n+r[10]*a+r[14],t},o.transformMat3=function(t,e,r){var i=e[0],n=e[1],a=e[2];return t[0]=i*r[0]+n*r[3]+a*r[6],t[1]=i*r[1]+n*r[4]+a*r[7],t[2]=i*r[2]+n*r[5]+a*r[8],t},o.transformQuat=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=r[0],o=r[1],u=r[2],h=r[3],c=h*i+o*a-u*n,l=h*n+u*i-s*a,f=h*a+s*n-o*i,_=-s*i-o*n-u*a;return t[0]=c*h+_*-s+l*-u-f*-o,t[1]=l*h+_*-o+f*-s-c*-u,t[2]=f*h+_*-u+c*-o-l*-s,t},o.forEach=function(){var t=o.create();return function(e,r,i,n,a,s){var o,u;for(r||(r=3),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,o=i;u>o;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}(),o.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},t!==void 0&&(t.vec3=o);var u={};u.create=function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var e=new r(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.fromValues=function(t,e,i,n){var a=new r(4);return a[0]=t,a[1]=e,a[2]=i,a[3]=n,a},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},u.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},u.subtract=function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t},u.sub=u.subtract,u.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},u.mul=u.multiply,u.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},u.div=u.divide,u.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},u.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},u.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},u.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},u.distance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(r*r+i*i+n*n+a*a)},u.dist=u.distance,u.squaredDistance=function(t,e){var r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return r*r+i*i+n*n+a*a},u.sqrDist=u.squaredDistance,u.length=function(t){var e=t[0],r=t[1],i=t[2],n=t[3];return Math.sqrt(e*e+r*r+i*i+n*n)},u.len=u.length,u.squaredLength=function(t){var e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n},u.sqrLen=u.squaredLength,u.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},u.normalize=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=r*r+i*i+n*n+a*a;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s),t},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},u.lerp=function(t,e,r,i){var n=e[0],a=e[1],s=e[2],o=e[3];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=s+i*(r[2]-s),t[3]=o+i*(r[3]-o),t},u.random=function(t,e){return e=e||1,t[0]=i(),t[1]=i(),t[2]=i(),t[3]=i(),u.normalize(t,t),u.scale(t,t,e),t},u.transformMat4=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*s,t[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*s,t[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*s,t[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*s,t},u.transformQuat=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=r[0],o=r[1],u=r[2],h=r[3],c=h*i+o*a-u*n,l=h*n+u*i-s*a,f=h*a+s*n-o*i,_=-s*i-o*n-u*a;return t[0]=c*h+_*-s+l*-u-f*-o,t[1]=l*h+_*-o+f*-s-c*-u,t[2]=f*h+_*-u+c*-o-l*-s,t},u.forEach=function(){var t=u.create();return function(e,r,i,n,a,s){var o,u;for(r||(r=4),i||(i=0),u=n?Math.min(n*r+i,e.length):e.length,o=i;u>o;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.vec4=u);var h={};h.create=function(){var t=new r(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.clone=function(t){var e=new r(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},h.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},h.invert=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=r*a-n*i;return s?(s=1/s,t[0]=a*s,t[1]=-i*s,t[2]=-n*s,t[3]=r*s,t):null},h.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},h.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},h.multiply=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],u=r[1],h=r[2],c=r[3];return t[0]=i*o+n*h,t[1]=i*u+n*c,t[2]=a*o+s*h,t[3]=a*u+s*c,t},h.mul=h.multiply,h.rotate=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=i*u+n*o,t[1]=i*-o+n*u,t[2]=a*u+s*o,t[3]=a*-o+s*u,t},h.scale=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],u=r[1];return t[0]=i*o,t[1]=n*u,t[2]=a*o,t[3]=s*u,t},h.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.mat2=h);var c={};c.create=function(){var t=new r(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.clone=function(t){var e=new r(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e
},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.invert=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=r*a-i*n;return u?(u=1/u,t[0]=a*u,t[1]=-i*u,t[2]=-n*u,t[3]=r*u,t[4]=(n*o-a*s)*u,t[5]=(i*s-r*o)*u,t):null},c.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},c.multiply=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=r[0],c=r[1],l=r[2],f=r[3],_=r[4],d=r[5];return t[0]=i*h+n*l,t[1]=i*c+n*f,t[2]=a*h+s*l,t[3]=a*c+s*f,t[4]=h*o+l*u+_,t[5]=c*o+f*u+d,t},c.mul=c.multiply,c.rotate=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=Math.sin(r),c=Math.cos(r);return t[0]=i*c+n*h,t[1]=-i*h+n*c,t[2]=a*c+s*h,t[3]=-a*h+c*s,t[4]=c*o+h*u,t[5]=c*u-h*o,t},c.scale=function(t,e,r){var i=r[0],n=r[1];return t[0]=e[0]*i,t[1]=e[1]*n,t[2]=e[2]*i,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*n,t},c.translate=function(t,e,r){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+r[0],t[5]=e[5]+r[1],t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},t!==void 0&&(t.mat2d=c);var l={};l.create=function(){var t=new r(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},l.clone=function(t){var e=new r(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},l.invert=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=c*s-o*h,f=-c*a+o*u,_=h*a-s*u,d=r*l+i*f+n*_;return d?(d=1/d,t[0]=l*d,t[1]=(-c*i+n*h)*d,t[2]=(o*i-n*s)*d,t[3]=f*d,t[4]=(c*r-n*u)*d,t[5]=(-o*r+n*a)*d,t[6]=_*d,t[7]=(-h*r+i*u)*d,t[8]=(s*r-i*a)*d,t):null},l.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8];return t[0]=s*c-o*h,t[1]=n*h-i*c,t[2]=i*o-n*s,t[3]=o*u-a*c,t[4]=r*c-n*u,t[5]=n*a-r*o,t[6]=a*h-s*u,t[7]=i*u-r*h,t[8]=r*s-i*a,t},l.determinant=function(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8];return e*(h*a-s*u)+r*(-h*n+s*o)+i*(u*n-a*o)},l.multiply=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=r[0],_=r[1],d=r[2],m=r[3],v=r[4],p=r[5],y=r[6],g=r[7],E=r[8];return t[0]=f*i+_*s+d*h,t[1]=f*n+_*o+d*c,t[2]=f*a+_*u+d*l,t[3]=m*i+v*s+p*h,t[4]=m*n+v*o+p*c,t[5]=m*a+v*u+p*l,t[6]=y*i+g*s+E*h,t[7]=y*n+g*o+E*c,t[8]=y*a+g*u+E*l,t},l.mul=l.multiply,l.translate=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=r[0],_=r[1];return t[0]=i,t[1]=n,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=f*i+_*s+h,t[7]=f*n+_*o+c,t[8]=f*a+_*u+l,t},l.rotate=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=Math.sin(r),_=Math.cos(r);return t[0]=_*i+f*s,t[1]=_*n+f*o,t[2]=_*a+f*u,t[3]=_*s-f*i,t[4]=_*o-f*n,t[5]=_*u-f*a,t[6]=h,t[7]=c,t[8]=l,t},l.scale=function(t,e,r){var i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},l.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},l.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=r+r,o=i+i,u=n+n,h=r*s,c=i*s,l=i*o,f=n*s,_=n*o,d=n*u,m=a*s,v=a*o,p=a*u;return t[0]=1-l-d,t[3]=c-p,t[6]=f+v,t[1]=c+p,t[4]=1-h-d,t[7]=_-m,t[2]=f-v,t[5]=_+m,t[8]=1-h-l,t},l.normalFromMat4=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],_=e[11],d=e[12],m=e[13],v=e[14],p=e[15],y=r*o-i*s,g=r*u-n*s,E=r*h-a*s,T=i*u-n*o,b=i*h-a*o,x=n*h-a*u,R=c*m-l*d,A=c*v-f*d,S=c*p-_*d,N=l*v-f*m,M=l*p-_*m,P=f*p-_*v,I=y*P-g*M+E*N+T*S-b*A+x*R;return I?(I=1/I,t[0]=(o*P-u*M+h*N)*I,t[1]=(u*S-s*P-h*A)*I,t[2]=(s*M-o*S+h*R)*I,t[3]=(n*M-i*P-a*N)*I,t[4]=(r*P-n*S+a*A)*I,t[5]=(i*S-r*M-a*R)*I,t[6]=(m*x-v*b+p*T)*I,t[7]=(v*E-d*x-p*g)*I,t[8]=(d*b-m*E+p*y)*I,t):null},l.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},t!==void 0&&(t.mat3=l);var f={};f.create=function(){var t=new r(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.clone=function(t){var e=new r(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},f.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],n=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=n,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},f.invert=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],_=e[11],d=e[12],m=e[13],v=e[14],p=e[15],y=r*o-i*s,g=r*u-n*s,E=r*h-a*s,T=i*u-n*o,b=i*h-a*o,x=n*h-a*u,R=c*m-l*d,A=c*v-f*d,S=c*p-_*d,N=l*v-f*m,M=l*p-_*m,P=f*p-_*v,I=y*P-g*M+E*N+T*S-b*A+x*R;return I?(I=1/I,t[0]=(o*P-u*M+h*N)*I,t[1]=(n*M-i*P-a*N)*I,t[2]=(m*x-v*b+p*T)*I,t[3]=(f*b-l*x-_*T)*I,t[4]=(u*S-s*P-h*A)*I,t[5]=(r*P-n*S+a*A)*I,t[6]=(v*E-d*x-p*g)*I,t[7]=(c*x-f*E+_*g)*I,t[8]=(s*M-o*S+h*R)*I,t[9]=(i*S-r*M-a*R)*I,t[10]=(d*b-m*E+p*y)*I,t[11]=(l*E-c*b-_*y)*I,t[12]=(o*A-s*N-u*R)*I,t[13]=(r*N-i*A+n*R)*I,t[14]=(m*g-d*T-v*y)*I,t[15]=(c*T-l*g+f*y)*I,t):null},f.adjoint=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],u=e[6],h=e[7],c=e[8],l=e[9],f=e[10],_=e[11],d=e[12],m=e[13],v=e[14],p=e[15];return t[0]=o*(f*p-_*v)-l*(u*p-h*v)+m*(u*_-h*f),t[1]=-(i*(f*p-_*v)-l*(n*p-a*v)+m*(n*_-a*f)),t[2]=i*(u*p-h*v)-o*(n*p-a*v)+m*(n*h-a*u),t[3]=-(i*(u*_-h*f)-o*(n*_-a*f)+l*(n*h-a*u)),t[4]=-(s*(f*p-_*v)-c*(u*p-h*v)+d*(u*_-h*f)),t[5]=r*(f*p-_*v)-c*(n*p-a*v)+d*(n*_-a*f),t[6]=-(r*(u*p-h*v)-s*(n*p-a*v)+d*(n*h-a*u)),t[7]=r*(u*_-h*f)-s*(n*_-a*f)+c*(n*h-a*u),t[8]=s*(l*p-_*m)-c*(o*p-h*m)+d*(o*_-h*l),t[9]=-(r*(l*p-_*m)-c*(i*p-a*m)+d*(i*_-a*l)),t[10]=r*(o*p-h*m)-s*(i*p-a*m)+d*(i*h-a*o),t[11]=-(r*(o*_-h*l)-s*(i*_-a*l)+c*(i*h-a*o)),t[12]=-(s*(l*v-f*m)-c*(o*v-u*m)+d*(o*f-u*l)),t[13]=r*(l*v-f*m)-c*(i*v-n*m)+d*(i*f-n*l),t[14]=-(r*(o*v-u*m)-s*(i*v-n*m)+d*(i*u-n*o)),t[15]=r*(o*f-u*l)-s*(i*f-n*l)+c*(i*u-n*o),t},f.determinant=function(t){var e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],s=t[5],o=t[6],u=t[7],h=t[8],c=t[9],l=t[10],f=t[11],_=t[12],d=t[13],m=t[14],v=t[15],p=e*s-r*a,y=e*o-i*a,g=e*u-n*a,E=r*o-i*s,T=r*u-n*s,b=i*u-n*o,x=h*d-c*_,R=h*m-l*_,A=h*v-f*_,S=c*m-l*d,N=c*v-f*d,M=l*v-f*m;return p*M-y*N+g*S+E*A-T*R+b*x},f.multiply=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],_=e[10],d=e[11],m=e[12],v=e[13],p=e[14],y=e[15],g=r[0],E=r[1],T=r[2],b=r[3];return t[0]=g*i+E*o+T*l+b*m,t[1]=g*n+E*u+T*f+b*v,t[2]=g*a+E*h+T*_+b*p,t[3]=g*s+E*c+T*d+b*y,g=r[4],E=r[5],T=r[6],b=r[7],t[4]=g*i+E*o+T*l+b*m,t[5]=g*n+E*u+T*f+b*v,t[6]=g*a+E*h+T*_+b*p,t[7]=g*s+E*c+T*d+b*y,g=r[8],E=r[9],T=r[10],b=r[11],t[8]=g*i+E*o+T*l+b*m,t[9]=g*n+E*u+T*f+b*v,t[10]=g*a+E*h+T*_+b*p,t[11]=g*s+E*c+T*d+b*y,g=r[12],E=r[13],T=r[14],b=r[15],t[12]=g*i+E*o+T*l+b*m,t[13]=g*n+E*u+T*f+b*v,t[14]=g*a+E*h+T*_+b*p,t[15]=g*s+E*c+T*d+b*y,t},f.mul=f.multiply,f.translate=function(t,e,r){var i,n,a,s,o,u,h,c,l,f,_,d,m,v,p,y,g=r[0],E=r[1],T=r[2];return i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],u=e[5],h=e[6],c=e[7],l=e[8],f=e[9],_=e[10],d=e[11],m=e[12],v=e[13],p=e[14],y=e[15],t[0]=i+s*g,t[1]=n+s*E,t[2]=a+s*T,t[3]=s,t[4]=o+c*g,t[5]=u+c*E,t[6]=h+c*T,t[7]=c,t[8]=l+d*g,t[9]=f+d*E,t[10]=_+d*T,t[11]=d,t[12]=m+y*g,t[13]=v+y*E,t[14]=p+y*T,t[15]=y,t},f.scale=function(t,e,r){var i=r[0],n=r[1],a=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},f.rotate=function(t,r,i,n){var a,s,o,u,h,c,l,f,_,d,m,v,p,y,g,E,T,b,x,R,A,S,N,M,P=n[0],I=n[1],L=n[2],O=Math.sqrt(P*P+I*I+L*L);return e>Math.abs(O)?null:(O=1/O,P*=O,I*=O,L*=O,a=Math.sin(i),s=Math.cos(i),o=1-s,u=r[0],h=r[1],c=r[2],l=r[3],f=r[4],_=r[5],d=r[6],m=r[7],v=r[8],p=r[9],y=r[10],g=r[11],E=P*P*o+s,T=I*P*o+L*a,b=L*P*o-I*a,x=P*I*o-L*a,R=I*I*o+s,A=L*I*o+P*a,S=P*L*o+I*a,N=I*L*o-P*a,M=L*L*o+s,t[0]=u*E+f*T+v*b,t[1]=h*E+_*T+p*b,t[2]=c*E+d*T+y*b,t[3]=l*E+m*T+g*b,t[4]=u*x+f*R+v*A,t[5]=h*x+_*R+p*A,t[6]=c*x+d*R+y*A,t[7]=l*x+m*R+g*A,t[8]=u*S+f*N+v*M,t[9]=h*S+_*N+p*M,t[10]=c*S+d*N+y*M,t[11]=l*S+m*N+g*M,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},f.rotateX=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[4],s=e[5],o=e[6],u=e[7],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+h*i,t[5]=s*n+c*i,t[6]=o*n+l*i,t[7]=u*n+f*i,t[8]=h*n-a*i,t[9]=c*n-s*i,t[10]=l*n-o*i,t[11]=f*n-u*i,t},f.rotateY=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[8],c=e[9],l=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n-h*i,t[1]=s*n-c*i,t[2]=o*n-l*i,t[3]=u*n-f*i,t[8]=a*i+h*n,t[9]=s*i+c*n,t[10]=o*i+l*n,t[11]=u*i+f*n,t},f.rotateZ=function(t,e,r){var i=Math.sin(r),n=Math.cos(r),a=e[0],s=e[1],o=e[2],u=e[3],h=e[4],c=e[5],l=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+h*i,t[1]=s*n+c*i,t[2]=o*n+l*i,t[3]=u*n+f*i,t[4]=h*n-a*i,t[5]=c*n-s*i,t[6]=l*n-o*i,t[7]=f*n-u*i,t},f.fromRotationTranslation=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=i+i,u=n+n,h=a+a,c=i*o,l=i*u,f=i*h,_=n*u,d=n*h,m=a*h,v=s*o,p=s*u,y=s*h;return t[0]=1-(_+m),t[1]=l+y,t[2]=f-p,t[3]=0,t[4]=l-y,t[5]=1-(c+m),t[6]=d+v,t[7]=0,t[8]=f+p,t[9]=d-v,t[10]=1-(c+_),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},f.fromQuat=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=r+r,o=i+i,u=n+n,h=r*s,c=i*s,l=i*o,f=n*s,_=n*o,d=n*u,m=a*s,v=a*o,p=a*u;return t[0]=1-l-d,t[1]=c+p,t[2]=f-v,t[3]=0,t[4]=c-p,t[5]=1-h-d,t[6]=_+m,t[7]=0,t[8]=f+v,t[9]=_-m,t[10]=1-h-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.frustum=function(t,e,r,i,n,a,s){var o=1/(r-e),u=1/(n-i),h=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(n+i)*u,t[10]=(s+a)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*s*a*h,t[15]=0,t},f.perspective=function(t,e,r,i,n){var a=1/Math.tan(e/2),s=1/(i-n);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*i*s,t[15]=0,t},f.ortho=function(t,e,r,i,n,a,s){var o=1/(e-r),u=1/(i-n),h=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*o,t[13]=(n+i)*u,t[14]=(s+a)*h,t[15]=1,t},f.lookAt=function(t,r,i,n){var a,s,o,u,h,c,l,_,d,m,v=r[0],p=r[1],y=r[2],g=n[0],E=n[1],T=n[2],b=i[0],x=i[1],R=i[2];return e>Math.abs(v-b)&&e>Math.abs(p-x)&&e>Math.abs(y-R)?f.identity(t):(l=v-b,_=p-x,d=y-R,m=1/Math.sqrt(l*l+_*_+d*d),l*=m,_*=m,d*=m,a=E*d-T*_,s=T*l-g*d,o=g*_-E*l,m=Math.sqrt(a*a+s*s+o*o),m?(m=1/m,a*=m,s*=m,o*=m):(a=0,s=0,o=0),u=_*o-d*s,h=d*a-l*o,c=l*s-_*a,m=Math.sqrt(u*u+h*h+c*c),m?(m=1/m,u*=m,h*=m,c*=m):(u=0,h=0,c=0),t[0]=a,t[1]=u,t[2]=l,t[3]=0,t[4]=s,t[5]=h,t[6]=_,t[7]=0,t[8]=o,t[9]=c,t[10]=d,t[11]=0,t[12]=-(a*v+s*p+o*y),t[13]=-(u*v+h*p+c*y),t[14]=-(l*v+_*p+d*y),t[15]=1,t)},f.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},t!==void 0&&(t.mat4=f);var _={};_.create=function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},_.rotationTo=function(){var t=o.create(),e=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(i,n,a){var s=o.dot(n,a);return-.999999>s?(o.cross(t,e,n),1e-6>o.length(t)&&o.cross(t,r,n),o.normalize(t,t),_.setAxisAngle(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(t,n,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,_.normalize(i,i))}}(),_.setAxes=function(){var t=l.create();return function(e,r,i,n){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],_.normalize(e,_.fromMat3(e,t))}}(),_.clone=u.clone,_.fromValues=u.fromValues,_.copy=u.copy,_.set=u.set,_.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},_.setAxisAngle=function(t,e,r){r=.5*r;var i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t},_.add=u.add,_.multiply=function(t,e,r){var i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],u=r[1],h=r[2],c=r[3];return t[0]=i*c+s*o+n*h-a*u,t[1]=n*c+s*u+a*o-i*h,t[2]=a*c+s*h+i*u-n*o,t[3]=s*c-i*o-n*u-a*h,t},_.mul=_.multiply,_.scale=u.scale,_.rotateX=function(t,e,r){r*=.5;var i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=i*u+s*o,t[1]=n*u+a*o,t[2]=a*u-n*o,t[3]=s*u-i*o,t},_.rotateY=function(t,e,r){r*=.5;var i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=i*u-a*o,t[1]=n*u+s*o,t[2]=a*u+i*o,t[3]=s*u-n*o,t},_.rotateZ=function(t,e,r){r*=.5;var i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),u=Math.cos(r);return t[0]=i*u+n*o,t[1]=n*u-i*o,t[2]=a*u+s*o,t[3]=s*u-a*o,t},_.calculateW=function(t,e){var r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=-Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t},_.dot=u.dot,_.lerp=u.lerp,_.slerp=function(t,e,r,i){var n,a,s,o,u,h=e[0],c=e[1],l=e[2],f=e[3],_=r[0],d=r[1],m=r[2],v=r[3];return a=h*_+c*d+l*m+f*v,0>a&&(a=-a,_=-_,d=-d,m=-m,v=-v),1-a>1e-6?(n=Math.acos(a),s=Math.sin(n),o=Math.sin((1-i)*n)/s,u=Math.sin(i*n)/s):(o=1-i,u=i),t[0]=o*h+u*_,t[1]=o*c+u*d,t[2]=o*l+u*m,t[3]=o*f+u*v,t},_.invert=function(t,e){var r=e[0],i=e[1],n=e[2],a=e[3],s=r*r+i*i+n*n+a*a,o=s?1/s:0;return t[0]=-r*o,t[1]=-i*o,t[2]=-n*o,t[3]=a*o,t},_.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},_.length=u.length,_.len=_.length,_.squaredLength=u.squaredLength,_.sqrLen=_.squaredLength,_.normalize=u.normalize,_.fromMat3=function(t,e){var r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var a=(n+1)%3,s=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*a+a]-e[3*s+s]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*s+a]-e[3*a+s])*r,t[a]=(e[3*a+n]+e[3*n+a])*r,t[s]=(e[3*s+n]+e[3*n+s])*r}return t},_.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},t!==void 0&&(t.quat=_)}(e.exports)}(this),define("qtek/core/mixin/derive",["require"],function(){"use strict";function t(t,i,n){"object"==typeof i&&(n=i,i=null);var a,s=this;if(!(t instanceof Function)){a=[];for(var o in t)t.hasOwnProperty(o)&&a.push(o)}var u=function(){if(s.apply(this,arguments),t instanceof Function?e(this,t.call(this)):r(this,t,a),this.constructor===u)for(var i=u.__initializers__,n=0;i.length>n;n++)i[n].apply(this,arguments)};u.__super__=s,u.__initializers__=s.__initializers__?s.__initializers__.slice():[],i&&u.__initializers__.push(i);var h=function(){};return h.prototype=s.prototype,u.prototype=new h,u.prototype.constructor=u,e(u.prototype,n),u.derive=s.derive,u}function e(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function r(t,e,r){for(var i=0;r.length>i;i++){var n=r[i];t[n]=e[n]}}return{derive:t}}),define("qtek/core/mixin/notifier",[],function(){function t(t,e){this.action=t,this.context=e}var e={trigger:function(t){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(t)){var e=this.__handlers__[t],r=e.length,i=-1,n=arguments;switch(n.length){case 1:for(;r>++i;)e[i].action.call(e[i].context);return;case 2:for(;r>++i;)e[i].action.call(e[i].context,n[1]);return;case 3:for(;r>++i;)e[i].action.call(e[i].context,n[1],n[2]);return;case 4:for(;r>++i;)e[i].action.call(e[i].context,n[1],n[2],n[3]);return;case 5:for(;r>++i;)e[i].action.call(e[i].context,n[1],n[2],n[3],n[4]);return;default:for(;r>++i;)e[i].action.apply(e[i].context,Array.prototype.slice.call(n,1));return}}},on:function(e,r,i){if(e&&r){var n=this.__handlers__||(this.__handlers__={});if(n[e]){if(this.has(e,r))return}else n[e]=[];var a=new t(r,i||this);return n[e].push(a),this}},once:function(t,e,r){function i(){n.off(t,i),e.apply(this,arguments)}if(t&&e){var n=this;return this.on(t,i,r)}},before:function(t,e,r){return t&&e?(t="before"+t,this.on(t,e,r)):void 0},after:function(t,e,r){return t&&e?(t="after"+t,this.on(t,e,r)):void 0},success:function(t,e){return this.once("success",t,e)},error:function(t,e){return this.once("error",t,e)},off:function(t,e){var r=this.__handlers__||(this.__handlers__={});if(!e)return r[t]=[],void 0;if(r[t]){for(var i=r[t],n=[],a=0;i.length>a;a++)e&&i[a].action!==e&&n.push(i[a]);r[t]=n}return this},has:function(t,e){var r=this.__handlers__;if(!r||!r[t])return!1;for(var i=r[t],n=0;i.length>n;n++)if(i[n].action===e)return!0}};return e});