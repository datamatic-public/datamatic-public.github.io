define("echarts/chart/map",["require","./base","zrender/shape/Text","zrender/shape/Path","zrender/shape/Circle","zrender/shape/Rectangle","zrender/shape/Line","zrender/shape/Polygon","zrender/shape/Ellipse","zrender/shape/Image","../component/dataRange","../component/roamController","../layer/heatmap","../config","../util/ecData","zrender/tool/util","zrender/config","zrender/tool/event","../util/mapData/params","../util/mapData/textFixed","../util/mapData/geoCoord","../util/projection/svg","../util/projection/normal","../chart"],function(t){function e(t,e,o,s,a){i.call(this,t,e,o,s,a);var n=this;n._onmousewheel=function(t){return n.__onmousewheel(t)},n._onmousedown=function(t){return n.__onmousedown(t)},n._onmousemove=function(t){return n.__onmousemove(t)},n._onmouseup=function(t){return n.__onmouseup(t)},n._onroamcontroller=function(t){return n.__onroamcontroller(t)},n._ondrhoverlink=function(t){return n.__ondrhoverlink(t)},this._isAlive=!0,this._selectedMode={},this._activeMapType={},this._clickable={},this._hoverable={},this._showLegendSymbol={},this._selected={},this._mapTypeMap={},this._mapDataMap={},this._nameMap={},this._specialArea={},this._refreshDelayTicket,this._mapDataRequireCounter,this._markAnimation=!1,this._hoverLinkMap={},this._roamMap={},this._scaleLimitMap={},this._mx,this._my,this._mousedown,this._justMove,this._curMapType,this.refresh(s),this.zr.on(f.EVENT.MOUSEWHEEL,this._onmousewheel),this.zr.on(f.EVENT.MOUSEDOWN,this._onmousedown),e.bind(p.EVENT.ROAMCONTROLLER,this._onroamcontroller),e.bind(p.EVENT.DATA_RANGE_HOVERLINK,this._ondrhoverlink)}var i=t("./base"),o=t("zrender/shape/Text"),s=t("zrender/shape/Path"),a=t("zrender/shape/Circle"),n=t("zrender/shape/Rectangle"),r=t("zrender/shape/Line"),h=t("zrender/shape/Polygon"),l=t("zrender/shape/Ellipse"),d=t("zrender/shape/Image");t("../component/dataRange"),t("../component/roamController");var c=t("../layer/heatmap"),p=t("../config");p.map={zlevel:0,z:2,mapType:"china",showLegendSymbol:!0,dataRangeHoverLink:!0,hoverable:!0,clickable:!0,itemStyle:{normal:{borderColor:"rgba(0,0,0,0)",borderWidth:1,areaStyle:{color:"#ccc"},label:{show:!1,textStyle:{color:"rgb(139,69,19)"}}},emphasis:{borderColor:"rgba(0,0,0,0)",borderWidth:1,areaStyle:{color:"rgba(255,215,0,0.8)"},label:{show:!1,textStyle:{color:"rgb(100,0,0)"}}}}};var u=t("../util/ecData"),g=t("zrender/tool/util"),f=t("zrender/config"),m=t("zrender/tool/event"),y=t("../util/mapData/params").params,_=t("../util/mapData/textFixed"),v=t("../util/mapData/geoCoord");return e.prototype={type:p.CHART_TYPE_MAP,_buildShape:function(){var t=this.series;this.selectedMap={},this._activeMapType={};for(var e,i,o,s,a=this.component.legend,n={},r={},h={},l={},d=0,c=t.length;c>d;d++)if(t[d].type==p.CHART_TYPE_MAP&&(t[d]=this.reformOption(t[d]),i=t[d].mapType,r[i]=r[i]||{},r[i][d]=!0,h[i]=h[i]||t[d].mapValuePrecision,this._scaleLimitMap[i]=this._scaleLimitMap[i]||{},t[d].scaleLimit&&g.merge(this._scaleLimitMap[i],t[d].scaleLimit,!0),this._roamMap[i]=t[d].roam||this._roamMap[i],(null==this._hoverLinkMap[i]||this._hoverLinkMap[i])&&(this._hoverLinkMap[i]=t[d].dataRangeHoverLink),this._nameMap[i]=this._nameMap[i]||{},t[d].nameMap&&g.merge(this._nameMap[i],t[d].nameMap,!0),this._activeMapType[i]=!0,t[d].textFixed&&g.merge(_,t[d].textFixed,!0),t[d].geoCoord&&g.merge(v,t[d].geoCoord,!0),this._selectedMode[i]=this._selectedMode[i]||t[d].selectedMode,(null==this._hoverable[i]||this._hoverable[i])&&(this._hoverable[i]=t[d].hoverable),(null==this._clickable[i]||this._clickable[i])&&(this._clickable[i]=t[d].clickable),(null==this._showLegendSymbol[i]||this._showLegendSymbol[i])&&(this._showLegendSymbol[i]=t[d].showLegendSymbol),l[i]=l[i]||t[d].mapValueCalculation,e=t[d].name,this.selectedMap[e]=a?a.isSelected(e):!0,this.selectedMap[e])){n[i]=n[i]||{},o=t[d].data;for(var u=0,f=o.length;f>u;u++){s=this._nameChange(i,o[u].name),n[i][s]=n[i][s]||{seriesIndex:[],valueMap:{},precision:0};for(var m in o[u])"value"!=m?n[i][s][m]=o[u][m]:isNaN(o[u].value)||(null==n[i][s].value&&(n[i][s].value=0),n[i][s].precision=Math.max(this.getPrecision(+o[u].value),n[i][s].precision),n[i][s].value+=+o[u].value,n[i][s].valueMap[d]=+o[u].value);n[i][s].seriesIndex.push(d)}}this._mapDataRequireCounter=0;for(var x in n)this._mapDataRequireCounter++;this._clearSelected(),0===this._mapDataRequireCounter&&(this.clear(),this.zr&&this.zr.delShape(this.lastShapeList),this.lastShapeList=[]);for(var x in n){for(var f in n[x]){"average"==l[x]&&(n[x][f].value/=n[x][f].seriesIndex.length);var b=n[x][f].value;null!=b&&(n[x][f].value=b.toFixed(null==h[x]?n[x][f].precision:h[x])-0)}this._mapDataMap[x]=this._mapDataMap[x]||{},this._mapDataMap[x].mapData?this._mapDataCallback(x,n[x],r[x])(this._mapDataMap[x].mapData):y[x.replace(/\|.*/,"")].getGeoJson&&(this._specialArea[x]=y[x.replace(/\|.*/,"")].specialArea||this._specialArea[x],y[x.replace(/\|.*/,"")].getGeoJson(this._mapDataCallback(x,n[x],r[x])))}},_mapDataCallback:function(e,i,o){var s=this;return function(a){s._isAlive&&null!=s._activeMapType[e]&&(-1!=e.indexOf("|")&&(a=s._getSubMapData(e,a)),s._mapDataMap[e].mapData=a,a.firstChild?(s._mapDataMap[e].rate=1,s._mapDataMap[e].projection=t("../util/projection/svg")):(s._mapDataMap[e].rate=.75,s._mapDataMap[e].projection=t("../util/projection/normal")),s._buildMap(e,s._getProjectionData(e,a,o),i,o),s._buildMark(e,o),--s._mapDataRequireCounter<=0&&(s.addShapeList(),s.zr.refreshNextFrame()),s._buildHeatmap(e))}},_clearSelected:function(){for(var t in this._selected)this._activeMapType[this._mapTypeMap[t]]||(delete this._selected[t],delete this._mapTypeMap[t])},_getSubMapData:function(t,e){for(var i=t.replace(/^.*\|/,""),o=e.features,s=0,a=o.length;a>s;s++)if(o[s].properties&&o[s].properties.name==i){o=o[s],"United States of America"==i&&o.geometry.coordinates.length>1&&(o={geometry:{coordinates:o.geometry.coordinates.slice(5,6),type:o.geometry.type},id:o.id,properties:o.properties,type:o.type});break}return{type:"FeatureCollection",features:[o]}},_getProjectionData:function(t,e,i){var o,s=this._mapDataMap[t].projection,a=[],n=this._mapDataMap[t].bbox||s.getBbox(e,this._specialArea[t]);o=this._mapDataMap[t].hasRoam?this._mapDataMap[t].transform:this._getTransform(n,i,this._mapDataMap[t].rate);var r,h=this._mapDataMap[t].lastTransform||{scale:{}};o.left!=h.left||o.top!=h.top||o.scale.x!=h.scale.x||o.scale.y!=h.scale.y?(r=s.geoJson2Path(e,o,this._specialArea[t]),h=g.clone(o)):(o=this._mapDataMap[t].transform,r=this._mapDataMap[t].pathArray),this._mapDataMap[t].bbox=n,this._mapDataMap[t].transform=o,this._mapDataMap[t].lastTransform=h,this._mapDataMap[t].pathArray=r;for(var l=[o.left,o.top],d=0,c=r.length;c>d;d++)a.push(this._getSingleProvince(t,r[d],l));if(this._specialArea[t])for(var p in this._specialArea[t])a.push(this._getSpecialProjectionData(t,e,p,this._specialArea[t][p],l));if("china"==t){var u=this.geo2pos(t,v["南海诸岛"]||y["南海诸岛"].textCoord),f=o.scale.x/10.5,m=[32*f+u[0],83*f+u[1]];_["南海诸岛"]&&(m[0]+=_["南海诸岛"][0],m[1]+=_["南海诸岛"][1]),a.push({name:this._nameChange(t,"南海诸岛"),path:y["南海诸岛"].getPath(u,f),position:l,textX:m[0],textY:m[1]})}return a},_getSpecialProjectionData:function(e,i,o,s,a){i=this._getSubMapData("x|"+o,i);var n=t("../util/projection/normal"),r=n.getBbox(i),h=this.geo2pos(e,[s.left,s.top]),l=this.geo2pos(e,[s.left+s.width,s.top+s.height]),d=Math.abs(l[0]-h[0]),c=Math.abs(l[1]-h[1]),p=r.width,u=r.height,g=d/.75/p,f=c/u;g>f?(g=.75*f,d=p*g):(f=g,g=.75*f,c=u*f);var m={OffsetLeft:h[0],OffsetTop:h[1],scale:{x:g,y:f}},y=n.geoJson2Path(i,m);return this._getSingleProvince(e,y[0],a)},_getSingleProvince:function(t,e,i){var o,s=e.properties.name,a=_[s]||[0,0];if(v[s])o=this.geo2pos(t,v[s]);else if(e.cp)o=[e.cp[0]+a[0],e.cp[1]+a[1]];else{var n=this._mapDataMap[t].bbox;o=this.geo2pos(t,[n.left+n.width/2,n.top+n.height/2]),o[0]+=a[0],o[1]+=a[1]}return e.name=this._nameChange(t,s),e.position=i,e.textX=o[0],e.textY=o[1],e},_getTransform:function(t,e,i){var o,s,a,n,r,h,l,d=this.series,c=this.zr.getWidth(),p=this.zr.getHeight(),u=Math.round(.02*Math.min(c,p));for(var g in e)o=d[g].mapLocation||{},a=o.x||a,r=o.y||r,h=o.width||h,l=o.height||l;s=this.parsePercent(a,c),s=isNaN(s)?u:s,n=this.parsePercent(r,p),n=isNaN(n)?u:n,h=null==h?c-s-2*u:this.parsePercent(h,c),l=null==l?p-n-2*u:this.parsePercent(l,p);var f=t.width,m=t.height,y=h/i/f,_=l/m;if(y>_?(y=_*i,h=f*y):(_=y,y=_*i,l=m*_),isNaN(a))switch(a=a||"center",a+""){case"center":s=Math.floor((c-h)/2);break;case"right":s=c-h}if(isNaN(r))switch(r=r||"center",r+""){case"center":n=Math.floor((p-l)/2);break;case"bottom":n=p-l}return{left:s,top:n,width:h,height:l,baseScale:1,scale:{x:y,y:_}}},_buildMap:function(t,e,i,d){for(var c,f,m,y,_,v,x,b,S,T,z,C=this.series,L=this.component.legend,M=this.component.dataRange,w=0,E=e.length;E>w;w++){if(b=g.clone(e[w]),S={name:b.name,path:b.path,position:g.clone(b.position)},f=b.name,m=i[f]){_=[m],c="";for(var A=0,k=m.seriesIndex.length;k>A;A++){var O=C[m.seriesIndex[A]];_.push(O),c+=O.name+" ",L&&this._showLegendSymbol[t]&&L.hasColor(O.name)&&this.shapeList.push(new a({zlevel:O.zlevel,z:O.z+1,position:g.clone(b.position),_mapType:t,style:{x:b.textX+3+7*A,y:b.textY-10,r:3,color:L.getColor(O.name)},hoverable:!1}))}y=m.value}else{m={name:f,value:"-"},c="",_=[];for(var I in d)_.push(C[I]);y="-"}switch(this.ecTheme.map&&_.push(this.ecTheme.map),_.push(p.map),v=M&&!isNaN(y)?M.getColor(y):null,b.color=b.color||v||this.getItemStyleColor(this.deepQuery(_,"itemStyle.normal.color"),m.seriesIndex,-1,m)||this.deepQuery(_,"itemStyle.normal.areaStyle.color"),b.strokeColor=b.strokeColor||this.deepQuery(_,"itemStyle.normal.borderColor"),b.lineWidth=b.lineWidth||this.deepQuery(_,"itemStyle.normal.borderWidth"),S.color=this.getItemStyleColor(this.deepQuery(_,"itemStyle.emphasis.color"),m.seriesIndex,-1,m)||this.deepQuery(_,"itemStyle.emphasis.areaStyle.color")||b.color,S.strokeColor=this.deepQuery(_,"itemStyle.emphasis.borderColor")||b.strokeColor,S.lineWidth=this.deepQuery(_,"itemStyle.emphasis.borderWidth")||b.lineWidth,b.brushType=S.brushType=b.brushType||"both",b.lineJoin=S.lineJoin="round",b._name=S._name=f,x=this.deepQuery(_,"itemStyle.normal.label.textStyle"),z={zlevel:this.getZlevelBase(),z:this.getZBase()+1,position:g.clone(b.position),_mapType:t,_geo:this.pos2geo(t,[b.textX,b.textY]),style:{brushType:"fill",x:b.textX,y:b.textY,text:this.getLabelText(f,y,_,"normal"),_name:f,textAlign:"center",color:this.deepQuery(_,"itemStyle.normal.label.show")?this.deepQuery(_,"itemStyle.normal.label.textStyle.color"):"rgba(0,0,0,0)",textFont:this.getFont(x)}},z._style=g.clone(z.style),z.highlightStyle=g.clone(z.style),this.deepQuery(_,"itemStyle.emphasis.label.show")?(z.highlightStyle.text=this.getLabelText(f,y,_,"emphasis"),z.highlightStyle.color=this.deepQuery(_,"itemStyle.emphasis.label.textStyle.color")||z.style.color,x=this.deepQuery(_,"itemStyle.emphasis.label.textStyle")||x,z.highlightStyle.textFont=this.getFont(x)):z.highlightStyle.color="rgba(0,0,0,0)",T={zlevel:this.getZlevelBase(),z:this.getZBase(),position:g.clone(b.position),style:b,highlightStyle:S,_style:g.clone(b),_mapType:t},null!=b.scale&&(T.scale=g.clone(b.scale)),z=new o(z),T.style.shapeType){case"rectangle":T=new n(T);break;case"line":T=new r(T);break;case"circle":T=new a(T);break;case"polygon":T=new h(T);break;case"ellipse":T=new l(T);break;default:T=new s(T),T.buildPathArray&&(T.style.pathArray=T.buildPathArray(T.style.path))}(this._selectedMode[t]&&this._selected[f]&&m.selected!==!1||m.selected===!0)&&(z.style=z.highlightStyle,T.style=T.highlightStyle),z.clickable=T.clickable=this._clickable[t]&&(null==m.clickable||m.clickable),this._selectedMode[t]&&(this._selected[f]=null!=this._selected[f]?this._selected[f]:m.selected,this._mapTypeMap[f]=t,(null==m.selectable||m.selectable)&&(T.clickable=z.clickable=!0,T.onclick=z.onclick=this.shapeHandler.onclick)),this._hoverable[t]&&(null==m.hoverable||m.hoverable)?(z.hoverable=T.hoverable=!0,T.hoverConnect=z.id,z.hoverConnect=T.id):z.hoverable=T.hoverable=!1,u.pack(z,{name:c,tooltip:this.deepQuery(_,"tooltip")},0,m,0,f),this.shapeList.push(z),u.pack(T,{name:c,tooltip:this.deepQuery(_,"tooltip")},0,m,0,f),this.shapeList.push(T)}},_buildMark:function(t,e){this._seriesIndexToMapType=this._seriesIndexToMapType||{},this.markAttachStyle=this.markAttachStyle||{};var i=[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top];"none"==t&&(i=[0,0]);for(var o in e)this._seriesIndexToMapType[o]=t,this.markAttachStyle[o]={position:i,_mapType:t},this.buildMark(o)},_buildHeatmap:function(t){for(var e=this.series,i=0,o=e.length;o>i;i++)if(e[i].heatmap){var s=e[i].heatmap.data;if(e[i].heatmap.needsTransform===!1){for(var a=[],n=0,r=s.length;r>n;++n)a.push([s[n][3],s[n][4],s[n][2]]);var h=[0,0]}else{var l=e[i].heatmap._geoData;if(void 0===l){e[i].heatmap._geoData=[];for(var n=0,r=s.length;r>n;++n)e[i].heatmap._geoData[n]=s[n];l=e[i].heatmap._geoData}for(var r=s.length,p=0;r>p;++p)s[p]=this.geo2pos(t,[l[p][0],l[p][1]]);var h=[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top]}var u=new c(e[i].heatmap),g=u.getCanvas(s[0][3]?a:s,this.zr.getWidth(),this.zr.getHeight()),f=new d({zlevel:this.getZlevelBase(),z:this.getZBase()+1,position:h,scale:[1,1],hoverable:!1,style:{x:0,y:0,image:g,width:g.width,height:g.height}});f.type="heatmap",f._mapType=t,this.shapeList.push(f),this.zr.addShape(f)}},getMarkCoord:function(t,e){return e.geoCoord||v[e.name]?this.geo2pos(this._seriesIndexToMapType[t],e.geoCoord||v[e.name]):[0,0]},getMarkGeo:function(t){return t.geoCoord||v[t.name]},_nameChange:function(t,e){return this._nameMap[t][e]||e},getLabelText:function(t,e,i,o){var s=this.deepQuery(i,"itemStyle."+o+".label.formatter");return s?"function"==typeof s?s.call(this.myChart,t,e):"string"==typeof s?(s=s.replace("{a}","{a0}").replace("{b}","{b0}"),s=s.replace("{a0}",t).replace("{b0}",e)):void 0:t},_findMapTypeByPos:function(t,e){var i,o,s,a,n;for(var r in this._mapDataMap)if(i=this._mapDataMap[r].transform,i&&this._roamMap[r]&&this._activeMapType[r]&&(o=i.left,s=i.top,a=i.width,n=i.height,t>=o&&o+a>=t&&e>=s&&s+n>=e))return r},__onmousewheel:function(t){function e(t,e){for(var i=0;i<t.pointList.length;i++){var o=t.pointList[i];o[0]*=e,o[1]*=e}var s=t.controlPointList;if(s)for(var i=0;i<s.length;i++){var o=s[i];o[0]*=e,o[1]*=e}}function i(t,e){t.xStart*=e,t.yStart*=e,t.xEnd*=e,t.yEnd*=e,null!=t.cpX1&&(t.cpX1*=e,t.cpY1*=e)}if(!(this.shapeList.length<=0)){for(var o=0,s=this.shapeList.length;s>o;o++){var a=this.shapeList[o];if(a.__animating)return}var n,r,h=t.event,l=m.getX(h),d=m.getY(h),c=m.getDelta(h),u=t.mapTypeControl;u||(u={},r=this._findMapTypeByPos(l,d),r&&this._roamMap[r]&&"move"!=this._roamMap[r]&&(u[r]=!0));var g=!1;for(r in u)if(u[r]){g=!0;var f=this._mapDataMap[r].transform,y=f.left,_=f.top,v=f.width,x=f.height,b=this.pos2geo(r,[l-y,d-_]);if(c>0){if(n=1.2,null!=this._scaleLimitMap[r].max&&f.baseScale>=this._scaleLimitMap[r].max)continue}else if(n=1/1.2,null!=this._scaleLimitMap[r].min&&f.baseScale<=this._scaleLimitMap[r].min)continue;f.baseScale*=n,f.scale.x*=n,f.scale.y*=n,f.width=v*n,f.height=x*n,this._mapDataMap[r].hasRoam=!0,this._mapDataMap[r].transform=f,b=this.geo2pos(r,b),f.left-=b[0]-(l-y),f.top-=b[1]-(d-_),this._mapDataMap[r].transform=f,this.clearEffectShape(!0);for(var o=0,s=this.shapeList.length;s>o;o++){var a=this.shapeList[o];if(a._mapType==r){var S=a.type,T=a.style;switch(a.position[0]=f.left,a.position[1]=f.top,S){case"path":case"symbol":case"circle":case"rectangle":case"polygon":case"line":case"ellipse":case"heatmap":a.scale[0]*=n,a.scale[1]*=n;break;case"mark-line":i(T,n);break;case"polyline":e(T,n);break;case"shape-bundle":for(var z=0;z<T.shapeList.length;z++){var C=T.shapeList[z];"mark-line"==C.type?i(C.style,n):"polyline"==C.type&&e(C.style,n)}break;case"icon":case"image":b=this.geo2pos(r,a._geo),T.x=T._x=b[0]-T.width/2,T.y=T._y=b[1]-T.height/2;break;default:b=this.geo2pos(r,a._geo),T.x=b[0],T.y=b[1],"text"==S&&(a._style.x=a.highlightStyle.x=b[0],a._style.y=a.highlightStyle.y=b[1])}this.zr.modShape(a.id)}}}if(g){m.stop(h),this.zr.refreshNextFrame();var L=this;clearTimeout(this._refreshDelayTicket),this._refreshDelayTicket=setTimeout(function(){L&&L.shapeList&&L.animationEffect()},100),this.messageCenter.dispatch(p.EVENT.MAP_ROAM,t.event,{type:"scale"},this.myChart)}}},__onmousedown:function(t){if(!(this.shapeList.length<=0)){var e=t.target;if(!e||!e.draggable){var i=t.event,o=m.getX(i),s=m.getY(i),a=this._findMapTypeByPos(o,s);if(a&&this._roamMap[a]&&"scale"!=this._roamMap[a]){this._mousedown=!0,this._mx=o,this._my=s,this._curMapType=a,this.zr.on(f.EVENT.MOUSEUP,this._onmouseup);var n=this;setTimeout(function(){n.zr.on(f.EVENT.MOUSEMOVE,n._onmousemove)},100)}}}},__onmousemove:function(t){if(this._mousedown&&this._isAlive){var e=t.event,i=m.getX(e),o=m.getY(e),s=this._mapDataMap[this._curMapType].transform;s.hasRoam=!0,s.left-=this._mx-i,s.top-=this._my-o,this._mx=i,this._my=o,this._mapDataMap[this._curMapType].transform=s;for(var a=0,n=this.shapeList.length;n>a;a++)this.shapeList[a]._mapType==this._curMapType&&(this.shapeList[a].position[0]=s.left,this.shapeList[a].position[1]=s.top,this.zr.modShape(this.shapeList[a].id));this.messageCenter.dispatch(p.EVENT.MAP_ROAM,t.event,{type:"move"},this.myChart),this.clearEffectShape(!0),this.zr.refreshNextFrame(),this._justMove=!0,m.stop(e)}},__onmouseup:function(t){var e=t.event;this._mx=m.getX(e),this._my=m.getY(e),this._mousedown=!1;var i=this;setTimeout(function(){i._justMove&&i.animationEffect(),i._justMove=!1,i.zr.un(f.EVENT.MOUSEMOVE,i._onmousemove),i.zr.un(f.EVENT.MOUSEUP,i._onmouseup)},120)},__onroamcontroller:function(t){var e=t.event;e.zrenderX=this.zr.getWidth()/2,e.zrenderY=this.zr.getHeight()/2;var i=t.mapTypeControl,o=0,s=0,a=t.step;switch(t.roamType){case"scaleUp":return e.zrenderDelta=1,void this.__onmousewheel({event:e,mapTypeControl:i});case"scaleDown":return e.zrenderDelta=-1,void this.__onmousewheel({event:e,mapTypeControl:i});case"up":o=-a;break;case"down":o=a;break;case"left":s=-a;break;case"right":s=a}var n,r;for(r in i)this._mapDataMap[r]&&this._activeMapType[r]&&(n=this._mapDataMap[r].transform,n.hasRoam=!0,n.left-=s,n.top-=o,this._mapDataMap[r].transform=n);for(var h=0,l=this.shapeList.length;l>h;h++)r=this.shapeList[h]._mapType,i[r]&&this._activeMapType[r]&&(n=this._mapDataMap[r].transform,this.shapeList[h].position[0]=n.left,this.shapeList[h].position[1]=n.top,this.zr.modShape(this.shapeList[h].id));this.messageCenter.dispatch(p.EVENT.MAP_ROAM,t.event,{type:"move"},this.myChart),this.clearEffectShape(!0),this.zr.refreshNextFrame(),clearTimeout(this.dircetionTimer);var d=this;this.dircetionTimer=setTimeout(function(){d.animationEffect()},150)},__ondrhoverlink:function(t){for(var e,i,o=0,s=this.shapeList.length;s>o;o++)e=this.shapeList[o]._mapType,this._hoverLinkMap[e]&&this._activeMapType[e]&&(i=u.get(this.shapeList[o],"value"),null!=i&&i>=t.valueMin&&i<=t.valueMax&&this.zr.addHoverShape(this.shapeList[o]))},onclick:function(t){if(this.isClick&&t.target&&!this._justMove&&"icon"!=t.target.type){this.isClick=!1;var e=t.target,i=e.style._name,o=this.shapeList.length,s=e._mapType||"";if("single"==this._selectedMode[s])for(var a in this._selected)if(this._selected[a]&&this._mapTypeMap[a]==s){for(var n=0;o>n;n++)this.shapeList[n].style._name==a&&this.shapeList[n]._mapType==s&&(this.shapeList[n].style=this.shapeList[n]._style,this.zr.modShape(this.shapeList[n].id));a!=i&&(this._selected[a]=!1)}this._selected[i]=!this._selected[i];for(var n=0;o>n;n++)this.shapeList[n].style._name==i&&this.shapeList[n]._mapType==s&&(this.shapeList[n].style=this._selected[i]?this.shapeList[n].highlightStyle:this.shapeList[n]._style,this.zr.modShape(this.shapeList[n].id));this.messageCenter.dispatch(p.EVENT.MAP_SELECTED,t.event,{selected:this._selected,target:i},this.myChart),this.zr.refreshNextFrame();var r=this;setTimeout(function(){r.zr.trigger(f.EVENT.MOUSEMOVE,t.event)},100)}},refresh:function(t){t&&(this.option=t,this.series=t.series),this._mapDataRequireCounter>0?this.clear():this.backupShapeList(),this._buildShape(),this.zr.refreshHover()},ondataRange:function(t,e){this.component.dataRange&&(this.refresh(),e.needRefresh=!0)},pos2geo:function(t,e){return this._mapDataMap[t].transform?this._mapDataMap[t].projection.pos2geo(this._mapDataMap[t].transform,e):null},getGeoByPos:function(t,e){if(!this._mapDataMap[t].transform)return null;var i=[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top];return e instanceof Array?(e[0]-=i[0],e[1]-=i[1]):(e.x-=i[0],e.y-=i[1]),this.pos2geo(t,e)},geo2pos:function(t,e){return this._mapDataMap[t].transform?this._mapDataMap[t].projection.geo2pos(this._mapDataMap[t].transform,e):null},getPosByGeo:function(t,e){if(!this._mapDataMap[t].transform)return null;var i=this.geo2pos(t,e);return i[0]+=this._mapDataMap[t].transform.left,i[1]+=this._mapDataMap[t].transform.top,i},getMapPosition:function(t){return this._mapDataMap[t].transform?[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top]:null},onbeforDispose:function(){this._isAlive=!1,this.zr.un(f.EVENT.MOUSEWHEEL,this._onmousewheel),this.zr.un(f.EVENT.MOUSEDOWN,this._onmousedown),this.messageCenter.unbind(p.EVENT.ROAMCONTROLLER,this._onroamcontroller),this.messageCenter.unbind(p.EVENT.DATA_RANGE_HOVERLINK,this._ondrhoverlink)}},g.inherits(e,i),t("../chart").define("map",e),e}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(t){var e=t("./Base"),i=t("./util/PathProxy"),o=i.PathSegment,s=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},a=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(s(t)*s(e))},n=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(a(t,e))},r=function(t){e.call(this,t)};return r.prototype={type:"path",buildPathArray:function(t,e,i){if(!t)return[];e=e||0,i=i||0;var s=t,a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];s=s.replace(/-/g," -"),s=s.replace(/  /g," "),s=s.replace(/ /g,","),s=s.replace(/,,/g,",");var n;for(n=0;n<a.length;n++)s=s.replace(new RegExp(a[n],"g"),"|"+a[n]);var r=s.split("|"),h=[],l=0,d=0;for(n=1;n<r.length;n++){var c=r[n],p=c.charAt(0);c=c.slice(1),c=c.replace(new RegExp("e,-","g"),"e-");var u=c.split(",");u.length>0&&""===u[0]&&u.shift();for(var g=0;g<u.length;g++)u[g]=parseFloat(u[g]);for(;u.length>0&&!isNaN(u[0]);){var f,m,y,_,v,x,b,S,T=null,z=[],C=l,L=d;switch(p){case"l":l+=u.shift(),d+=u.shift(),T="L",z.push(l,d);break;case"L":l=u.shift(),d=u.shift(),z.push(l,d);break;case"m":l+=u.shift(),d+=u.shift(),T="M",z.push(l,d),p="l";break;case"M":l=u.shift(),d=u.shift(),T="M",z.push(l,d),p="L";break;case"h":l+=u.shift(),T="L",z.push(l,d);break;case"H":l=u.shift(),T="L",z.push(l,d);break;case"v":d+=u.shift(),T="L",z.push(l,d);break;case"V":d=u.shift(),T="L",z.push(l,d);break;case"C":z.push(u.shift(),u.shift(),u.shift(),u.shift()),l=u.shift(),d=u.shift(),z.push(l,d);break;case"c":z.push(l+u.shift(),d+u.shift(),l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="C",z.push(l,d);break;case"S":f=l,m=d,y=h[h.length-1],"C"===y.command&&(f=l+(l-y.points[2]),m=d+(d-y.points[3])),z.push(f,m,u.shift(),u.shift()),l=u.shift(),d=u.shift(),T="C",z.push(l,d);break;case"s":f=l,m=d,y=h[h.length-1],"C"===y.command&&(f=l+(l-y.points[2]),m=d+(d-y.points[3])),z.push(f,m,l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="C",z.push(l,d);break;case"Q":z.push(u.shift(),u.shift()),l=u.shift(),d=u.shift(),z.push(l,d);break;case"q":z.push(l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="Q",z.push(l,d);break;case"T":f=l,m=d,y=h[h.length-1],"Q"===y.command&&(f=l+(l-y.points[0]),m=d+(d-y.points[1])),l=u.shift(),d=u.shift(),T="Q",z.push(f,m,l,d);break;case"t":f=l,m=d,y=h[h.length-1],"Q"===y.command&&(f=l+(l-y.points[0]),m=d+(d-y.points[1])),l+=u.shift(),d+=u.shift(),T="Q",z.push(f,m,l,d);break;case"A":_=u.shift(),v=u.shift(),x=u.shift(),b=u.shift(),S=u.shift(),C=l,L=d,l=u.shift(),d=u.shift(),T="A",z=this._convertPoint(C,L,l,d,b,S,_,v,x);break;case"a":_=u.shift(),v=u.shift(),x=u.shift(),b=u.shift(),S=u.shift(),C=l,L=d,l+=u.shift(),d+=u.shift(),T="A",z=this._convertPoint(C,L,l,d,b,S,_,v,x)}for(var M=0,w=z.length;w>M;M+=2)z[M]+=e,z[M+1]+=i;h.push(new o(T||p,z))}("z"===p||"Z"===p)&&h.push(new o("z",[]))}return h},_convertPoint:function(t,e,i,o,s,r,h,l,d){var c=d*(Math.PI/180),p=Math.cos(c)*(t-i)/2+Math.sin(c)*(e-o)/2,u=-1*Math.sin(c)*(t-i)/2+Math.cos(c)*(e-o)/2,g=p*p/(h*h)+u*u/(l*l);g>1&&(h*=Math.sqrt(g),l*=Math.sqrt(g));var f=Math.sqrt((h*h*l*l-h*h*u*u-l*l*p*p)/(h*h*u*u+l*l*p*p));s===r&&(f*=-1),isNaN(f)&&(f=0);var m=f*h*u/l,y=f*-l*p/h,_=(t+i)/2+Math.cos(c)*m-Math.sin(c)*y,v=(e+o)/2+Math.sin(c)*m+Math.cos(c)*y,x=n([1,0],[(p-m)/h,(u-y)/l]),b=[(p-m)/h,(u-y)/l],S=[(-1*p-m)/h,(-1*u-y)/l],T=n(b,S);return a(b,S)<=-1&&(T=Math.PI),a(b,S)>=1&&(T=0),0===r&&T>0&&(T-=2*Math.PI),1===r&&0>T&&(T+=2*Math.PI),[_,v,h,l,x,T,c,r]},buildPath:function(t,e){var i=e.path,o=e.x||0,s=e.y||0;e.pathArray=e.pathArray||this.buildPathArray(i,o,s);for(var a=e.pathArray,n=e.pointList=[],r=[],h=0,l=a.length;l>h;h++){"M"==a[h].command.toUpperCase()&&(r.length>0&&n.push(r),r=[]);for(var d=a[h].points,c=0,p=d.length;p>c;c+=2)r.push([d[c],d[c+1]])}r.length>0&&n.push(r);for(var h=0,l=a.length;l>h;h++){var u=a[h].command,d=a[h].points;switch(u){case"L":t.lineTo(d[0],d[1]);break;case"M":t.moveTo(d[0],d[1]);break;case"C":t.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5]);break;case"Q":t.quadraticCurveTo(d[0],d[1],d[2],d[3]);break;case"A":var g=d[0],f=d[1],m=d[2],y=d[3],_=d[4],v=d[5],x=d[6],b=d[7],S=m>y?m:y,T=m>y?1:m/y,z=m>y?y/m:1;t.translate(g,f),t.rotate(x),t.scale(T,z),t.arc(0,0,S,_,_+v,1-b),t.scale(1/T,1/z),t.rotate(-x),t.translate(-g,-f);break;case"z":t.closePath()}}},getRect:function(t){if(t.__rect)return t.__rect;var e;e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0;for(var i=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MAX_VALUE,a=Number.MIN_VALUE,n=t.x||0,r=t.y||0,h=t.pathArray||this.buildPathArray(t.path),l=0;l<h.length;l++)for(var d=h[l].points,c=0;c<d.length;c++)c%2===0?(d[c]+n<i&&(i=d[c]),d[c]+n>o&&(o=d[c])):(d[c]+r<s&&(s=d[c]),d[c]+r>a&&(a=d[c]));var p;return p=i===Number.MAX_VALUE||o===Number.MIN_VALUE||s===Number.MAX_VALUE||a===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(i-e/2),y:Math.round(s-e/2),width:o-i+e,height:a-s+e},t.__rect=p,p}},t("../tool/util").inherits(r,e),r}),define("zrender/shape/Ellipse",["require","./Base","../tool/util"],function(t){var e=t("./Base"),i=function(t){e.call(this,t)};return i.prototype={type:"ellipse",buildPath:function(t,e){var i=.5522848,o=e.x,s=e.y,a=e.a,n=e.b,r=a*i,h=n*i;t.moveTo(o-a,s),t.bezierCurveTo(o-a,s-h,o-r,s-n,o,s-n),t.bezierCurveTo(o+r,s-n,o+a,s-h,o+a,s),t.bezierCurveTo(o+a,s+h,o+r,s+n,o,s+n),t.bezierCurveTo(o-r,s+n,o-a,s+h,o-a,s),t.closePath()},getRect:function(t){if(t.__rect)return t.__rect;var e;return e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0,t.__rect={x:Math.round(t.x-t.a-e/2),y:Math.round(t.y-t.b-e/2),width:2*t.a+e,height:2*t.b+e},t.__rect}},t("../tool/util").inherits(i,e),i}),define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(t){function e(t,e,o,s,a){i.call(this,t,e,o,s,a);var r=this;r._ondrift=function(t,e){return r.__ondrift(this,t,e)},r._ondragend=function(){return r.__ondragend()},r._dataRangeSelected=function(t){return r.__dataRangeSelected(t)},r._dispatchHoverLink=function(t){return r.__dispatchHoverLink(t)},r._onhoverlink=function(t){return r.__onhoverlink(t)},this._selectedMap={},this._range={},this.refresh(s),e.bind(n.EVENT.HOVER,this._onhoverlink)}var i=t("./base"),o=t("zrender/shape/Text"),s=t("zrender/shape/Rectangle"),a=t("../util/shape/HandlePolygon"),n=t("../config");n.dataRange={zlevel:0,z:4,show:!0,orient:"vertical",x:"left",y:"bottom",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:20,itemHeight:14,precision:0,splitNumber:5,splitList:null,calculable:!1,selectedMode:!0,hoverLink:!0,realtime:!0,color:["#006edd","#e0ffff"],textStyle:{color:"#333"}};var r=t("zrender/tool/util"),h=t("zrender/tool/event"),l=t("zrender/tool/area"),d=t("zrender/tool/color");return e.prototype={type:n.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this._isContinuity()?this._buildGradient():this._buildItem(),this.dataRangeOption.show)for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t]);this._syncShapeFromRange()},_buildItem:function(){var t,e,i,a,n=this._valueTextList,r=n.length,h=this.getFont(this.dataRangeOption.textStyle),d=this._itemGroupLocation.x,c=this._itemGroupLocation.y,p=this.dataRangeOption.itemWidth,u=this.dataRangeOption.itemHeight,g=this.dataRangeOption.itemGap,f=l.getTextHeight("国",h);"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(d=this._itemGroupLocation.x+this._itemGroupLocation.width-p);var m=!0;this.dataRangeOption.text&&(m=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(d,c,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?d+=l.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap:(c+=f+this._textGap,i.style.y+=f/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new o(i))));for(var y=0;r>y;y++)t=n[y],a=this.getColorByIndex(y),e=this._getItemShape(d,c,p,u,this._selectedMap[y]?a:"#ccc"),e._idx=y,e.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(e.clickable=!0,e.onclick=this._dataRangeSelected),this.shapeList.push(new s(e)),m&&(i={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d+p+5,y:c,color:this._selectedMap[y]?this.dataRangeOption.textStyle.color:"#ccc",text:n[y],textFont:h,textBaseline:"top"},highlightStyle:{brushType:"fill"}},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(i.style.x-=p+10,i.style.textAlign="right"),i._idx=y,i.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(i.clickable=!0,i.onclick=this._dataRangeSelected),this.shapeList.push(new o(i))),"horizontal"==this.dataRangeOption.orient?d+=p+(m?5:0)+(m?l.getTextWidth(t,h):0)+g:c+=u+g;!m&&this.dataRangeOption.text[1]&&("horizontal"==this.dataRangeOption.orient?d=d-g+this._textGap:c=c-g+this._textGap,i=this._getTextShape(d,c,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient&&(i.style.y-=5,i.style.textBaseline="top"),this.shapeList.push(new o(i)))},_buildGradient:function(){var e,i,a=this.getFont(this.dataRangeOption.textStyle),n=this._itemGroupLocation.x,r=this._itemGroupLocation.y,h=this.dataRangeOption.itemWidth,d=this.dataRangeOption.itemHeight,c=l.getTextHeight("国",a),p=10,u=!0;this.dataRangeOption.text&&(u=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(n,r,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?n+=l.getTextWidth(this.dataRangeOption.text[0],a)+this._textGap:(r+=c+this._textGap,i.style.y+=c/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new o(i))));for(var g=t("zrender/tool/color"),f=1/(this.dataRangeOption.color.length-1),m=[],y=0,_=this.dataRangeOption.color.length;_>y;y++)m.push([y*f,this.dataRangeOption.color[y]]);"horizontal"==this.dataRangeOption.orient?(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:n,y:r,width:h*p,height:d,color:g.getLinearGradient(n,r,n+h*p,r,m)},hoverable:!1},n+=h*p+this._textGap):(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:n,y:r,width:h,height:d*p,color:g.getLinearGradient(n,r,n,r+d*p,m)},hoverable:!1},r+=d*p+this._textGap),this.shapeList.push(new s(e)),this._calculableLocation=e.style,this.dataRangeOption.calculable&&(this._buildFiller(),this._bulidMask(),this._bulidHandle()),this._buildIndicator(),!u&&this.dataRangeOption.text[1]&&(i=this._getTextShape(n,r,this.dataRangeOption.text[1]),this.shapeList.push(new o(i)))
},_buildIndicator:function(){var t,e,i=this._calculableLocation.x,o=this._calculableLocation.y,s=this._calculableLocation.width,n=this._calculableLocation.height,r=5;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[i,o+n],[i-r,o+n+r],[i+r,o+n+r]],e="bottom"):(t=[[i,o],[i-r,o-r],[i+r,o-r]],e="top"):"right"!=this.dataRangeOption.x?(t=[[i+s,o],[i+s+r,o-r],[i+s+r,o+r]],e="right"):(t=[[i,o],[i-r,o-r],[i-r,o+r]],e="left"),this._indicatorShape={style:{pointList:t,color:"#fff",__rect:{x:Math.min(t[0][0],t[1][0]),y:Math.min(t[0][1],t[1][1]),width:r*("horizontal"==this.dataRangeOption.orient?2:1),height:r*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:e,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new a(this._indicatorShape)},_buildFiller:function(){this._fillerShape={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new s(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var t,e,i,o,s,n,r,h,d=this._calculableLocation.x,c=this._calculableLocation.y,p=this._calculableLocation.width,u=this._calculableLocation.height,g=this.getFont(this.dataRangeOption.textStyle),f=l.getTextHeight("国",g),m=Math.max(l.getTextWidth(this._textFormat(this.dataRangeOption.max),g),l.getTextWidth(this._textFormat(this.dataRangeOption.min),g))+2;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[d,c],[d,c+u+f],[d-f,c+u+f],[d-1,c+u],[d-1,c]],e=d-m/2-f,i=c+u+f/2+2,o={x:d-m-f,y:c+u,width:m+f,height:f},s=[[d+p,c],[d+p,c+u+f],[d+p+f,c+u+f],[d+p+1,c+u],[d+p+1,c]],n=d+p+m/2+f,r=i,h={x:d+p,y:c+u,width:m+f,height:f}):(t=[[d,c+u],[d,c-f],[d-f,c-f],[d-1,c],[d-1,c+u]],e=d-m/2-f,i=c-f/2-2,o={x:d-m-f,y:c-f,width:m+f,height:f},s=[[d+p,c+u],[d+p,c-f],[d+p+f,c-f],[d+p+1,c],[d+p+1,c+u]],n=d+p+m/2+f,r=i,h={x:d+p,y:c-f,width:m+f,height:f}):(m+=f,"right"!=this.dataRangeOption.x?(t=[[d,c],[d+p+f,c],[d+p+f,c-f],[d+p,c-1],[d,c-1]],e=d+p+m/2+f/2,i=c-f/2,o={x:d+p,y:c-f,width:m+f,height:f},s=[[d,c+u],[d+p+f,c+u],[d+p+f,c+f+u],[d+p,c+1+u],[d,c+u+1]],n=e,r=c+u+f/2,h={x:d+p,y:c+u,width:m+f,height:f}):(t=[[d+p,c],[d-f,c],[d-f,c-f],[d,c-1],[d+p,c-1]],e=d-m/2-f/2,i=c-f/2,o={x:d-m-f,y:c-f,width:m+f,height:f},s=[[d+p,c+u],[d-f,c+u],[d-f,c+f+u],[d,c+1+u],[d+p,c+u+1]],n=e,r=c+u+f/2,h={x:d-m-f,y:c+u,width:m+f,height:f})),this._startShape={style:{pointList:t,text:this._textFormat(this.dataRangeOption.max),textX:e,textY:i,textFont:g,color:this.getColor(this.dataRangeOption.max),rect:o,x:t[0][0],y:t[0][1],_x:t[0][0],_y:t[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:s,text:this._textFormat(this.dataRangeOption.min),textX:n,textY:r,textFont:g,color:this.getColor(this.dataRangeOption.min),rect:h,x:s[0][0],y:s[0][1],_x:s[0][0],_y:s[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this.getZlevelBase(),this._startShape.z=this._endShape.z=this.getZBase()+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new a(this._startShape),this._endShape=new a(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,o=this._calculableLocation.height;this._startMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:t,y:e,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?o:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:"horizontal"==this.dataRangeOption.orient?t+i:t,y:"horizontal"==this.dataRangeOption.orient?e:e+o,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?o:0,color:"#ccc"},hoverable:!1},this._startMask=new s(this._startMask),this._endMask=new s(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var t=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new s({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var t=this._valueTextList,e=t.length,i=this.dataRangeOption.itemGap,o=this.dataRangeOption.itemWidth,s=this.dataRangeOption.itemHeight,a=0,n=0,r=this.getFont(this.dataRangeOption.textStyle),h=l.getTextHeight("国",r),d=10;if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this._isContinuity())a=(this._isContinuity()?o*d+i:e*(o+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?l.getTextWidth(this.dataRangeOption.text[0],r)+this._textGap:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?l.getTextWidth(this.dataRangeOption.text[1],r)+this._textGap:0);else{o+=5;for(var c=0;e>c;c++)a+=o+l.getTextWidth(t[c],r)+i}a-=i,n=Math.max(h,s)}else{var p;if(this.dataRangeOption.text||this._isContinuity())n=(this._isContinuity()?s*d+i:e*(s+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?this._textGap+h:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?this._textGap+h:0),p=Math.max(l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",r),l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",r)),a=Math.max(o,p);else{n=(s+i)*e,o+=5,p=0;for(var c=0;e>c;c++)p=Math.max(p,l.getTextWidth(t[c],r));a=o+p}n-=i}var u,g=this.reformCssArray(this.dataRangeOption.padding),f=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":u=Math.floor((f-a)/2);break;case"left":u=g[3]+this.dataRangeOption.borderWidth;break;case"right":u=f-a-g[1]-this.dataRangeOption.borderWidth;break;default:u=this.parsePercent(this.dataRangeOption.x,f),u=isNaN(u)?0:u}var m,y=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":m=g[0]+this.dataRangeOption.borderWidth;break;case"bottom":m=y-n-g[2]-this.dataRangeOption.borderWidth;break;case"center":m=Math.floor((y-n)/2);break;default:m=this.parsePercent(this.dataRangeOption.y,y),m=isNaN(m)?0:m}if(this.dataRangeOption.calculable){var _=Math.max(l.getTextWidth(this.dataRangeOption.max,r),l.getTextWidth(this.dataRangeOption.min,r))+h;"horizontal"==this.dataRangeOption.orient?(_>u&&(u=_),u+a+_>f&&(u-=_)):(h>m&&(m=h),m+n+h>y&&(m-=h))}return{x:u,y:m,width:a,height:n}},_getTextShape:function(t,e,i){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:"horizontal"==this.dataRangeOption.orient?t:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:e,color:this.dataRangeOption.textStyle.color,text:i,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(t,e,i,o,s){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:t,y:e+1,width:i,height:o-2,color:s},highlightStyle:{strokeColor:s,lineWidth:1}}},__ondrift:function(t,e,i){var o=this._calculableLocation.x,s=this._calculableLocation.y,a=this._calculableLocation.width,n=this._calculableLocation.height;return"horizontal"==this.dataRangeOption.orient?t.style.x+e<=o?t.style.x=o:t.style.x+e+t.style.width>=o+a?t.style.x=o+a-t.style.width:t.style.x+=e:t.style.y+i<=s?t.style.y=s:t.style.y+i+t.style.height>=s+n?t.style.y=s+n-t.style.height:t.style.y+=i,"filler"==t._type?this._syncHandleShape():this._syncFillerShape(t),this.dataRangeOption.realtime&&this._dispatchDataRange(),!0},__ondragend:function(){this.isDragend=!0},ondragend:function(t,e){this.isDragend&&t.target&&(e.dragOut=!0,e.dragIn=!0,this.dataRangeOption.realtime||this._dispatchDataRange(),e.needRefresh=!1,this.isDragend=!1)},_syncShapeFromRange:function(){var t=this.dataRangeOption.range||{},e=t.start,i=t.end;if(e>i&&(e=[i,i=e][0]),this._range.end=null!=e?e:null!=this._range.end?this._range.end:0,this._range.start=null!=i?i:null!=this._range.start?this._range.start:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var o=this._fillerShape.style.width;this._fillerShape.style.x+=o*(100-this._range.start)/100,this._fillerShape.style.width=o*(this._range.start-this._range.end)/100}else{var s=this._fillerShape.style.height;this._fillerShape.style.y+=s*(100-this._range.start)/100,this._fillerShape.style.height=s*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,o=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-t,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=t+i-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-t)/i*100),this._range.end=Math.floor(100-(this._endShape.style.x-t)/i*100)):(this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-e,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=e+o-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-e)/o*100),this._range.end=Math.floor(100-(this._endShape.style.y-e)/o*100)),this._syncShape()},_syncFillerShape:function(t){var e,i,o=this._calculableLocation.x,s=this._calculableLocation.y,a=this._calculableLocation.width,n=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(e=this._startShape.style.x,i=this._endShape.style.x,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.x=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.x=e),this._fillerShape.style.x=e,this._fillerShape.style.width=i-e,this._startMask.style.width=e-o,this._endMask.style.x=i,this._endMask.style.width=o+a-i,this._range.start=Math.ceil(100-(e-o)/a*100),this._range.end=Math.floor(100-(i-o)/a*100)):(e=this._startShape.style.y,i=this._endShape.style.y,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.y=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.y=e),this._fillerShape.style.y=e,this._fillerShape.style.height=i-e,this._startMask.style.height=e-s,this._endMask.style.y=i,this._endMask.style.height=s+n-i,this._range.start=Math.ceil(100-(e-s)/n*100),this._range.end=Math.floor(100-(i-s)/n*100)),this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refreshNextFrame()},_dispatchDataRange:function(){this.messageCenter.dispatch(n.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(t){if("single"===this.dataRangeOption.selectedMode)for(var e in this._selectedMap)this._selectedMap[e]=!1;var i=t.target._idx;this._selectedMap[i]=!this._selectedMap[i];var o,s;this._useCustomizedSplit()?(o=this._splitList[i].max,s=this._splitList[i].min):(o=(this._colorList.length-i)*this._gap+this.dataRangeOption.min,s=o-this._gap),this.messageCenter.dispatch(n.EVENT.DATA_RANGE_SELECTED,t.event,{selected:this._selectedMap,target:i,valueMax:o,valueMin:s},this.myChart),this.messageCenter.dispatch(n.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(t){var e,i;if(this.dataRangeOption.calculable){var o,s=this.dataRangeOption.max-this.dataRangeOption.min;o="horizontal"==this.dataRangeOption.orient?(1-(h.getX(t.event)-this._calculableLocation.x)/this._calculableLocation.width)*s:(1-(h.getY(t.event)-this._calculableLocation.y)/this._calculableLocation.height)*s,e=o-.05*s,i=o+.05*s}else if(this._useCustomizedSplit()){var a=t.target._idx;i=this._splitList[a].max,e=this._splitList[a].min}else{var a=t.target._idx;i=(this._colorList.length-a)*this._gap+this.dataRangeOption.min,e=i-this._gap}this.messageCenter.dispatch(n.EVENT.DATA_RANGE_HOVERLINK,t.event,{valueMin:e,valueMax:i},this.myChart)},__onhoverlink:function(t){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&t&&null!=t.seriesIndex&&null!=t.dataIndex){var e=t.value;if(""===e||isNaN(e))return;e<this.dataRangeOption.min?e=this.dataRangeOption.min:e>this.dataRangeOption.max&&(e=this.dataRangeOption.max),this._indicatorShape.position="horizontal"==this.dataRangeOption.orient?[(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0]:[0,(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height],this._indicatorShape.style.text=this._textFormat(t.value),this._indicatorShape.style.color=this.getColor(e),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(t,e){var i=this.dataRangeOption;if(t!==-Number.MAX_VALUE&&(t=(+t).toFixed(i.precision)),null!=e&&e!==Number.MAX_VALUE&&(e=(+e).toFixed(i.precision)),i.formatter){if("string"==typeof i.formatter)return i.formatter.replace("{value}",t===-Number.MAX_VALUE?"min":t).replace("{value2}",e===Number.MAX_VALUE?"max":e);if("function"==typeof i.formatter)return i.formatter.call(this.myChart,t,e)}return null==e?t:t===-Number.MAX_VALUE?"< "+e:e===Number.MAX_VALUE?"> "+t:t+" - "+e},_isContinuity:function(){var t=this.dataRangeOption;return!(t.splitList?t.splitList.length>0:t.splitNumber>0)||t.calculable},_useCustomizedSplit:function(){var t=this.dataRangeOption;return t.splitList&&t.splitList.length>0},_buildColorList:function(t){if(this._colorList=d.getGradientColors(this.dataRangeOption.color,Math.max((t-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>t){for(var e=this._colorList.length,i=[this._colorList[0]],o=e/(t-1),s=1;t-1>s;s++)i.push(this._colorList[Math.floor(s*o)]);i.push(this._colorList[e-1]),this._colorList=i}if(this._useCustomizedSplit())for(var a=this._splitList,s=0,e=a.length;e>s;s++)a[s].color&&(this._colorList[s]=a[s].color)},_buildGap:function(t){if(!this._useCustomizedSplit()){var e=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/t;this._gap.toFixed(e)-0!=this._gap&&5>e;)e++;this.dataRangeOption.precision=e,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/t).toFixed(e)-0}},_buildDataList:function(t){for(var e=this._valueTextList=[],i=this.dataRangeOption,o=this._useCustomizedSplit(),s=0;t>s;s++){this._selectedMap[s]=!0;var a="";if(o){var n=this._splitList[t-1-s];a=null!=n.label?n.label:null!=n.single?this._textFormat(n.single):this._textFormat(n.min,n.max)}else a=this._textFormat(s*this._gap+i.min,(s+1)*this._gap+i.min);e.unshift(a)}},_buildSplitList:function(){if(this._useCustomizedSplit())for(var t=this.dataRangeOption.splitList,e=this._splitList=[],i=0,o=t.length;o>i;i++){var s=t[i];if(!s||null==s.start&&null==s.end)throw new Error("Empty item exists in splitList!");var a={label:s.label,color:s.color};a.min=s.start,a.max=s.end,a.min>a.max&&(a.min=[a.max,a.max=a.min][0]),a.min===a.max&&(a.single=a.max),null==a.min&&(a.min=-Number.MAX_VALUE),null==a.max&&(a.max=Number.MAX_VALUE),e.push(a)}},refresh:function(t){if(t){this.option=t,this.option.dataRange=this.reformOption(this.option.dataRange);var e=this.dataRangeOption=this.option.dataRange;if(!this._useCustomizedSplit()&&(null==e.min||null==e.max))throw new Error("option.dataRange.min or option.dataRange.max has not been defined.");this.myChart.canvasSupported||(e.realtime=!1);var i=this._isContinuity()?100:this._useCustomizedSplit()?e.splitList.length:e.splitNumber;this._buildSplitList(),this._buildColorList(i),this._buildGap(i),this._buildDataList(i)}this.clear(),this._buildShape()},getColor:function(t){if(isNaN(t))return null;var e;if(this._useCustomizedSplit()){for(var i=this._splitList,o=0,s=i.length;s>o;o++)if(i[o].min<=t&&i[o].max>=t){e=o;break}}else{if(this.dataRangeOption.min==this.dataRangeOption.max)return this._colorList[0];if(t<this.dataRangeOption.min?t=this.dataRangeOption.min:t>this.dataRangeOption.max&&(t=this.dataRangeOption.max),this.dataRangeOption.calculable&&(t-(this._gap*this._range.start+this.dataRangeOption.min)>5e-5||t-(this._gap*this._range.end+this.dataRangeOption.min)<-5e-5))return null;e=this._colorList.length-Math.ceil((t-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length),e==this._colorList.length&&e--}return this._selectedMap[e]?this._colorList[e]:null},getColorByIndex:function(t){return t>=this._colorList.length?t=this._colorList.length-1:0>t&&(t=0),this._colorList[t]},onbeforDispose:function(){this.messageCenter.unbind(n.EVENT.HOVER,this._onhoverlink)}},r.inherits(e,i),t("../component").define("dataRange",e),e}),define("echarts/component/roamController",["require","./base","zrender/shape/Rectangle","zrender/shape/Sector","zrender/shape/Circle","../config","zrender/tool/util","zrender/tool/color","zrender/tool/event","../component"],function(t){function e(t,e,o,s,a){if(this.rcOption={},s.roamController&&s.roamController.show){if(!s.roamController.mapTypeControl)return void console.error("option.roamController.mapTypeControl has not been defined.");i.call(this,t,e,o,s,a),this.rcOption=s.roamController;var n=this;this._drictionMouseDown=function(t){return n.__drictionMouseDown(t)},this._drictionMouseUp=function(t){return n.__drictionMouseUp(t)},this._drictionMouseMove=function(t){return n.__drictionMouseMove(t)},this._drictionMouseOut=function(t){return n.__drictionMouseOut(t)},this._scaleHandler=function(t){return n.__scaleHandler(t)},this.refresh(s)}}var i=t("./base"),o=t("zrender/shape/Rectangle"),s=t("zrender/shape/Sector"),a=t("zrender/shape/Circle"),n=t("../config");n.roamController={zlevel:0,z:4,show:!0,x:"left",y:"top",width:80,height:120,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,handleColor:"#6495ed",fillerColor:"#fff",step:15,mapTypeControl:null};var r=t("zrender/tool/util"),h=t("zrender/tool/color"),l=t("zrender/tool/event");return e.prototype={type:n.COMPONENT_TYPE_ROAMCONTROLLER,_buildShape:function(){if(this.rcOption.show){this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this._buildItem();for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t])}},_buildItem:function(){this.shapeList.push(this._getDirectionShape("up")),this.shapeList.push(this._getDirectionShape("down")),this.shapeList.push(this._getDirectionShape("left")),this.shapeList.push(this._getDirectionShape("right")),this.shapeList.push(this._getScaleShape("scaleUp")),this.shapeList.push(this._getScaleShape("scaleDown"))},_getDirectionShape:function(t){var e=this._itemGroupLocation.r,i=this._itemGroupLocation.x+e,o=this._itemGroupLocation.y+e,a={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:i,y:o,r:e,startAngle:-45,endAngle:45,color:this.rcOption.handleColor,text:">",textX:i+e/2+4,textY:o-.5,textAlign:"center",textBaseline:"middle",textPosition:"specific",textColor:this.rcOption.fillerColor,textFont:Math.floor(e/2)+"px arial"},highlightStyle:{color:h.lift(this.rcOption.handleColor,-.2),brushType:"fill"},clickable:!0};switch(t){case"up":a.rotation=[Math.PI/2,i,o];break;case"left":a.rotation=[Math.PI,i,o];break;case"down":a.rotation=[-Math.PI/2,i,o]}return a=new s(a),a._roamType=t,a.onmousedown=this._drictionMouseDown,a.onmouseup=this._drictionMouseUp,a.onmousemove=this._drictionMouseMove,a.onmouseout=this._drictionMouseOut,a},_getScaleShape:function(t){var e=this._itemGroupLocation.width,i=this._itemGroupLocation.height-e;i=0>i?20:i;var o=Math.min(e/2-5,i)/2,s=this._itemGroupLocation.x+("scaleDown"===t?e-o:o),n=this._itemGroupLocation.y+this._itemGroupLocation.height-o,r={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:s,y:n,r:o,color:this.rcOption.handleColor,text:"scaleDown"===t?"-":"+",textX:s,textY:n-2,textAlign:"center",textBaseline:"middle",textPosition:"specific",textColor:this.rcOption.fillerColor,textFont:Math.floor(o)+"px verdana"},highlightStyle:{color:h.lift(this.rcOption.handleColor,-.2),brushType:"fill"},clickable:!0};return r=new a(r),r._roamType=t,r.onmousedown=this._scaleHandler,r},_buildBackground:function(){var t=this.reformCssArray(this.rcOption.padding);this.shapeList.push(new o({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.rcOption.borderWidth?"fill":"both",color:this.rcOption.backgroundColor,strokeColor:this.rcOption.borderColor,lineWidth:this.rcOption.borderWidth}}))},_getItemGroupLocation:function(){var t,e=this.reformCssArray(this.rcOption.padding),i=this.rcOption.width,o=this.rcOption.height,s=this.zr.getWidth(),a=this.zr.getHeight();switch(this.rcOption.x){case"center":t=Math.floor((s-i)/2);break;case"left":t=e[3]+this.rcOption.borderWidth;break;case"right":t=s-i-e[1]-e[3]-2*this.rcOption.borderWidth;break;default:t=this.parsePercent(this.rcOption.x,s)}var n;switch(this.rcOption.y){case"top":n=e[0]+this.rcOption.borderWidth;break;case"bottom":n=a-o-e[0]-e[2]-2*this.rcOption.borderWidth;break;case"center":n=Math.floor((a-o)/2);break;default:n=this.parsePercent(this.rcOption.y,a)}return{x:t,y:n,r:i/2,width:i,height:o}},__drictionMouseDown:function(t){this.mousedown=!0,this._drictionHandlerOn(t)},__drictionMouseUp:function(t){this.mousedown=!1,this._drictionHandlerOff(t)},__drictionMouseMove:function(t){this.mousedown&&this._drictionHandlerOn(t)},__drictionMouseOut:function(t){this._drictionHandlerOff(t)},_drictionHandlerOn:function(t){this._dispatchEvent(t.event,t.target._roamType),clearInterval(this.dircetionTimer);var e=this;this.dircetionTimer=setInterval(function(){e._dispatchEvent(t.event,t.target._roamType)},100),l.stop(t.event)},_drictionHandlerOff:function(){clearInterval(this.dircetionTimer)},__scaleHandler:function(t){this._dispatchEvent(t.event,t.target._roamType),l.stop(t.event)},_dispatchEvent:function(t,e){this.messageCenter.dispatch(n.EVENT.ROAMCONTROLLER,t,{roamType:e,mapTypeControl:this.rcOption.mapTypeControl,step:this.rcOption.step},this.myChart)},refresh:function(t){t&&(this.option=t||this.option,this.option.roamController=this.reformOption(this.option.roamController),this.rcOption=this.option.roamController),this.clear(),this._buildShape()}},r.inherits(e,i),t("../component").define("roamController",e),e}),define("echarts/layer/heatmap",["require"],function(){function t(t){if(this.option=t,t)for(var i in e)this.option[i]=void 0!==t[i]?t[i]:e[i];else this.option=e}var e={blurSize:30,gradientColors:["blue","cyan","lime","yellow","red"],minAlpha:.05,valueScale:1,opacity:1},i=20,o=256;return t.prototype={getCanvas:function(t,e,s){var a=this._getBrush(),n=this._getGradient(),r=i+this.option.blurSize,h=document.createElement("canvas");h.width=e,h.height=s;for(var l=h.getContext("2d"),d=t.length,c=0;d>c;++c){var p=t[c],u=p[0],g=p[1],f=p[2],m=Math.min(1,Math.max(f*this.option.valueScale||this.option.minAlpha,this.option.minAlpha));l.globalAlpha=m,l.drawImage(a,u-r,g-r)}for(var y=l.getImageData(0,0,h.width,h.height),_=y.data,d=_.length/4;d--;){var v=4*d+3,m=_[v]/256,x=Math.floor(m*(o-1));_[v-3]=n[4*x],_[v-2]=n[4*x+1],_[v-1]=n[4*x+2],_[v]*=this.option.opacity}return l.putImageData(y,0,0),h},_getBrush:function(){if(!this._brushCanvas){this._brushCanvas=document.createElement("canvas");var t=i+this.option.blurSize,e=2*t;this._brushCanvas.width=e,this._brushCanvas.height=e;var o=this._brushCanvas.getContext("2d");o.shadowOffsetX=e,o.shadowBlur=this.option.blurSize,o.shadowColor="black",o.beginPath(),o.arc(-t,t,i,0,2*Math.PI,!0),o.closePath(),o.fill()}return this._brushCanvas},_getGradient:function(){if(!this._gradientPixels){var t=o,e=document.createElement("canvas");e.width=1,e.height=t;for(var i=e.getContext("2d"),s=i.createLinearGradient(0,0,0,t),a=this.option.gradientColors.length,n=0;a>n;++n)"string"==typeof this.option.gradientColors[n]?s.addColorStop((n+1)/a,this.option.gradientColors[n]):s.addColorStop(this.option.gradientColors[n].offset,this.option.gradientColors[n].color);i.fillStyle=s,i.fillRect(0,0,1,t),this._gradientPixels=i.getImageData(0,0,1,t).data}return this._gradientPixels}},t}),define("echarts/util/mapData/params",["require"],function(t){function e(t){if(!t.UTF8Encoding)return t;for(var e=t.features,o=0;o<e.length;o++)for(var s=e[o],a=s.geometry.coordinates,n=s.geometry.encodeOffsets,r=0;r<a.length;r++){var h=a[r];if("Polygon"===s.geometry.type)a[r]=i(h,n[r]);else if("MultiPolygon"===s.geometry.type)for(var l=0;l<h.length;l++){var d=h[l];h[l]=i(d,n[r][l])}}return t.UTF8Encoding=!1,t}function i(t,e){for(var i=[],o=e[0],s=e[1],a=0;a<t.length;a+=2){var n=t.charCodeAt(a)-64,r=t.charCodeAt(a+1)-64;n=n>>1^-(1&n),r=r>>1^-(1&r),n+=o,r+=s,o=n,s=r,i.push([n/1024,r/1024])}return i}var o={none:{getGeoJson:function(t){t({type:"FeatureCollection",features:[{type:"Feature",geometry:{coordinates:[],encodeOffsets:[],type:"Polygon"},properties:{}}]})}},world:{getGeoJson:function(i){t(["./geoJson/world_geo"],function(t){i(e(t))})}},china:{getGeoJson:function(i){t(["./geoJson/china_geo"],function(t){i(e(t))})}},"南海诸岛":{textCoord:[126,25],getPath:function(t,e){for(var i=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],o="",s=t[0],a=t[1],n=0,r=i.length;r>n;n++){o+="M "+((i[n][0][0]*e+s).toFixed(2)-0)+" "+((i[n][0][1]*e+a).toFixed(2)-0)+" ";for(var h=1,l=i[n].length;l>h;h++)o+="L "+((i[n][h][0]*e+s).toFixed(2)-0)+" "+((i[n][h][1]*e+a).toFixed(2)-0)+" "}return o+" Z"}},"新疆":{getGeoJson:function(i){t(["./geoJson/xin_jiang_geo"],function(t){i(e(t))})}},"西藏":{getGeoJson:function(i){t(["./geoJson/xi_zang_geo"],function(t){i(e(t))})}},"内蒙古":{getGeoJson:function(i){t(["./geoJson/nei_meng_gu_geo"],function(t){i(e(t))})}},"青海":{getGeoJson:function(i){t(["./geoJson/qing_hai_geo"],function(t){i(e(t))})}},"四川":{getGeoJson:function(i){t(["./geoJson/si_chuan_geo"],function(t){i(e(t))})}},"黑龙江":{getGeoJson:function(i){t(["./geoJson/hei_long_jiang_geo"],function(t){i(e(t))})}},"甘肃":{getGeoJson:function(i){t(["./geoJson/gan_su_geo"],function(t){i(e(t))})}},"云南":{getGeoJson:function(i){t(["./geoJson/yun_nan_geo"],function(t){i(e(t))})}},"广西":{getGeoJson:function(i){t(["./geoJson/guang_xi_geo"],function(t){i(e(t))})}},"湖南":{getGeoJson:function(i){t(["./geoJson/hu_nan_geo"],function(t){i(e(t))})}},"陕西":{getGeoJson:function(i){t(["./geoJson/shan_xi_1_geo"],function(t){i(e(t))})}},"广东":{getGeoJson:function(i){t(["./geoJson/guang_dong_geo"],function(t){i(e(t))})}},"吉林":{getGeoJson:function(i){t(["./geoJson/ji_lin_geo"],function(t){i(e(t))})}},"河北":{getGeoJson:function(i){t(["./geoJson/he_bei_geo"],function(t){i(e(t))})}},"湖北":{getGeoJson:function(i){t(["./geoJson/hu_bei_geo"],function(t){i(e(t))})}},"贵州":{getGeoJson:function(i){t(["./geoJson/gui_zhou_geo"],function(t){i(e(t))})}},"山东":{getGeoJson:function(i){t(["./geoJson/shan_dong_geo"],function(t){i(e(t))})}},"江西":{getGeoJson:function(i){t(["./geoJson/jiang_xi_geo"],function(t){i(e(t))})}},"河南":{getGeoJson:function(i){t(["./geoJson/he_nan_geo"],function(t){i(e(t))})}},"辽宁":{getGeoJson:function(i){t(["./geoJson/liao_ning_geo"],function(t){i(e(t))})}},"山西":{getGeoJson:function(i){t(["./geoJson/shan_xi_2_geo"],function(t){i(e(t))})}},"安徽":{getGeoJson:function(i){t(["./geoJson/an_hui_geo"],function(t){i(e(t))})}},"福建":{getGeoJson:function(i){t(["./geoJson/fu_jian_geo"],function(t){i(e(t))})}},"浙江":{getGeoJson:function(i){t(["./geoJson/zhe_jiang_geo"],function(t){i(e(t))})}},"江苏":{getGeoJson:function(i){t(["./geoJson/jiang_su_geo"],function(t){i(e(t))})}},"重庆":{getGeoJson:function(i){t(["./geoJson/chong_qing_geo"],function(t){i(e(t))})}},"宁夏":{getGeoJson:function(i){t(["./geoJson/ning_xia_geo"],function(t){i(e(t))})}},"海南":{getGeoJson:function(i){t(["./geoJson/hai_nan_geo"],function(t){i(e(t))})}},"台湾":{getGeoJson:function(i){t(["./geoJson/tai_wan_geo"],function(t){i(e(t))})}},"北京":{getGeoJson:function(i){t(["./geoJson/bei_jing_geo"],function(t){i(e(t))})}},"天津":{getGeoJson:function(i){t(["./geoJson/tian_jin_geo"],function(t){i(e(t))})}},"上海":{getGeoJson:function(i){t(["./geoJson/shang_hai_geo"],function(t){i(e(t))})}},"香港":{getGeoJson:function(i){t(["./geoJson/xiang_gang_geo"],function(t){i(e(t))})}},"澳门":{getGeoJson:function(i){t(["./geoJson/ao_men_geo"],function(t){i(e(t))})}}};return{decode:e,params:o}}),define("echarts/util/mapData/textFixed",[],function(){return{"广东":[0,-10],"香港":[10,10],"澳门":[-10,18],"黑龙江":[0,20],"天津":[5,5],"深圳市":[-35,0],"红河哈尼族彝族自治州":[0,20],"楚雄彝族自治州":[-5,15],"石河子市":[-5,5],"五家渠市":[0,-10],"昌吉回族自治州":[10,10],"昌江黎族自治县":[0,20],"陵水黎族自治县":[0,20],"东方市":[0,20],"渭南市":[0,20]}}),define("echarts/util/mapData/geoCoord",[],function(){return{Russia:[100,60],"United States of America":[-99,38]}}),define("echarts/util/projection/svg",["require","zrender/shape/Path"],function(t){function e(t){return parseFloat(t||0)
}function i(t){for(var i=t.firstChild;"svg"!=i.nodeName.toLowerCase()||1!=i.nodeType;)i=i.nextSibling;var o=e(i.getAttribute("x")),s=e(i.getAttribute("y")),a=e(i.getAttribute("width")),n=e(i.getAttribute("height"));return{left:o,top:s,width:a,height:n}}function o(t,e){function i(t){var e=t.tagName;if(d[e]){var a=d[e](t,o);a&&(a.scale=o,a.properties={name:t.getAttribute("name")||""},a.id=t.id,r(a,t),s.push(a))}for(var n=t.childNodes,h=0,l=n.length;l>h;h++)i(n[h])}var o=[e.scale.x,e.scale.y],s=[];return i(t),s}function s(t,e){var i=e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y];return[i[0]/t.scale.x,i[1]/t.scale.y]}function a(t,e){var i=e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y];return[i[0]*t.scale.x,i[1]*t.scale.y]}function n(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(t,e){var i=e.getAttribute("fill"),o=e.getAttribute("stroke"),s=e.getAttribute("stroke-width"),a=e.getAttribute("opacity");i&&"none"!=i?(t.color=i,o?(t.brushType="both",t.strokeColor=o):t.brushType="fill"):o&&"none"!=o&&(t.strokeColor=o,t.brushType="stroke"),s&&"none"!=s&&(t.lineWidth=parseFloat(s)),a&&"none"!=a&&(t.opacity=parseFloat(a))}function h(t){for(var e=n(t).replace(/,/g," ").split(/\s+/),i=[],o=0;o<e.length;){var s=parseFloat(e[o++]),a=parseFloat(e[o++]);i.push([s,a])}return i}var l=t("zrender/shape/Path"),d={path:function(t,e){var i=t.getAttribute("d"),o=l.prototype.getRect({path:i});return{shapeType:"path",path:i,cp:[(o.x+o.width/2)*e[0],(o.y+o.height/2)*e[1]]}},rect:function(t,i){var o=e(t.getAttribute("x")),s=e(t.getAttribute("y")),a=e(t.getAttribute("width")),n=e(t.getAttribute("height"));return{shapeType:"rectangle",x:o,y:s,width:a,height:n,cp:[(o+a/2)*i[0],(s+n/2)*i[1]]}},line:function(t,i){var o=e(t.getAttribute("x1")),s=e(t.getAttribute("y1")),a=e(t.getAttribute("x2")),n=e(t.getAttribute("y2"));return{shapeType:"line",xStart:o,yStart:s,xEnd:a,yEnd:n,cp:[.5*(o+a)*i[0],.5*(s+n)*i[1]]}},circle:function(t,i){var o=e(t.getAttribute("cx")),s=e(t.getAttribute("cy")),a=e(t.getAttribute("r"));return{shapeType:"circle",x:o,y:s,r:a,cp:[o*i[0],s*i[1]]}},ellipse:function(t,e){var i=parseFloat(t.getAttribute("cx")||0),o=parseFloat(t.getAttribute("cy")||0),s=parseFloat(t.getAttribute("rx")||0),a=parseFloat(t.getAttribute("ry")||0);return{shapeType:"ellipse",x:i,y:o,a:s,b:a,cp:[i*e[0],o*e[1]]}},polygon:function(t,e){var i=t.getAttribute("points"),o=[1/0,1/0],s=[-1/0,-1/0];if(i){i=h(i);for(var a=0;a<i.length;a++){var n=i[a];o[0]=Math.min(n[0],o[0]),o[1]=Math.min(n[1],o[1]),s[0]=Math.max(n[0],s[0]),s[1]=Math.max(n[1],s[1])}return{shapeType:"polygon",pointList:i,cp:[(o[0]+s[0])/2*e[0],(o[1]+s[1])/2*e[0]]}}},polyline:function(t,e){var i=d.polygon(t,e);return i}};return{getBbox:i,geoJson2Path:o,pos2geo:s,geo2pos:a}}),define("echarts/util/projection/normal",[],function(){function t(t,i){return i=i||{},t.srcSize||e(t,i),t.srcSize}function e(t,e){e=e||{},n.xmin=360,n.xmax=-360,n.ymin=180,n.ymax=-180;for(var i,o,s=t.features,a=0,r=s.length;r>a;a++)if(o=s[a],!o.properties.name||!e[o.properties.name])switch(o.type){case"Feature":n[o.geometry.type](o.geometry.coordinates);break;case"GeometryCollection":i=o.geometries;for(var h=0,l=i.length;l>h;h++)n[i[h].type](i[h].coordinates)}return t.srcSize={left:1*n.xmin.toFixed(4),top:1*n.ymin.toFixed(4),width:1*(n.xmax-n.xmin).toFixed(4),height:1*(n.ymax-n.ymin).toFixed(4)},t}function i(t,i,o){function s(t,e){f=t.type,m=t.coordinates,a._bbox={xmin:360,xmax:-360,ymin:180,ymax:-180},y=a[f](m),d.push({path:y,cp:a.makePoint(e.properties.cp?e.properties.cp:[(a._bbox.xmin+a._bbox.xmax)/2,(a._bbox.ymin+a._bbox.ymax)/2]),properties:e.properties,id:e.id})}o=o||{},a.scale=null,a.offset=null,t.srcSize||e(t,o),i.offset={x:t.srcSize.left,y:t.srcSize.top,left:i.OffsetLeft||0,top:i.OffsetTop||0},a.scale=i.scale,a.offset=i.offset;for(var n,r,h,l=t.features,d=[],c=0,p=l.length;p>c;c++)if(h=l[c],!h.properties.name||!o[h.properties.name])if("Feature"==h.type)s(h.geometry,h);else if("GeometryCollection"==h.type){n=h.geometries;for(var u=0,g=n.length;g>u;u++)r=n[u],s(r,r)}var f,m,y;return d}function o(t,e){var i,o;return e instanceof Array?(i=1*e[0],o=1*e[1]):(i=1*e.x,o=1*e.y),i=i/t.scale.x+t.offset.x-168.5,i=i>180?i-360:i,o=90-(o/t.scale.y+t.offset.y),[i,o]}function s(t,e){return a.offset=t.offset,a.scale=t.scale,a.makePoint(e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y])}var a={formatPoint:function(t){return[(t[0]<-168.5&&t[1]>63.8?t[0]+360:t[0])+168.5,90-t[1]]},makePoint:function(t){var e=this,i=e.formatPoint(t);e._bbox.xmin>t[0]&&(e._bbox.xmin=t[0]),e._bbox.xmax<t[0]&&(e._bbox.xmax=t[0]),e._bbox.ymin>t[1]&&(e._bbox.ymin=t[1]),e._bbox.ymax<t[1]&&(e._bbox.ymax=t[1]);var o=(i[0]-a.offset.x)*a.scale.x+a.offset.left,s=(i[1]-a.offset.y)*a.scale.y+a.offset.top;return[o,s]},Point:function(t){return t=this.makePoint(t),t.join(",")},LineString:function(t){for(var e,i="",o=0,s=t.length;s>o;o++)e=a.makePoint(t[o]),i=0===o?"M"+e.join(","):i+"L"+e.join(",");return i},Polygon:function(t){for(var e="",i=0,o=t.length;o>i;i++)e=e+a.LineString(t[i])+"z";return e},MultiPoint:function(t){for(var e=[],i=0,o=t.length;o>i;i++)e.push(a.Point(t[i]));return e},MultiLineString:function(t){for(var e="",i=0,o=t.length;o>i;i++)e+=a.LineString(t[i]);return e},MultiPolygon:function(t){for(var e="",i=0,o=t.length;o>i;i++)e+=a.Polygon(t[i]);return e}},n={formatPoint:a.formatPoint,makePoint:function(t){var e=this,i=e.formatPoint(t),o=i[0],s=i[1];e.xmin>o&&(e.xmin=o),e.xmax<o&&(e.xmax=o),e.ymin>s&&(e.ymin=s),e.ymax<s&&(e.ymax=s)},Point:function(t){this.makePoint(t)},LineString:function(t){for(var e=0,i=t.length;i>e;e++)this.makePoint(t[e])},Polygon:function(t){for(var e=0,i=t.length;i>e;e++)this.LineString(t[e])},MultiPoint:function(t){for(var e=0,i=t.length;i>e;e++)this.Point(t[e])},MultiLineString:function(t){for(var e=0,i=t.length;i>e;e++)this.LineString(t[e])},MultiPolygon:function(t){for(var e=0,i=t.length;i>e;e++)this.Polygon(t[e])}};return{getBbox:t,geoJson2Path:i,pos2geo:o,geo2pos:s}}),define("echarts/util/shape/HandlePolygon",["require","zrender/shape/Base","zrender/shape/Polygon","zrender/tool/util"],function(t){function e(t){i.call(this,t)}var i=t("zrender/shape/Base"),o=t("zrender/shape/Polygon"),s=t("zrender/tool/util");return e.prototype={type:"handle-polygon",buildPath:function(t,e){o.prototype.buildPath(t,e)},isCover:function(t,e){var i=this.transformCoordToLocal(t,e);t=i[0],e=i[1];var o=this.style.rect;return t>=o.x&&t<=o.x+o.width&&e>=o.y&&e<=o.y+o.height?!0:!1}},s.inherits(e,i),e});