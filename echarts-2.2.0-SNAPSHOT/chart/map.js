define("echarts/chart/map",["require","./base","zrender/shape/Text","zrender/shape/Path","zrender/shape/Circle","zrender/shape/Rectangle","zrender/shape/Line","zrender/shape/Polygon","zrender/shape/Ellipse","../component/dataRange","../component/roamController","../config","../util/ecData","zrender/tool/util","zrender/config","zrender/tool/event","../util/mapData/params","../util/mapData/textFixed","../util/mapData/geoCoord","../util/projection/svg","../util/projection/normal","../chart"],function(t){function e(t,e,o,s,a){i.call(this,t,e,o,s,a);var r=this;r._onmousewheel=function(t){return r.__onmousewheel(t)},r._onmousedown=function(t){return r.__onmousedown(t)},r._onmousemove=function(t){return r.__onmousemove(t)},r._onmouseup=function(t){return r.__onmouseup(t)},r._onroamcontroller=function(t){return r.__onroamcontroller(t)},r._ondrhoverlink=function(t){return r.__ondrhoverlink(t)},this._isAlive=!0,this._selectedMode={},this._activeMapType={},this._clickable={},this._hoverable={},this._showLegendSymbol={},this._selected={},this._mapTypeMap={},this._mapDataMap={},this._nameMap={},this._specialArea={},this._refreshDelayTicket,this._mapDataRequireCounter,this._markAnimation=!1,this._hoverLinkMap={},this._roamMap={},this._scaleLimitMap={},this._mx,this._my,this._mousedown,this._justMove,this._curMapType,this.refresh(s),this.zr.on(u.EVENT.MOUSEWHEEL,this._onmousewheel),this.zr.on(u.EVENT.MOUSEDOWN,this._onmousedown),e.bind(d.EVENT.ROAMCONTROLLER,this._onroamcontroller),e.bind(d.EVENT.DATA_RANGE_HOVERLINK,this._ondrhoverlink)}var i=t("./base"),o=t("zrender/shape/Text"),s=t("zrender/shape/Path"),a=t("zrender/shape/Circle"),r=t("zrender/shape/Rectangle"),n=t("zrender/shape/Line"),h=t("zrender/shape/Polygon"),l=t("zrender/shape/Ellipse");t("../component/dataRange"),t("../component/roamController");var d=t("../config");d.map={zlevel:0,z:2,mapType:"china",mapValuePrecision:0,showLegendSymbol:!0,dataRangeHoverLink:!0,hoverable:!0,clickable:!0,itemStyle:{normal:{borderColor:"rgba(0,0,0,0)",borderWidth:1,areaStyle:{color:"#ccc"},label:{show:!1,textStyle:{color:"rgb(139,69,19)"}}},emphasis:{borderColor:"rgba(0,0,0,0)",borderWidth:1,areaStyle:{color:"rgba(255,215,0,0.8)"},label:{show:!1,textStyle:{color:"rgb(100,0,0)"}}}}};var c=t("../util/ecData"),p=t("zrender/tool/util"),u=t("zrender/config"),g=t("zrender/tool/event"),f=t("../util/mapData/params").params,m=t("../util/mapData/textFixed"),y=t("../util/mapData/geoCoord");return e.prototype={type:d.CHART_TYPE_MAP,_buildShape:function(){var t=this.series;this.selectedMap={},this._activeMapType={};for(var e,i,o,s,a=this.component.legend,r={},n={},h={},l={},c=0,u=t.length;u>c;c++)if(t[c].type==d.CHART_TYPE_MAP&&(t[c]=this.reformOption(t[c]),i=t[c].mapType,n[i]=n[i]||{},n[i][c]=!0,h[i]=h[i]||t[c].mapValuePrecision,this._scaleLimitMap[i]=this._scaleLimitMap[i]||{},t[c].scaleLimit&&p.merge(this._scaleLimitMap[i],t[c].scaleLimit,!0),this._roamMap[i]=t[c].roam||this._roamMap[i],this._hoverLinkMap[i]=t[c].dataRangeHoverLink||this._hoverLinkMap[i],this._nameMap[i]=this._nameMap[i]||{},t[c].nameMap&&p.merge(this._nameMap[i],t[c].nameMap,!0),this._activeMapType[i]=!0,t[c].textFixed&&p.merge(m,t[c].textFixed,!0),t[c].geoCoord&&p.merge(y,t[c].geoCoord,!0),this._selectedMode[i]=this._selectedMode[i]||t[c].selectedMode,(null==this._hoverable[i]||this._hoverable[i])&&(this._hoverable[i]=t[c].hoverable),(null==this._clickable[i]||this._clickable[i])&&(this._clickable[i]=t[c].clickable),(null==this._showLegendSymbol[i]||this._showLegendSymbol[i])&&(this._showLegendSymbol[i]=t[c].showLegendSymbol),l[i]=l[i]||t[c].mapValueCalculation,e=t[c].name,this.selectedMap[e]=a?a.isSelected(e):!0,this.selectedMap[e])){r[i]=r[i]||{},o=t[c].data;for(var g=0,_=o.length;_>g;g++){s=this._nameChange(i,o[g].name),r[i][s]=r[i][s]||{seriesIndex:[]};for(var v in o[g])"value"!=v?r[i][s][v]=o[g][v]:isNaN(o[g].value)||(null==r[i][s].value&&(r[i][s].value=0),r[i][s].value+=+o[g].value);r[i][s].seriesIndex.push(c)}}this._mapDataRequireCounter=0;for(var x in r)this._mapDataRequireCounter++;this._clearSelected(),0===this._mapDataRequireCounter&&(this.clear(),this.zr&&this.zr.delShape(this.lastShapeList),this.lastShapeList=[]);for(var x in r){if(l[x]&&"average"==l[x])for(var _ in r[x])r[x][_].value=(r[x][_].value/r[x][_].seriesIndex.length).toFixed(h[x])-0;this._mapDataMap[x]=this._mapDataMap[x]||{},this._mapDataMap[x].mapData?this._mapDataCallback(x,r[x],n[x])(this._mapDataMap[x].mapData):f[x.replace(/\|.*/,"")].getGeoJson&&(this._specialArea[x]=f[x.replace(/\|.*/,"")].specialArea||this._specialArea[x],f[x.replace(/\|.*/,"")].getGeoJson(this._mapDataCallback(x,r[x],n[x])))}},_mapDataCallback:function(e,i,o){var s=this;return function(a){s._isAlive&&null!=s._activeMapType[e]&&(-1!=e.indexOf("|")&&(a=s._getSubMapData(e,a)),s._mapDataMap[e].mapData=a,a.firstChild?(s._mapDataMap[e].rate=1,s._mapDataMap[e].projection=t("../util/projection/svg")):(s._mapDataMap[e].rate=.75,s._mapDataMap[e].projection=t("../util/projection/normal")),s._buildMap(e,s._getProjectionData(e,a,o),i,o),s._buildMark(e,o),--s._mapDataRequireCounter<=0&&(s.addShapeList(),s.zr.refreshNextFrame()))}},_clearSelected:function(){for(var t in this._selected)this._activeMapType[this._mapTypeMap[t]]||(delete this._selected[t],delete this._mapTypeMap[t])},_getSubMapData:function(t,e){for(var i=t.replace(/^.*\|/,""),o=e.features,s=0,a=o.length;a>s;s++)if(o[s].properties&&o[s].properties.name==i){o=o[s],"United States of America"==i&&o.geometry.coordinates.length>1&&(o={geometry:{coordinates:o.geometry.coordinates.slice(5,6),type:o.geometry.type},id:o.id,properties:o.properties,type:o.type});break}return{type:"FeatureCollection",features:[o]}},_getProjectionData:function(t,e,i){var o,s=this._mapDataMap[t].projection,a=[],r=this._mapDataMap[t].bbox||s.getBbox(e,this._specialArea[t]);o=this._mapDataMap[t].hasRoam?this._mapDataMap[t].transform:this._getTransform(r,i,this._mapDataMap[t].rate);var n,h=this._mapDataMap[t].lastTransform||{scale:{}};o.left!=h.left||o.top!=h.top||o.scale.x!=h.scale.x||o.scale.y!=h.scale.y?(n=s.geoJson2Path(e,o,this._specialArea[t]),h=p.clone(o)):(o=this._mapDataMap[t].transform,n=this._mapDataMap[t].pathArray),this._mapDataMap[t].bbox=r,this._mapDataMap[t].transform=o,this._mapDataMap[t].lastTransform=h,this._mapDataMap[t].pathArray=n;for(var l=[o.left,o.top],d=0,c=n.length;c>d;d++)a.push(this._getSingleProvince(t,n[d],l));if(this._specialArea[t])for(var u in this._specialArea[t])a.push(this._getSpecialProjectionData(t,e,u,this._specialArea[t][u],l));if("china"==t){var g=this.geo2pos(t,y["南海诸岛"]||f["南海诸岛"].textCoord),_=o.scale.x/10.5,v=[32*_+g[0],83*_+g[1]];m["南海诸岛"]&&(v[0]+=m["南海诸岛"][0],v[1]+=m["南海诸岛"][1]),a.push({name:this._nameChange(t,"南海诸岛"),path:f["南海诸岛"].getPath(g,_),position:l,textX:v[0],textY:v[1]})}return a},_getSpecialProjectionData:function(e,i,o,s,a){i=this._getSubMapData("x|"+o,i);var r=t("../util/projection/normal"),n=r.getBbox(i),h=this.geo2pos(e,[s.left,s.top]),l=this.geo2pos(e,[s.left+s.width,s.top+s.height]),d=Math.abs(l[0]-h[0]),c=Math.abs(l[1]-h[1]),p=n.width,u=n.height,g=d/.75/p,f=c/u;g>f?(g=.75*f,d=p*g):(f=g,g=.75*f,c=u*f);var m={OffsetLeft:h[0],OffsetTop:h[1],scale:{x:g,y:f}},y=r.geoJson2Path(i,m);return this._getSingleProvince(e,y[0],a)},_getSingleProvince:function(t,e,i){var o,s=e.properties.name,a=m[s]||[0,0];if(y[s])o=this.geo2pos(t,y[s]);else if(e.cp)o=[e.cp[0]+a[0],e.cp[1]+a[1]];else{var r=this._mapDataMap[t].bbox;o=this.geo2pos(t,[r.left+r.width/2,r.top+r.height/2]),o[0]+=a[0],o[1]+=a[1]}return e.name=this._nameChange(t,s),e.position=i,e.textX=o[0],e.textY=o[1],e},_getTransform:function(t,e,i){var o,s,a,r,n,h,l,d=this.series,c=this.zr.getWidth(),p=this.zr.getHeight(),u=Math.round(.02*Math.min(c,p));for(var g in e)o=d[g].mapLocation||{},a=o.x||a,n=o.y||n,h=o.width||h,l=o.height||l;s=this.parsePercent(a,c),s=isNaN(s)?u:s,r=this.parsePercent(n,p),r=isNaN(r)?u:r,h=null==h?c-s-2*u:this.parsePercent(h,c),l=null==l?p-r-2*u:this.parsePercent(l,p);var f=t.width,m=t.height,y=h/i/f,_=l/m;if(y>_?(y=_*i,h=f*y):(_=y,y=_*i,l=m*_),isNaN(a))switch(a=a||"center",a+""){case"center":s=Math.floor((c-h)/2);break;case"right":s=c-h}if(isNaN(n))switch(n=n||"center",n+""){case"center":r=Math.floor((p-l)/2);break;case"bottom":r=p-l}return{left:s,top:r,width:h,height:l,baseScale:1,scale:{x:y,y:_}}},_buildMap:function(t,e,i,u){for(var g,f,m,y,_,v,x,b,S,T,z,C=this.series,L=this.component.legend,M=this.component.dataRange,w=0,E=e.length;E>w;w++){if(b=p.clone(e[w]),S={name:b.name,path:b.path,position:p.clone(b.position)},f=b.name,m=i[f]){_=[m],g="";for(var A=0,k=m.seriesIndex.length;k>A;A++)_.push(C[m.seriesIndex[A]]),g+=C[m.seriesIndex[A]].name+" ",L&&this._showLegendSymbol[t]&&L.hasColor(C[m.seriesIndex[A]].name)&&this.shapeList.push(new a({zlevel:this.getZlevelBase(),z:this.getZBase()+1,position:p.clone(b.position),_mapType:t,style:{x:b.textX+3+7*A,y:b.textY-10,r:3,color:L.getColor(C[m.seriesIndex[A]].name)},hoverable:!1}));y=m.value}else{m="-",g="",_=[];for(var O in u)_.push(C[O]);y="-"}switch(this.ecTheme.map&&_.push(this.ecTheme.map),_.push(d),v=M&&!isNaN(y)?M.getColor(y):null,b.color=b.color||v||this.getItemStyleColor(this.deepQuery(_,"itemStyle.normal.color"),m.seriesIndex,-1,m)||this.deepQuery(_,"itemStyle.normal.areaStyle.color"),b.strokeColor=b.strokeColor||this.deepQuery(_,"itemStyle.normal.borderColor"),b.lineWidth=b.lineWidth||this.deepQuery(_,"itemStyle.normal.borderWidth"),S.color=this.getItemStyleColor(this.deepQuery(_,"itemStyle.emphasis.color"),m.seriesIndex,-1,m)||this.deepQuery(_,"itemStyle.emphasis.areaStyle.color")||b.color,S.strokeColor=this.deepQuery(_,"itemStyle.emphasis.borderColor")||b.strokeColor,S.lineWidth=this.deepQuery(_,"itemStyle.emphasis.borderWidth")||b.lineWidth,b.brushType=S.brushType=b.brushType||"both",b.lineJoin=S.lineJoin="round",b._name=S._name=f,x=this.deepQuery(_,"itemStyle.normal.label.textStyle"),z={zlevel:this.getZlevelBase(),z:this.getZBase()+1,position:p.clone(b.position),_mapType:t,_geo:this.pos2geo(t,[b.textX,b.textY]),style:{brushType:"fill",x:b.textX,y:b.textY,text:this.getLabelText(f,y,_,"normal"),_name:f,textAlign:"center",color:this.deepQuery(_,"itemStyle.normal.label.show")?this.deepQuery(_,"itemStyle.normal.label.textStyle.color"):"rgba(0,0,0,0)",textFont:this.getFont(x)}},z._style=p.clone(z.style),z.highlightStyle=p.clone(z.style),this.deepQuery(_,"itemStyle.emphasis.label.show")?(z.highlightStyle.text=this.getLabelText(f,y,_,"emphasis"),z.highlightStyle.color=this.deepQuery(_,"itemStyle.emphasis.label.textStyle.color")||z.style.color,x=this.deepQuery(_,"itemStyle.emphasis.label.textStyle")||x,z.highlightStyle.textFont=this.getFont(x)):z.highlightStyle.color="rgba(0,0,0,0)",T={zlevel:this.getZlevelBase(),z:this.getZBase(),position:p.clone(b.position),style:b,highlightStyle:S,_style:p.clone(b),_mapType:t},null!=b.scale&&(T.scale=p.clone(b.scale)),z=new o(z),T.style.shapeType){case"rectangle":T=new r(T);break;case"line":T=new n(T);break;case"circle":T=new a(T);break;case"polygon":T=new h(T);break;case"ellipse":T=new l(T);break;default:T=new s(T),T.buildPathArray&&(T.style.pathArray=T.buildPathArray(T.style.path))}(this._selectedMode[t]&&this._selected[f]||m.selected&&this._selected[f]!==!1)&&(z.style=z.highlightStyle,T.style=T.highlightStyle),z.clickable=T.clickable=this._clickable[t]&&(null==m.clickable||m.clickable),this._selectedMode[t]&&(this._selected[f]=null!=this._selected[f]?this._selected[f]:m.selected,this._mapTypeMap[f]=t,(null==m.selectable||m.selectable)&&(T.clickable=z.clickable=!0,T.onclick=z.onclick=this.shapeHandler.onclick)),this._hoverable[t]&&(null==m.hoverable||m.hoverable)?(z.hoverable=T.hoverable=!0,T.hoverConnect=z.id,z.hoverConnect=T.id):z.hoverable=T.hoverable=!1,c.pack(z,{name:g,tooltip:this.deepQuery(_,"tooltip")},0,m,0,f),this.shapeList.push(z),c.pack(T,{name:g,tooltip:this.deepQuery(_,"tooltip")},0,m,0,f),this.shapeList.push(T)}},_buildMark:function(t,e){this._seriesIndexToMapType=this._seriesIndexToMapType||{},this.markAttachStyle=this.markAttachStyle||{};var i=[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top];"none"==t&&(i=[0,0]);for(var o in e)this._seriesIndexToMapType[o]=t,this.markAttachStyle[o]={position:i,_mapType:t},this.buildMark(o)},getMarkCoord:function(t,e){return e.geoCoord||y[e.name]?this.geo2pos(this._seriesIndexToMapType[t],e.geoCoord||y[e.name]):[0,0]},getMarkGeo:function(t){return t.geoCoord||y[t.name]},_nameChange:function(t,e){return this._nameMap[t][e]||e},getLabelText:function(t,e,i,o){var s=this.deepQuery(i,"itemStyle."+o+".label.formatter");return s?"function"==typeof s?s.call(this.myChart,t,e):"string"==typeof s?(s=s.replace("{a}","{a0}").replace("{b}","{b0}"),s=s.replace("{a0}",t).replace("{b0}",e)):void 0:t},_findMapTypeByPos:function(t,e){var i,o,s,a,r;for(var n in this._mapDataMap)if(i=this._mapDataMap[n].transform,i&&this._roamMap[n]&&this._activeMapType[n]&&(o=i.left,s=i.top,a=i.width,r=i.height,t>=o&&o+a>=t&&e>=s&&s+r>=e))return n},__onmousewheel:function(t){if(!(this.shapeList.length<=0)){var e,i,o=t.event,s=g.getX(o),a=g.getY(o),r=g.getDelta(o),n=t.mapTypeControl;n||(n={},i=this._findMapTypeByPos(s,a),i&&this._roamMap[i]&&"move"!=this._roamMap[i]&&(n[i]=!0));var h=!1;for(i in n)if(n[i]){h=!0;var l=this._mapDataMap[i].transform,c=l.left,p=l.top,u=l.width,f=l.height,m=this.pos2geo(i,[s-c,a-p]);if(r>0){if(e=1.2,null!=this._scaleLimitMap[i].max&&l.baseScale>=this._scaleLimitMap[i].max)continue}else if(e=1/1.2,null!=this._scaleLimitMap[i].min&&l.baseScale<=this._scaleLimitMap[i].min)continue;l.baseScale*=e,l.scale.x*=e,l.scale.y*=e,l.width=u*e,l.height=f*e,this._mapDataMap[i].hasRoam=!0,this._mapDataMap[i].transform=l,m=this.geo2pos(i,m),l.left-=m[0]-(s-c),l.top-=m[1]-(a-p),this._mapDataMap[i].transform=l,this.clearEffectShape(!0);for(var y=0,_=this.shapeList.length;_>y;y++)this.shapeList[y]._mapType==i&&(this.shapeList[y].position[0]=l.left,this.shapeList[y].position[1]=l.top,"path"==this.shapeList[y].type||"symbol"==this.shapeList[y].type||"circle"==this.shapeList[y].type||"rectangle"==this.shapeList[y].type||"polygon"==this.shapeList[y].type||"line"==this.shapeList[y].type||"ellipse"==this.shapeList[y].type?(this.shapeList[y].scale[0]*=e,this.shapeList[y].scale[1]*=e):"mark-line"==this.shapeList[y].type?(this.shapeList[y].style.pointListLength=void 0,this.shapeList[y].style.pointList=!1,m=this.geo2pos(i,this.shapeList[y]._geo[0]),this.shapeList[y].style.xStart=m[0],this.shapeList[y].style.yStart=m[1],m=this.geo2pos(i,this.shapeList[y]._geo[1]),this.shapeList[y]._x=this.shapeList[y].style.xEnd=m[0],this.shapeList[y]._y=this.shapeList[y].style.yEnd=m[1]):"icon"==this.shapeList[y].type||"image"==this.shapeList[y].type?(m=this.geo2pos(i,this.shapeList[y]._geo),this.shapeList[y].style.x=this.shapeList[y].style._x=m[0]-this.shapeList[y].style.width/2,this.shapeList[y].style.y=this.shapeList[y].style._y=m[1]-this.shapeList[y].style.height/2):(m=this.geo2pos(i,this.shapeList[y]._geo),this.shapeList[y].style.x=m[0],this.shapeList[y].style.y=m[1],"text"==this.shapeList[y].type&&(this.shapeList[y]._style.x=this.shapeList[y].highlightStyle.x=m[0],this.shapeList[y]._style.y=this.shapeList[y].highlightStyle.y=m[1])),this.zr.modShape(this.shapeList[y].id))}if(h){g.stop(o),this.zr.refreshNextFrame();var v=this;clearTimeout(this._refreshDelayTicket),this._refreshDelayTicket=setTimeout(function(){v&&v.shapeList&&v.animationEffect()},100),this.messageCenter.dispatch(d.EVENT.MAP_ROAM,t.event,{type:"scale"},this.myChart)}}},__onmousedown:function(t){if(!(this.shapeList.length<=0)){var e=t.target;if(!e||!e.draggable){var i=t.event,o=g.getX(i),s=g.getY(i),a=this._findMapTypeByPos(o,s);if(a&&this._roamMap[a]&&"scale"!=this._roamMap[a]){this._mousedown=!0,this._mx=o,this._my=s,this._curMapType=a,this.zr.on(u.EVENT.MOUSEUP,this._onmouseup);var r=this;setTimeout(function(){r.zr.on(u.EVENT.MOUSEMOVE,r._onmousemove)},100)}}}},__onmousemove:function(t){if(this._mousedown&&this._isAlive){var e=t.event,i=g.getX(e),o=g.getY(e),s=this._mapDataMap[this._curMapType].transform;s.hasRoam=!0,s.left-=this._mx-i,s.top-=this._my-o,this._mx=i,this._my=o,this._mapDataMap[this._curMapType].transform=s;for(var a=0,r=this.shapeList.length;r>a;a++)this.shapeList[a]._mapType==this._curMapType&&(this.shapeList[a].position[0]=s.left,this.shapeList[a].position[1]=s.top,this.zr.modShape(this.shapeList[a].id));this.messageCenter.dispatch(d.EVENT.MAP_ROAM,t.event,{type:"move"},this.myChart),this.clearEffectShape(!0),this.zr.refreshNextFrame(),this._justMove=!0,g.stop(e)}},__onmouseup:function(t){var e=t.event;this._mx=g.getX(e),this._my=g.getY(e),this._mousedown=!1;var i=this;setTimeout(function(){i._justMove&&i.animationEffect(),i._justMove=!1,i.zr.un(u.EVENT.MOUSEMOVE,i._onmousemove),i.zr.un(u.EVENT.MOUSEUP,i._onmouseup)},120)},__onroamcontroller:function(t){var e=t.event;e.zrenderX=this.zr.getWidth()/2,e.zrenderY=this.zr.getHeight()/2;var i=t.mapTypeControl,o=0,s=0,a=t.step;switch(t.roamType){case"scaleUp":return e.zrenderDelta=1,void this.__onmousewheel({event:e,mapTypeControl:i});case"scaleDown":return e.zrenderDelta=-1,void this.__onmousewheel({event:e,mapTypeControl:i});case"up":o=-a;break;case"down":o=a;break;case"left":s=-a;break;case"right":s=a}var r,n;for(n in i)this._mapDataMap[n]&&this._activeMapType[n]&&(r=this._mapDataMap[n].transform,r.hasRoam=!0,r.left-=s,r.top-=o,this._mapDataMap[n].transform=r);for(var h=0,l=this.shapeList.length;l>h;h++)n=this.shapeList[h]._mapType,i[n]&&this._activeMapType[n]&&(r=this._mapDataMap[n].transform,this.shapeList[h].position[0]=r.left,this.shapeList[h].position[1]=r.top,this.zr.modShape(this.shapeList[h].id));this.messageCenter.dispatch(d.EVENT.MAP_ROAM,t.event,{type:"move"},this.myChart),this.clearEffectShape(!0),this.zr.refreshNextFrame(),clearTimeout(this.dircetionTimer);var c=this;this.dircetionTimer=setTimeout(function(){c.animationEffect()},150)},__ondrhoverlink:function(t){for(var e,i,o=0,s=this.shapeList.length;s>o;o++)e=this.shapeList[o]._mapType,this._hoverLinkMap[e]&&this._activeMapType[e]&&(i=c.get(this.shapeList[o],"value"),null!=i&&i>=t.valueMin&&i<=t.valueMax&&this.zr.addHoverShape(this.shapeList[o]))},onclick:function(t){if(this.isClick&&t.target&&!this._justMove&&"icon"!=t.target.type){this.isClick=!1;var e=t.target,i=e.style._name,o=this.shapeList.length,s=e._mapType||"";if("single"==this._selectedMode[s])for(var a in this._selected)if(this._selected[a]&&this._mapTypeMap[a]==s){for(var r=0;o>r;r++)this.shapeList[r].style._name==a&&this.shapeList[r]._mapType==s&&(this.shapeList[r].style=this.shapeList[r]._style,this.zr.modShape(this.shapeList[r].id));a!=i&&(this._selected[a]=!1)}this._selected[i]=!this._selected[i];for(var r=0;o>r;r++)this.shapeList[r].style._name==i&&this.shapeList[r]._mapType==s&&(this.shapeList[r].style=this._selected[i]?this.shapeList[r].highlightStyle:this.shapeList[r]._style,this.zr.modShape(this.shapeList[r].id));this.messageCenter.dispatch(d.EVENT.MAP_SELECTED,t.event,{selected:this._selected,target:i},this.myChart),this.zr.refreshNextFrame();var n=this;setTimeout(function(){n.zr.trigger(u.EVENT.MOUSEMOVE,t.event)},100)}},refresh:function(t){t&&(this.option=t,this.series=t.series),this._mapDataRequireCounter>0?this.clear():this.backupShapeList(),this._buildShape(),this.zr.refreshHover()},ondataRange:function(t,e){this.component.dataRange&&(this.refresh(),e.needRefresh=!0)},pos2geo:function(t,e){return this._mapDataMap[t].transform?this._mapDataMap[t].projection.pos2geo(this._mapDataMap[t].transform,e):null},getGeoByPos:function(t,e){if(!this._mapDataMap[t].transform)return null;var i=[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top];return e instanceof Array?(e[0]-=i[0],e[1]-=i[1]):(e.x-=i[0],e.y-=i[1]),this.pos2geo(t,e)},geo2pos:function(t,e){return this._mapDataMap[t].transform?this._mapDataMap[t].projection.geo2pos(this._mapDataMap[t].transform,e):null},getPosByGeo:function(t,e){if(!this._mapDataMap[t].transform)return null;var i=this.geo2pos(t,e);return i[0]+=this._mapDataMap[t].transform.left,i[1]+=this._mapDataMap[t].transform.top,i},getMapPosition:function(t){return this._mapDataMap[t].transform?[this._mapDataMap[t].transform.left,this._mapDataMap[t].transform.top]:null},onbeforDispose:function(){this._isAlive=!1,this.zr.un(u.EVENT.MOUSEWHEEL,this._onmousewheel),this.zr.un(u.EVENT.MOUSEDOWN,this._onmousedown),this.messageCenter.unbind(d.EVENT.ROAMCONTROLLER,this._onroamcontroller),this.messageCenter.unbind(d.EVENT.DATA_RANGE_HOVERLINK,this._ondrhoverlink)}},p.inherits(e,i),t("../chart").define("map",e),e}),define("zrender/shape/Path",["require","./Base","./util/PathProxy","../tool/util"],function(t){var e=t("./Base"),i=t("./util/PathProxy"),o=i.PathSegment,s=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},a=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(s(t)*s(e))},r=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(a(t,e))},n=function(t){e.call(this,t)};return n.prototype={type:"path",buildPathArray:function(t,e,i){if(!t)return[];e=e||0,i=i||0;var s=t,a=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];s=s.replace(/-/g," -"),s=s.replace(/  /g," "),s=s.replace(/ /g,","),s=s.replace(/,,/g,",");var r;for(r=0;r<a.length;r++)s=s.replace(new RegExp(a[r],"g"),"|"+a[r]);var n=s.split("|"),h=[],l=0,d=0;for(r=1;r<n.length;r++){var c=n[r],p=c.charAt(0);c=c.slice(1),c=c.replace(new RegExp("e,-","g"),"e-");var u=c.split(",");u.length>0&&""===u[0]&&u.shift();for(var g=0;g<u.length;g++)u[g]=parseFloat(u[g]);for(;u.length>0&&!isNaN(u[0]);){var f,m,y,_,v,x,b,S,T=null,z=[],C=l,L=d;switch(p){case"l":l+=u.shift(),d+=u.shift(),T="L",z.push(l,d);break;case"L":l=u.shift(),d=u.shift(),z.push(l,d);break;case"m":l+=u.shift(),d+=u.shift(),T="M",z.push(l,d),p="l";break;case"M":l=u.shift(),d=u.shift(),T="M",z.push(l,d),p="L";break;case"h":l+=u.shift(),T="L",z.push(l,d);break;case"H":l=u.shift(),T="L",z.push(l,d);break;case"v":d+=u.shift(),T="L",z.push(l,d);break;case"V":d=u.shift(),T="L",z.push(l,d);break;case"C":z.push(u.shift(),u.shift(),u.shift(),u.shift()),l=u.shift(),d=u.shift(),z.push(l,d);break;case"c":z.push(l+u.shift(),d+u.shift(),l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="C",z.push(l,d);break;case"S":f=l,m=d,y=h[h.length-1],"C"===y.command&&(f=l+(l-y.points[2]),m=d+(d-y.points[3])),z.push(f,m,u.shift(),u.shift()),l=u.shift(),d=u.shift(),T="C",z.push(l,d);break;case"s":f=l,m=d,y=h[h.length-1],"C"===y.command&&(f=l+(l-y.points[2]),m=d+(d-y.points[3])),z.push(f,m,l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="C",z.push(l,d);break;case"Q":z.push(u.shift(),u.shift()),l=u.shift(),d=u.shift(),z.push(l,d);break;case"q":z.push(l+u.shift(),d+u.shift()),l+=u.shift(),d+=u.shift(),T="Q",z.push(l,d);break;case"T":f=l,m=d,y=h[h.length-1],"Q"===y.command&&(f=l+(l-y.points[0]),m=d+(d-y.points[1])),l=u.shift(),d=u.shift(),T="Q",z.push(f,m,l,d);break;case"t":f=l,m=d,y=h[h.length-1],"Q"===y.command&&(f=l+(l-y.points[0]),m=d+(d-y.points[1])),l+=u.shift(),d+=u.shift(),T="Q",z.push(f,m,l,d);break;case"A":_=u.shift(),v=u.shift(),x=u.shift(),b=u.shift(),S=u.shift(),C=l,L=d,l=u.shift(),d=u.shift(),T="A",z=this._convertPoint(C,L,l,d,b,S,_,v,x);break;case"a":_=u.shift(),v=u.shift(),x=u.shift(),b=u.shift(),S=u.shift(),C=l,L=d,l+=u.shift(),d+=u.shift(),T="A",z=this._convertPoint(C,L,l,d,b,S,_,v,x)}for(var M=0,w=z.length;w>M;M+=2)z[M]+=e,z[M+1]+=i;h.push(new o(T||p,z))}("z"===p||"Z"===p)&&h.push(new o("z",[]))}return h},_convertPoint:function(t,e,i,o,s,n,h,l,d){var c=d*(Math.PI/180),p=Math.cos(c)*(t-i)/2+Math.sin(c)*(e-o)/2,u=-1*Math.sin(c)*(t-i)/2+Math.cos(c)*(e-o)/2,g=p*p/(h*h)+u*u/(l*l);g>1&&(h*=Math.sqrt(g),l*=Math.sqrt(g));var f=Math.sqrt((h*h*l*l-h*h*u*u-l*l*p*p)/(h*h*u*u+l*l*p*p));s===n&&(f*=-1),isNaN(f)&&(f=0);var m=f*h*u/l,y=f*-l*p/h,_=(t+i)/2+Math.cos(c)*m-Math.sin(c)*y,v=(e+o)/2+Math.sin(c)*m+Math.cos(c)*y,x=r([1,0],[(p-m)/h,(u-y)/l]),b=[(p-m)/h,(u-y)/l],S=[(-1*p-m)/h,(-1*u-y)/l],T=r(b,S);return a(b,S)<=-1&&(T=Math.PI),a(b,S)>=1&&(T=0),0===n&&T>0&&(T-=2*Math.PI),1===n&&0>T&&(T+=2*Math.PI),[_,v,h,l,x,T,c,n]},buildPath:function(t,e){var i=e.path,o=e.x||0,s=e.y||0;e.pathArray=e.pathArray||this.buildPathArray(i,o,s);for(var a=e.pathArray,r=e.pointList=[],n=[],h=0,l=a.length;l>h;h++){"M"==a[h].command.toUpperCase()&&(n.length>0&&r.push(n),n=[]);for(var d=a[h].points,c=0,p=d.length;p>c;c+=2)n.push([d[c],d[c+1]])}n.length>0&&r.push(n);for(var h=0,l=a.length;l>h;h++){var u=a[h].command,d=a[h].points;switch(u){case"L":t.lineTo(d[0],d[1]);break;case"M":t.moveTo(d[0],d[1]);break;case"C":t.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5]);break;case"Q":t.quadraticCurveTo(d[0],d[1],d[2],d[3]);break;case"A":var g=d[0],f=d[1],m=d[2],y=d[3],_=d[4],v=d[5],x=d[6],b=d[7],S=m>y?m:y,T=m>y?1:m/y,z=m>y?y/m:1;t.translate(g,f),t.rotate(x),t.scale(T,z),t.arc(0,0,S,_,_+v,1-b),t.scale(1/T,1/z),t.rotate(-x),t.translate(-g,-f);break;case"z":t.closePath()}}},getRect:function(t){if(t.__rect)return t.__rect;var e;e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0;for(var i=Number.MAX_VALUE,o=Number.MIN_VALUE,s=Number.MAX_VALUE,a=Number.MIN_VALUE,r=t.x||0,n=t.y||0,h=t.pathArray||this.buildPathArray(t.path),l=0;l<h.length;l++)for(var d=h[l].points,c=0;c<d.length;c++)c%2===0?(d[c]+r<i&&(i=d[c]),d[c]+r>o&&(o=d[c])):(d[c]+n<s&&(s=d[c]),d[c]+n>a&&(a=d[c]));var p;return p=i===Number.MAX_VALUE||o===Number.MIN_VALUE||s===Number.MAX_VALUE||a===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(i-e/2),y:Math.round(s-e/2),width:o-i+e,height:a-s+e},t.__rect=p,p}},t("../tool/util").inherits(n,e),n}),define("zrender/shape/Ellipse",["require","./Base","../tool/util"],function(t){var e=t("./Base"),i=function(t){e.call(this,t)};return i.prototype={type:"ellipse",buildPath:function(t,e){var i=.5522848,o=e.x,s=e.y,a=e.a,r=e.b,n=a*i,h=r*i;t.moveTo(o-a,s),t.bezierCurveTo(o-a,s-h,o-n,s-r,o,s-r),t.bezierCurveTo(o+n,s-r,o+a,s-h,o+a,s),t.bezierCurveTo(o+a,s+h,o+n,s+r,o,s+r),t.bezierCurveTo(o-n,s+r,o-a,s+h,o-a,s),t.closePath()},getRect:function(t){if(t.__rect)return t.__rect;var e;return e="stroke"==t.brushType||"fill"==t.brushType?t.lineWidth||1:0,t.__rect={x:Math.round(t.x-t.a-e/2),y:Math.round(t.y-t.b-e/2),width:2*t.a+e,height:2*t.b+e},t.__rect}},t("../tool/util").inherits(i,e),i}),define("echarts/component/dataRange",["require","./base","zrender/shape/Text","zrender/shape/Rectangle","../util/shape/HandlePolygon","../config","zrender/tool/util","zrender/tool/event","zrender/tool/area","zrender/tool/color","../component"],function(t){function e(t,e,o,s,a){if("undefined"==typeof this.query(s,"dataRange.min")||"undefined"==typeof this.query(s,"dataRange.max"))return void console.error("option.dataRange.min or option.dataRange.max has not been defined.");i.call(this,t,e,o,s,a);var n=this;n._ondrift=function(t,e){return n.__ondrift(this,t,e)},n._ondragend=function(){return n.__ondragend()},n._dataRangeSelected=function(t){return n.__dataRangeSelected(t)},n._dispatchHoverLink=function(t){return n.__dispatchHoverLink(t)},n._onhoverlink=function(t){return n.__onhoverlink(t)},this._selectedMap={},this._range={},this.refresh(s),e.bind(r.EVENT.HOVER,this._onhoverlink)}var i=t("./base"),o=t("zrender/shape/Text"),s=t("zrender/shape/Rectangle"),a=t("../util/shape/HandlePolygon"),r=t("../config");r.dataRange={zlevel:0,z:4,show:!0,orient:"vertical",x:"left",y:"bottom",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,itemWidth:20,itemHeight:14,precision:0,splitNumber:5,calculable:!1,selectedMode:!0,hoverLink:!0,realtime:!0,color:["#006edd","#e0ffff"],textStyle:{color:"#333"}};var n=t("zrender/tool/util"),h=t("zrender/tool/event"),l=t("zrender/tool/area"),d=t("zrender/tool/color");return e.prototype={type:r.COMPONENT_TYPE_DATARANGE,_textGap:10,_buildShape:function(){if(this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?this._buildGradient():this._buildItem(),this.dataRangeOption.show)for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t]);this._syncShapeFromRange()},_buildItem:function(){var t,e,i,a,r=this._valueTextList,n=r.length,h=this.getFont(this.dataRangeOption.textStyle),d=this._itemGroupLocation.x,c=this._itemGroupLocation.y,p=this.dataRangeOption.itemWidth,u=this.dataRangeOption.itemHeight,g=this.dataRangeOption.itemGap,f=l.getTextHeight("国",h);"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(d=this._itemGroupLocation.x+this._itemGroupLocation.width-p);var m=!0;this.dataRangeOption.text&&(m=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(d,c,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?d+=l.getTextWidth(this.dataRangeOption.text[0],h)+this._textGap:(c+=f+this._textGap,i.style.y+=f/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new o(i))));for(var y=0;n>y;y++)t=r[y],a=this.getColorByIndex(y),e=this._getItemShape(d,c,p,u,this._selectedMap[y]?a:"#ccc"),e._idx=y,e.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(e.clickable=!0,e.onclick=this._dataRangeSelected),this.shapeList.push(new s(e)),m&&(i={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:d+p+5,y:c,color:this._selectedMap[y]?this.dataRangeOption.textStyle.color:"#ccc",text:r[y],textFont:h,textBaseline:"top"},highlightStyle:{brushType:"fill"}},"vertical"==this.dataRangeOption.orient&&"right"==this.dataRangeOption.x&&(i.style.x-=p+10,i.style.textAlign="right"),i._idx=y,i.onmousemove=this._dispatchHoverLink,this.dataRangeOption.selectedMode&&(i.clickable=!0,i.onclick=this._dataRangeSelected),this.shapeList.push(new o(i))),"horizontal"==this.dataRangeOption.orient?d+=p+(m?5:0)+(m?l.getTextWidth(t,h):0)+g:c+=u+g;!m&&this.dataRangeOption.text[1]&&("horizontal"==this.dataRangeOption.orient?d=d-g+this._textGap:c=c-g+this._textGap,i=this._getTextShape(d,c,this.dataRangeOption.text[1]),"horizontal"!=this.dataRangeOption.orient&&(i.style.y-=5,i.style.textBaseline="top"),this.shapeList.push(new o(i)))},_buildGradient:function(){var e,i,a=this.getFont(this.dataRangeOption.textStyle),r=this._itemGroupLocation.x,n=this._itemGroupLocation.y,h=this.dataRangeOption.itemWidth,d=this.dataRangeOption.itemHeight,c=l.getTextHeight("国",a),p=10,u=!0;this.dataRangeOption.text&&(u=!1,this.dataRangeOption.text[0]&&(i=this._getTextShape(r,n,this.dataRangeOption.text[0]),"horizontal"==this.dataRangeOption.orient?r+=l.getTextWidth(this.dataRangeOption.text[0],a)+this._textGap:(n+=c+this._textGap,i.style.y+=c/2+this._textGap,i.style.textBaseline="bottom"),this.shapeList.push(new o(i))));for(var g=t("zrender/tool/color"),f=1/(this.dataRangeOption.color.length-1),m=[],y=0,_=this.dataRangeOption.color.length;_>y;y++)m.push([y*f,this.dataRangeOption.color[y]]);"horizontal"==this.dataRangeOption.orient?(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:r,y:n,width:h*p,height:d,color:g.getLinearGradient(r,n,r+h*p,n,m)},hoverable:!1},r+=h*p+this._textGap):(e={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:r,y:n,width:h,height:d*p,color:g.getLinearGradient(r,n,r,n+d*p,m)},hoverable:!1},n+=d*p+this._textGap),this.shapeList.push(new s(e)),this._calculableLocation=e.style,this.dataRangeOption.calculable&&(this._buildFiller(),this._bulidMask(),this._bulidHandle()),this._buildIndicator(),!u&&this.dataRangeOption.text[1]&&(i=this._getTextShape(r,n,this.dataRangeOption.text[1]),this.shapeList.push(new o(i)))},_buildIndicator:function(){var t,e,i=this._calculableLocation.x,o=this._calculableLocation.y,s=this._calculableLocation.width,r=this._calculableLocation.height,n=5;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[i,o+r],[i-n,o+r+n],[i+n,o+r+n]],e="bottom"):(t=[[i,o],[i-n,o-n],[i+n,o-n]],e="top"):"right"!=this.dataRangeOption.x?(t=[[i+s,o],[i+s+n,o-n],[i+s+n,o+n]],e="right"):(t=[[i,o],[i-n,o-n],[i-n,o+n]],e="left"),this._indicatorShape={style:{pointList:t,color:"#fff",__rect:{x:Math.min(t[0][0],t[1][0]),y:Math.min(t[0][1],t[1][1]),width:n*("horizontal"==this.dataRangeOption.orient?2:1),height:n*("horizontal"==this.dataRangeOption.orient?1:2)}},highlightStyle:{brushType:"fill",textPosition:e,textColor:this.dataRangeOption.textStyle.color},hoverable:!1},this._indicatorShape=new a(this._indicatorShape)
},_buildFiller:function(){this._fillerShape={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:this._calculableLocation.x,y:this._calculableLocation.y,width:this._calculableLocation.width,height:this._calculableLocation.height,color:"rgba(255,255,255,0)"},highlightStyle:{strokeColor:"rgba(255,255,255,0.5)",lineWidth:1},draggable:!0,ondrift:this._ondrift,ondragend:this._ondragend,onmousemove:this._dispatchHoverLink,_type:"filler"},this._fillerShape=new s(this._fillerShape),this.shapeList.push(this._fillerShape)},_bulidHandle:function(){var t,e,i,o,s,r,n,h,d=this._calculableLocation.x,c=this._calculableLocation.y,p=this._calculableLocation.width,u=this._calculableLocation.height,g=this.getFont(this.dataRangeOption.textStyle),f=l.getTextHeight("国",g),m=Math.max(l.getTextWidth(this._textFormat(this.dataRangeOption.max),g),l.getTextWidth(this._textFormat(this.dataRangeOption.min),g))+2;"horizontal"==this.dataRangeOption.orient?"bottom"!=this.dataRangeOption.y?(t=[[d,c],[d,c+u+f],[d-f,c+u+f],[d-1,c+u],[d-1,c]],e=d-m/2-f,i=c+u+f/2+2,o={x:d-m-f,y:c+u,width:m+f,height:f},s=[[d+p,c],[d+p,c+u+f],[d+p+f,c+u+f],[d+p+1,c+u],[d+p+1,c]],r=d+p+m/2+f,n=i,h={x:d+p,y:c+u,width:m+f,height:f}):(t=[[d,c+u],[d,c-f],[d-f,c-f],[d-1,c],[d-1,c+u]],e=d-m/2-f,i=c-f/2-2,o={x:d-m-f,y:c-f,width:m+f,height:f},s=[[d+p,c+u],[d+p,c-f],[d+p+f,c-f],[d+p+1,c],[d+p+1,c+u]],r=d+p+m/2+f,n=i,h={x:d+p,y:c-f,width:m+f,height:f}):(m+=f,"right"!=this.dataRangeOption.x?(t=[[d,c],[d+p+f,c],[d+p+f,c-f],[d+p,c-1],[d,c-1]],e=d+p+m/2+f/2,i=c-f/2,o={x:d+p,y:c-f,width:m+f,height:f},s=[[d,c+u],[d+p+f,c+u],[d+p+f,c+f+u],[d+p,c+1+u],[d,c+u+1]],r=e,n=c+u+f/2,h={x:d+p,y:c+u,width:m+f,height:f}):(t=[[d+p,c],[d-f,c],[d-f,c-f],[d,c-1],[d+p,c-1]],e=d-m/2-f/2,i=c-f/2,o={x:d-m-f,y:c-f,width:m+f,height:f},s=[[d+p,c+u],[d-f,c+u],[d-f,c+f+u],[d,c+1+u],[d+p,c+u+1]],r=e,n=c+u+f/2,h={x:d-m-f,y:c+u,width:m+f,height:f})),this._startShape={style:{pointList:t,text:this._textFormat(this.dataRangeOption.max),textX:e,textY:i,textFont:g,color:this.getColor(this.dataRangeOption.max),rect:o,x:t[0][0],y:t[0][1],_x:t[0][0],_y:t[0][1]}},this._startShape.highlightStyle={strokeColor:this._startShape.style.color,lineWidth:1},this._endShape={style:{pointList:s,text:this._textFormat(this.dataRangeOption.min),textX:r,textY:n,textFont:g,color:this.getColor(this.dataRangeOption.min),rect:h,x:s[0][0],y:s[0][1],_x:s[0][0],_y:s[0][1]}},this._endShape.highlightStyle={strokeColor:this._endShape.style.color,lineWidth:1},this._startShape.zlevel=this._endShape.zlevel=this.getZlevelBase(),this._startShape.z=this._endShape.z=this.getZBase()+1,this._startShape.draggable=this._endShape.draggable=!0,this._startShape.ondrift=this._endShape.ondrift=this._ondrift,this._startShape.ondragend=this._endShape.ondragend=this._ondragend,this._startShape.style.textColor=this._endShape.style.textColor=this.dataRangeOption.textStyle.color,this._startShape.style.textAlign=this._endShape.style.textAlign="center",this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape.style.textBaseline=this._endShape.style.textBaseline="middle",this._startShape.style.width=this._endShape.style.width=0,this._startShape.style.height=this._endShape.style.height=0,this._startShape.style.textPosition=this._endShape.style.textPosition="specific",this._startShape=new a(this._startShape),this._endShape=new a(this._endShape),this.shapeList.push(this._startShape),this.shapeList.push(this._endShape)},_bulidMask:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,o=this._calculableLocation.height;this._startMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:t,y:e,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?o:0,color:"#ccc"},hoverable:!1},this._endMask={zlevel:this.getZlevelBase(),z:this.getZBase()+1,style:{x:"horizontal"==this.dataRangeOption.orient?t+i:t,y:"horizontal"==this.dataRangeOption.orient?e:e+o,width:"horizontal"==this.dataRangeOption.orient?0:i,height:"horizontal"==this.dataRangeOption.orient?o:0,color:"#ccc"},hoverable:!1},this._startMask=new s(this._startMask),this._endMask=new s(this._endMask),this.shapeList.push(this._startMask),this.shapeList.push(this._endMask)},_buildBackground:function(){var t=this.reformCssArray(this.dataRangeOption.padding);this.shapeList.push(new s({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.dataRangeOption.borderWidth?"fill":"both",color:this.dataRangeOption.backgroundColor,strokeColor:this.dataRangeOption.borderColor,lineWidth:this.dataRangeOption.borderWidth}}))},_getItemGroupLocation:function(){var t=this._valueTextList,e=t.length,i=this.dataRangeOption.itemGap,o=this.dataRangeOption.itemWidth,s=this.dataRangeOption.itemHeight,a=0,r=0,n=this.getFont(this.dataRangeOption.textStyle),h=l.getTextHeight("国",n),d=10;if("horizontal"==this.dataRangeOption.orient){if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)a=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?o*d+i:e*(o+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?l.getTextWidth(this.dataRangeOption.text[0],n)+this._textGap:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?l.getTextWidth(this.dataRangeOption.text[1],n)+this._textGap:0);else{o+=5;for(var c=0;e>c;c++)a+=o+l.getTextWidth(t[c],n)+i}a-=i,r=Math.max(h,s)}else{var p;if(this.dataRangeOption.text||this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable)r=(this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?s*d+i:e*(s+i))+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[0]?this._textGap+h:0)+(this.dataRangeOption.text&&"undefined"!=typeof this.dataRangeOption.text[1]?this._textGap+h:0),p=Math.max(l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[0]||"",n),l.getTextWidth(this.dataRangeOption.text&&this.dataRangeOption.text[1]||"",n)),a=Math.max(o,p);else{r=(s+i)*e,o+=5,p=0;for(var c=0;e>c;c++)p=Math.max(p,l.getTextWidth(t[c],n));a=o+p}r-=i}var u,g=this.reformCssArray(this.dataRangeOption.padding),f=this.zr.getWidth();switch(this.dataRangeOption.x){case"center":u=Math.floor((f-a)/2);break;case"left":u=g[3]+this.dataRangeOption.borderWidth;break;case"right":u=f-a-g[1]-this.dataRangeOption.borderWidth;break;default:u=this.parsePercent(this.dataRangeOption.x,f),u=isNaN(u)?0:u}var m,y=this.zr.getHeight();switch(this.dataRangeOption.y){case"top":m=g[0]+this.dataRangeOption.borderWidth;break;case"bottom":m=y-r-g[2]-this.dataRangeOption.borderWidth;break;case"center":m=Math.floor((y-r)/2);break;default:m=this.parsePercent(this.dataRangeOption.y,y),m=isNaN(m)?0:m}if(this.dataRangeOption.calculable){var _=Math.max(l.getTextWidth(this.dataRangeOption.max,n),l.getTextWidth(this.dataRangeOption.min,n))+h;"horizontal"==this.dataRangeOption.orient?(_>u&&(u=_),u+a+_>f&&(u-=_)):(h>m&&(m=h),m+r+h>y&&(m-=h))}return{x:u,y:m,width:a,height:r}},_getTextShape:function(t,e,i){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:"horizontal"==this.dataRangeOption.orient?t:this._itemGroupLocation.x+this._itemGroupLocation.width/2,y:"horizontal"==this.dataRangeOption.orient?this._itemGroupLocation.y+this._itemGroupLocation.height/2:e,color:this.dataRangeOption.textStyle.color,text:i,textFont:this.getFont(this.dataRangeOption.textStyle),textBaseline:"horizontal"==this.dataRangeOption.orient?"middle":"top",textAlign:"horizontal"==this.dataRangeOption.orient?"left":"center"},hoverable:!1}},_getItemShape:function(t,e,i,o,s){return{zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:t,y:e+1,width:i,height:o-2,color:s},highlightStyle:{strokeColor:s,lineWidth:1}}},__ondrift:function(t,e,i){var o=this._calculableLocation.x,s=this._calculableLocation.y,a=this._calculableLocation.width,r=this._calculableLocation.height;return"horizontal"==this.dataRangeOption.orient?t.style.x+e<=o?t.style.x=o:t.style.x+e+t.style.width>=o+a?t.style.x=o+a-t.style.width:t.style.x+=e:t.style.y+i<=s?t.style.y=s:t.style.y+i+t.style.height>=s+r?t.style.y=s+r-t.style.height:t.style.y+=i,"filler"==t._type?this._syncHandleShape():this._syncFillerShape(t),this.dataRangeOption.realtime&&this._dispatchDataRange(),!0},__ondragend:function(){this.isDragend=!0},ondragend:function(t,e){this.isDragend&&t.target&&(e.dragOut=!0,e.dragIn=!0,this.dataRangeOption.realtime||this._dispatchDataRange(),e.needRefresh=!1,this.isDragend=!1)},_syncShapeFromRange:function(){var t=this.dataRangeOption.range||{};if(this._range.end="undefined"!=typeof this._range.end?this._range.end:"undefined"!=typeof t.start?t.start:0,this._range.start="undefined"!=typeof this._range.start?this._range.start:"undefined"!=typeof t.end?t.end:100,100!=this._range.start||0!==this._range.end){if("horizontal"==this.dataRangeOption.orient){var e=this._fillerShape.style.width;this._fillerShape.style.x+=e*(100-this._range.start)/100,this._fillerShape.style.width=e*(this._range.start-this._range.end)/100}else{var i=this._fillerShape.style.height;this._fillerShape.style.y+=i*(100-this._range.start)/100,this._fillerShape.style.height=i*(this._range.start-this._range.end)/100}this.zr.modShape(this._fillerShape.id),this._syncHandleShape()}},_syncHandleShape:function(){var t=this._calculableLocation.x,e=this._calculableLocation.y,i=this._calculableLocation.width,o=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(this._startShape.style.x=this._fillerShape.style.x,this._startMask.style.width=this._startShape.style.x-t,this._endShape.style.x=this._fillerShape.style.x+this._fillerShape.style.width,this._endMask.style.x=this._endShape.style.x,this._endMask.style.width=t+i-this._endShape.style.x,this._range.start=Math.ceil(100-(this._startShape.style.x-t)/i*100),this._range.end=Math.floor(100-(this._endShape.style.x-t)/i*100)):(this._startShape.style.y=this._fillerShape.style.y,this._startMask.style.height=this._startShape.style.y-e,this._endShape.style.y=this._fillerShape.style.y+this._fillerShape.style.height,this._endMask.style.y=this._endShape.style.y,this._endMask.style.height=e+o-this._endShape.style.y,this._range.start=Math.ceil(100-(this._startShape.style.y-e)/o*100),this._range.end=Math.floor(100-(this._endShape.style.y-e)/o*100)),this._syncShape()},_syncFillerShape:function(t){var e,i,o=this._calculableLocation.x,s=this._calculableLocation.y,a=this._calculableLocation.width,r=this._calculableLocation.height;"horizontal"==this.dataRangeOption.orient?(e=this._startShape.style.x,i=this._endShape.style.x,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.x=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.x=e),this._fillerShape.style.x=e,this._fillerShape.style.width=i-e,this._startMask.style.width=e-o,this._endMask.style.x=i,this._endMask.style.width=o+a-i,this._range.start=Math.ceil(100-(e-o)/a*100),this._range.end=Math.floor(100-(i-o)/a*100)):(e=this._startShape.style.y,i=this._endShape.style.y,t.id==this._startShape.id&&e>=i?(i=e,this._endShape.style.y=e):t.id==this._endShape.id&&e>=i&&(e=i,this._startShape.style.y=e),this._fillerShape.style.y=e,this._fillerShape.style.height=i-e,this._startMask.style.height=e-s,this._endMask.style.y=i,this._endMask.style.height=s+r-i,this._range.start=Math.ceil(100-(e-s)/r*100),this._range.end=Math.floor(100-(i-s)/r*100)),this._syncShape()},_syncShape:function(){this._startShape.position=[this._startShape.style.x-this._startShape.style._x,this._startShape.style.y-this._startShape.style._y],this._startShape.style.text=this._textFormat(this._gap*this._range.start+this.dataRangeOption.min),this._startShape.style.color=this._startShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.start+this.dataRangeOption.min),this._endShape.position=[this._endShape.style.x-this._endShape.style._x,this._endShape.style.y-this._endShape.style._y],this._endShape.style.text=this._textFormat(this._gap*this._range.end+this.dataRangeOption.min),this._endShape.style.color=this._endShape.highlightStyle.strokeColor=this.getColor(this._gap*this._range.end+this.dataRangeOption.min),this.zr.modShape(this._startShape.id),this.zr.modShape(this._endShape.id),this.zr.modShape(this._startMask.id),this.zr.modShape(this._endMask.id),this.zr.modShape(this._fillerShape.id),this.zr.refreshNextFrame()},_dispatchDataRange:function(){this.messageCenter.dispatch(r.EVENT.DATA_RANGE,null,{range:{start:this._range.end,end:this._range.start}},this.myChart)},__dataRangeSelected:function(t){if("single"===this.dataRangeOption.selectedMode)for(var e in this._selectedMap)this._selectedMap[e]=!1;var i=t.target._idx;this._selectedMap[i]=!this._selectedMap[i];var o=(this._colorList.length-i)*this._gap+this.dataRangeOption.min;this.messageCenter.dispatch(r.EVENT.DATA_RANGE_SELECTED,t.event,{selected:this._selectedMap,target:i,valueMax:o,valueMin:o-this._gap},this.myChart),this.messageCenter.dispatch(r.EVENT.REFRESH,null,null,this.myChart)},__dispatchHoverLink:function(t){var e,i;if(this.dataRangeOption.calculable){var o,s=this.dataRangeOption.max-this.dataRangeOption.min;o="horizontal"==this.dataRangeOption.orient?(1-(h.getX(t.event)-this._calculableLocation.x)/this._calculableLocation.width)*s:(1-(h.getY(t.event)-this._calculableLocation.y)/this._calculableLocation.height)*s,e=o-.05*s,i=o+.05*s}else{var a=t.target._idx;i=(this._colorList.length-a)*this._gap+this.dataRangeOption.min,e=i-this._gap}this.messageCenter.dispatch(r.EVENT.DATA_RANGE_HOVERLINK,t.event,{valueMin:e,valueMax:i},this.myChart)},__onhoverlink:function(t){if(this.dataRangeOption.show&&this.dataRangeOption.hoverLink&&this._indicatorShape&&t&&null!=t.seriesIndex&&null!=t.dataIndex){var e=t.value;if(""===e||isNaN(e))return;e<this.dataRangeOption.min?e=this.dataRangeOption.min:e>this.dataRangeOption.max&&(e=this.dataRangeOption.max),this._indicatorShape.position="horizontal"==this.dataRangeOption.orient?[(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.width,0]:[0,(this.dataRangeOption.max-e)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._calculableLocation.height],this._indicatorShape.style.text=this._textFormat(t.value),this._indicatorShape.style.color=this.getColor(e),this.zr.addHoverShape(this._indicatorShape)}},_textFormat:function(t,e){if(t=(+t).toFixed(this.dataRangeOption.precision),e=null!=e?(+e).toFixed(this.dataRangeOption.precision):"",this.dataRangeOption.formatter){if("string"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.replace("{value}",t).replace("{value2}",e);if("function"==typeof this.dataRangeOption.formatter)return this.dataRangeOption.formatter.call(this.myChart,t,e)}return""!==e?t+" - "+e:t},refresh:function(t){if(t){this.option=t,this.option.dataRange=this.reformOption(this.option.dataRange),this.dataRangeOption=this.option.dataRange,this.myChart.canvasSupported||(this.dataRangeOption.realtime=!1);var e=this.dataRangeOption.splitNumber<=0||this.dataRangeOption.calculable?100:this.dataRangeOption.splitNumber;if(this._colorList=d.getGradientColors(this.dataRangeOption.color,Math.max((e-this.dataRangeOption.color.length)/(this.dataRangeOption.color.length-1),0)+1),this._colorList.length>e){for(var i=this._colorList.length,o=[this._colorList[0]],s=i/(e-1),a=1;e-1>a;a++)o.push(this._colorList[Math.floor(a*s)]);o.push(this._colorList[i-1]),this._colorList=o}var r=this.dataRangeOption.precision;for(this._gap=(this.dataRangeOption.max-this.dataRangeOption.min)/e;this._gap.toFixed(r)-0!=this._gap&&5>r;)r++;this.dataRangeOption.precision=r,this._gap=((this.dataRangeOption.max-this.dataRangeOption.min)/e).toFixed(r)-0,this._valueTextList=[];for(var a=0;e>a;a++)this._selectedMap[a]=!0,this._valueTextList.unshift(this._textFormat(a*this._gap+this.dataRangeOption.min,(a+1)*this._gap+this.dataRangeOption.min))}this.clear(),this._buildShape()},getColor:function(t){if(isNaN(t))return null;if(this.dataRangeOption.min==this.dataRangeOption.max)return this._colorList[0];if(t<this.dataRangeOption.min?t=this.dataRangeOption.min:t>this.dataRangeOption.max&&(t=this.dataRangeOption.max),this.dataRangeOption.calculable&&(t-(this._gap*this._range.start+this.dataRangeOption.min)>5e-5||t-(this._gap*this._range.end+this.dataRangeOption.min)<-5e-5))return null;var e=this._colorList.length-Math.ceil((t-this.dataRangeOption.min)/(this.dataRangeOption.max-this.dataRangeOption.min)*this._colorList.length);return e==this._colorList.length&&e--,this._selectedMap[e]?this._colorList[e]:null},getColorByIndex:function(t){return t>=this._colorList.length?t=this._colorList.length-1:0>t&&(t=0),this._colorList[t]},onbeforDispose:function(){this.messageCenter.unbind(r.EVENT.HOVER,this._onhoverlink)}},n.inherits(e,i),t("../component").define("dataRange",e),e}),define("echarts/component/roamController",["require","./base","zrender/shape/Rectangle","zrender/shape/Sector","zrender/shape/Circle","../config","zrender/tool/util","zrender/tool/color","zrender/tool/event","../component"],function(t){function e(t,e,o,s,a){if(s.roamController&&s.roamController.show){if(!s.roamController.mapTypeControl)return void console.error("option.roamController.mapTypeControl has not been defined.");i.call(this,t,e,o,s,a),this.rcOption=s.roamController;var r=this;this._drictionMouseDown=function(t){return r.__drictionMouseDown(t)},this._drictionMouseUp=function(t){return r.__drictionMouseUp(t)},this._drictionMouseMove=function(t){return r.__drictionMouseMove(t)},this._drictionMouseOut=function(t){return r.__drictionMouseOut(t)},this._scaleHandler=function(t){return r.__scaleHandler(t)},this.refresh(s)}}var i=t("./base"),o=t("zrender/shape/Rectangle"),s=t("zrender/shape/Sector"),a=t("zrender/shape/Circle"),r=t("../config");r.roamController={zlevel:0,z:4,show:!0,x:"left",y:"top",width:80,height:120,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,handleColor:"#6495ed",fillerColor:"#fff",step:15,mapTypeControl:null};var n=t("zrender/tool/util"),h=t("zrender/tool/color"),l=t("zrender/tool/event");return e.prototype={type:r.COMPONENT_TYPE_ROAMCONTROLLER,_buildShape:function(){if(this.rcOption.show){this._itemGroupLocation=this._getItemGroupLocation(),this._buildBackground(),this._buildItem();for(var t=0,e=this.shapeList.length;e>t;t++)this.zr.addShape(this.shapeList[t])}},_buildItem:function(){this.shapeList.push(this._getDirectionShape("up")),this.shapeList.push(this._getDirectionShape("down")),this.shapeList.push(this._getDirectionShape("left")),this.shapeList.push(this._getDirectionShape("right")),this.shapeList.push(this._getScaleShape("scaleUp")),this.shapeList.push(this._getScaleShape("scaleDown"))},_getDirectionShape:function(t){var e=this._itemGroupLocation.r,i=this._itemGroupLocation.x+e,o=this._itemGroupLocation.y+e,a={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:i,y:o,r:e,startAngle:-45,endAngle:45,color:this.rcOption.handleColor,text:">",textX:i+e/2+4,textY:o-.5,textAlign:"center",textBaseline:"middle",textPosition:"specific",textColor:this.rcOption.fillerColor,textFont:Math.floor(e/2)+"px arial"},highlightStyle:{color:h.lift(this.rcOption.handleColor,-.2),brushType:"fill"},clickable:!0};switch(t){case"up":a.rotation=[Math.PI/2,i,o];break;case"left":a.rotation=[Math.PI,i,o];break;case"down":a.rotation=[-Math.PI/2,i,o]}return a=new s(a),a._roamType=t,a.onmousedown=this._drictionMouseDown,a.onmouseup=this._drictionMouseUp,a.onmousemove=this._drictionMouseMove,a.onmouseout=this._drictionMouseOut,a},_getScaleShape:function(t){var e=this._itemGroupLocation.width,i=this._itemGroupLocation.height-e;i=0>i?20:i;var o=Math.min(e/2-5,i)/2,s=this._itemGroupLocation.x+("scaleDown"===t?e-o:o),r=this._itemGroupLocation.y+this._itemGroupLocation.height-o,n={zlevel:this.getZlevelBase(),z:this.getZBase(),style:{x:s,y:r,r:o,color:this.rcOption.handleColor,text:"scaleDown"===t?"-":"+",textX:s,textY:r-2,textAlign:"center",textBaseline:"middle",textPosition:"specific",textColor:this.rcOption.fillerColor,textFont:Math.floor(o)+"px verdana"},highlightStyle:{color:h.lift(this.rcOption.handleColor,-.2),brushType:"fill"},clickable:!0};return n=new a(n),n._roamType=t,n.onmousedown=this._scaleHandler,n},_buildBackground:function(){var t=this.reformCssArray(this.rcOption.padding);this.shapeList.push(new o({zlevel:this.getZlevelBase(),z:this.getZBase(),hoverable:!1,style:{x:this._itemGroupLocation.x-t[3],y:this._itemGroupLocation.y-t[0],width:this._itemGroupLocation.width+t[3]+t[1],height:this._itemGroupLocation.height+t[0]+t[2],brushType:0===this.rcOption.borderWidth?"fill":"both",color:this.rcOption.backgroundColor,strokeColor:this.rcOption.borderColor,lineWidth:this.rcOption.borderWidth}}))},_getItemGroupLocation:function(){var t,e=this.reformCssArray(this.rcOption.padding),i=this.rcOption.width,o=this.rcOption.height,s=this.zr.getWidth(),a=this.zr.getHeight();switch(this.rcOption.x){case"center":t=Math.floor((s-i)/2);break;case"left":t=e[3]+this.rcOption.borderWidth;break;case"right":t=s-i-e[1]-e[3]-2*this.rcOption.borderWidth;break;default:t=this.parsePercent(this.rcOption.x,s)}var r;switch(this.rcOption.y){case"top":r=e[0]+this.rcOption.borderWidth;break;case"bottom":r=a-o-e[0]-e[2]-2*this.rcOption.borderWidth;break;case"center":r=Math.floor((a-o)/2);break;default:r=this.parsePercent(this.rcOption.y,a)}return{x:t,y:r,r:i/2,width:i,height:o}},__drictionMouseDown:function(t){this.mousedown=!0,this._drictionHandlerOn(t)},__drictionMouseUp:function(t){this.mousedown=!1,this._drictionHandlerOff(t)},__drictionMouseMove:function(t){this.mousedown&&this._drictionHandlerOn(t)},__drictionMouseOut:function(t){this._drictionHandlerOff(t)},_drictionHandlerOn:function(t){this._dispatchEvent(t.event,t.target._roamType),clearInterval(this.dircetionTimer);var e=this;this.dircetionTimer=setInterval(function(){e._dispatchEvent(t.event,t.target._roamType)},100),l.stop(t.event)},_drictionHandlerOff:function(){clearInterval(this.dircetionTimer)},__scaleHandler:function(t){this._dispatchEvent(t.event,t.target._roamType),l.stop(t.event)},_dispatchEvent:function(t,e){this.messageCenter.dispatch(r.EVENT.ROAMCONTROLLER,t,{roamType:e,mapTypeControl:this.rcOption.mapTypeControl,step:this.rcOption.step},this.myChart)},refresh:function(t){t&&(this.option=t||this.option,this.option.roamController=this.reformOption(this.option.roamController),this.rcOption=this.option.roamController),this.clear(),this._buildShape()}},n.inherits(e,i),t("../component").define("roamController",e),e}),define("echarts/util/mapData/params",["require"],function(){function t(t){if(!t.UTF8Encoding)return t;for(var i=t.features,o=0;o<i.length;o++)for(var s=i[o],a=s.geometry.coordinates,r=s.geometry.encodeOffsets,n=0;n<a.length;n++){var h=a[n];if("Polygon"===s.geometry.type)a[n]=e(h,r[n]);else if("MultiPolygon"===s.geometry.type)for(var l=0;l<h.length;l++){var d=h[l];h[l]=e(d,r[n][l])}}return t.UTF8Encoding=!1,t}function e(t,e){for(var i=[],o=e[0],s=e[1],a=0;a<t.length;a+=2){var r=t.charCodeAt(a)-64,n=t.charCodeAt(a+1)-64;r=r>>1^-(1&r),n=n>>1^-(1&n),r+=o,n+=s,o=r,s=n,i.push([r/1024,n/1024])}return i}var i={none:{getGeoJson:function(t){t({type:"FeatureCollection",features:[{type:"Feature",geometry:{coordinates:[],encodeOffsets:[],type:"Polygon"},properties:{}}]})}}};return{decode:t,params:i}}),define("echarts/util/mapData/textFixed",[],function(){return{"广东":[0,-10],"香港":[10,10],"澳门":[-10,18],"黑龙江":[0,20],"天津":[5,5],"深圳市":[-35,0],"红河哈尼族彝族自治州":[0,20],"楚雄彝族自治州":[-5,15],"石河子市":[-5,5],"五家渠市":[0,-10],"昌吉回族自治州":[10,10],"昌江黎族自治县":[0,20],"陵水黎族自治县":[0,20],"东方市":[0,20],"渭南市":[0,20]}}),define("echarts/util/mapData/geoCoord",[],function(){return{Russia:[100,60],"United States of America":[-99,38]}}),define("echarts/util/projection/svg",["require","zrender/shape/Path"],function(t){function e(t){return parseFloat(t||0)}function i(t){for(var i=t.firstChild;"svg"!=i.nodeName.toLowerCase()||1!=i.nodeType;)i=i.nextSibling;var o=e(i.getAttribute("x")),s=e(i.getAttribute("y")),a=e(i.getAttribute("width")),r=e(i.getAttribute("height"));return{left:o,top:s,width:a,height:r}}function o(t,e){function i(t){var e=t.tagName;if(d[e]){var a=d[e](t,o);a&&(a.scale=o,a.properties={name:t.getAttribute("name")||""},a.id=t.id,n(a,t),s.push(a))}for(var r=t.childNodes,h=0,l=r.length;l>h;h++)i(r[h])}var o=[e.scale.x,e.scale.y],s=[];return i(t),s}function s(t,e){var i=e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y];return[i[0]/t.scale.x,i[1]/t.scale.y]}function a(t,e){var i=e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y];return[i[0]*t.scale.x,i[1]*t.scale.y]}function r(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function n(t,e){var i=e.getAttribute("fill"),o=e.getAttribute("stroke"),s=e.getAttribute("stroke-width"),a=e.getAttribute("opacity");i&&"none"!=i?(t.color=i,o?(t.brushType="both",t.strokeColor=o):t.brushType="fill"):o&&"none"!=o&&(t.strokeColor=o,t.brushType="stroke"),s&&"none"!=s&&(t.lineWidth=parseFloat(s)),a&&"none"!=a&&(t.opacity=parseFloat(a))}function h(t){for(var e=r(t).replace(/,/g," ").split(/\s+/),i=[],o=0;o<e.length;){var s=parseFloat(e[o++]),a=parseFloat(e[o++]);i.push([s,a])}return i}var l=t("zrender/shape/Path"),d={path:function(t,e){var i=t.getAttribute("d"),o=l.prototype.getRect({path:i});return{shapeType:"path",path:i,cp:[(o.x+o.width/2)*e[0],(o.y+o.height/2)*e[1]]}},rect:function(t,i){var o=e(t.getAttribute("x")),s=e(t.getAttribute("y")),a=e(t.getAttribute("width")),r=e(t.getAttribute("height"));return{shapeType:"rectangle",x:o,y:s,width:a,height:r,cp:[(o+a/2)*i[0],(s+r/2)*i[1]]}},line:function(t,i){var o=e(t.getAttribute("x1")),s=e(t.getAttribute("y1")),a=e(t.getAttribute("x2")),r=e(t.getAttribute("y2"));return{shapeType:"line",xStart:o,yStart:s,xEnd:a,yEnd:r,cp:[.5*(o+a)*i[0],.5*(s+r)*i[1]]}},circle:function(t,i){var o=e(t.getAttribute("cx")),s=e(t.getAttribute("cy")),a=e(t.getAttribute("r"));return{shapeType:"circle",x:o,y:s,r:a,cp:[o*i[0],s*i[1]]}},ellipse:function(t,e){var i=parseFloat(t.getAttribute("cx")||0),o=parseFloat(t.getAttribute("cy")||0),s=parseFloat(t.getAttribute("rx")||0),a=parseFloat(t.getAttribute("ry")||0);return{shapeType:"ellipse",x:i,y:o,a:s,b:a,cp:[i*e[0],o*e[1]]}},polygon:function(t,e){var i=t.getAttribute("points"),o=[1/0,1/0],s=[-1/0,-1/0];if(i){i=h(i);for(var a=0;a<i.length;a++){var r=i[a];o[0]=Math.min(r[0],o[0]),o[1]=Math.min(r[1],o[1]),s[0]=Math.max(r[0],s[0]),s[1]=Math.max(r[1],s[1])}return{shapeType:"polygon",pointList:i,cp:[(o[0]+s[0])/2*e[0],(o[1]+s[1])/2*e[0]]}}},polyline:function(t,e){var i=d.polygon(t,e);return i}};return{getBbox:i,geoJson2Path:o,pos2geo:s,geo2pos:a}}),define("echarts/util/projection/normal",[],function(){function t(t,i){return i=i||{},t.srcSize||e(t,i),t.srcSize}function e(t,e){e=e||{},r.xmin=360,r.xmax=-360,r.ymin=180,r.ymax=-180;for(var i,o,s=t.features,a=0,n=s.length;n>a;a++)if(o=s[a],!o.properties.name||!e[o.properties.name])switch(o.type){case"Feature":r[o.geometry.type](o.geometry.coordinates);break;case"GeometryCollection":i=o.geometries;for(var h=0,l=i.length;l>h;h++)r[i[h].type](i[h].coordinates)}return t.srcSize={left:1*r.xmin.toFixed(4),top:1*r.ymin.toFixed(4),width:1*(r.xmax-r.xmin).toFixed(4),height:1*(r.ymax-r.ymin).toFixed(4)},t}function i(t,i,o){function s(t,e){f=t.type,m=t.coordinates,a._bbox={xmin:360,xmax:-360,ymin:180,ymax:-180},y=a[f](m),d.push({path:y,cp:a.makePoint(e.properties.cp?e.properties.cp:[(a._bbox.xmin+a._bbox.xmax)/2,(a._bbox.ymin+a._bbox.ymax)/2]),properties:e.properties,id:e.id})}o=o||{},a.scale=null,a.offset=null,t.srcSize||e(t,o),i.offset={x:t.srcSize.left,y:t.srcSize.top,left:i.OffsetLeft||0,top:i.OffsetTop||0},a.scale=i.scale,a.offset=i.offset;for(var r,n,h,l=t.features,d=[],c=0,p=l.length;p>c;c++)if(h=l[c],!h.properties.name||!o[h.properties.name])if("Feature"==h.type)s(h.geometry,h);else if("GeometryCollection"==h.type){r=h.geometries;for(var u=0,g=r.length;g>u;u++)n=r[u],s(n,n)}var f,m,y;return d}function o(t,e){var i,o;return e instanceof Array?(i=1*e[0],o=1*e[1]):(i=1*e.x,o=1*e.y),i=i/t.scale.x+t.offset.x-168.5,i=i>180?i-360:i,o=90-(o/t.scale.y+t.offset.y),[i,o]}function s(t,e){return a.offset=t.offset,a.scale=t.scale,a.makePoint(e instanceof Array?[1*e[0],1*e[1]]:[1*e.x,1*e.y])}var a={formatPoint:function(t){return[(t[0]<-168.5&&t[1]>63.8?t[0]+360:t[0])+168.5,90-t[1]]},makePoint:function(t){var e=this,i=e.formatPoint(t);e._bbox.xmin>t[0]&&(e._bbox.xmin=t[0]),e._bbox.xmax<t[0]&&(e._bbox.xmax=t[0]),e._bbox.ymin>t[1]&&(e._bbox.ymin=t[1]),e._bbox.ymax<t[1]&&(e._bbox.ymax=t[1]);var o=(i[0]-a.offset.x)*a.scale.x+a.offset.left,s=(i[1]-a.offset.y)*a.scale.y+a.offset.top;return[o,s]},Point:function(t){return t=this.makePoint(t),t.join(",")},LineString:function(t){for(var e,i="",o=0,s=t.length;s>o;o++)e=a.makePoint(t[o]),i=0===o?"M"+e.join(","):i+"L"+e.join(",");return i},Polygon:function(t){for(var e="",i=0,o=t.length;o>i;i++)e=e+a.LineString(t[i])+"z";return e},MultiPoint:function(t){for(var e=[],i=0,o=t.length;o>i;i++)e.push(a.Point(t[i]));return e},MultiLineString:function(t){for(var e="",i=0,o=t.length;o>i;i++)e+=a.LineString(t[i]);return e},MultiPolygon:function(t){for(var e="",i=0,o=t.length;o>i;i++)e+=a.Polygon(t[i]);return e}},r={formatPoint:a.formatPoint,makePoint:function(t){var e=this,i=e.formatPoint(t),o=i[0],s=i[1];e.xmin>o&&(e.xmin=o),e.xmax<o&&(e.xmax=o),e.ymin>s&&(e.ymin=s),e.ymax<s&&(e.ymax=s)},Point:function(t){this.makePoint(t)},LineString:function(t){for(var e=0,i=t.length;i>e;e++)this.makePoint(t[e])},Polygon:function(t){for(var e=0,i=t.length;i>e;e++)this.LineString(t[e])},MultiPoint:function(t){for(var e=0,i=t.length;i>e;e++)this.Point(t[e])},MultiLineString:function(t){for(var e=0,i=t.length;i>e;e++)this.LineString(t[e])},MultiPolygon:function(t){for(var e=0,i=t.length;i>e;e++)this.Polygon(t[e])}};return{getBbox:t,geoJson2Path:i,pos2geo:o,geo2pos:s}}),define("echarts/util/shape/HandlePolygon",["require","zrender/shape/Base","zrender/shape/Polygon","zrender/tool/util"],function(t){function e(t){i.call(this,t)}var i=t("zrender/shape/Base"),o=t("zrender/shape/Polygon"),s=t("zrender/tool/util");return e.prototype={type:"handle-polygon",buildPath:function(t,e){o.prototype.buildPath(t,e)},isCover:function(t,e){var i=this.getTansform(t,e);t=i[0],e=i[1];var o=this.style.rect;return t>=o.x&&t<=o.x+o.width&&e>=o.y&&e<=o.y+o.height?!0:!1}},s.inherits(e,i),e});